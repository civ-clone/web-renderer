"use strict";(()=>{var mY=Object.create;var Jm=Object.defineProperty;var pY=Object.getOwnPropertyDescriptor;var uY=Object.getOwnPropertyNames;var cY=Object.getPrototypeOf,yY=Object.prototype.hasOwnProperty;var t=(i,e)=>Jm(i,"name",{value:e,configurable:!0});var n=(i,e)=>()=>(i&&(e=i(i=0)),e);var C=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),Jp=(i,e)=>{for(var r in e)Jm(i,r,{get:e[r],enumerable:!0})},QR=(i,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of uY(e))!yY.call(i,a)&&a!==r&&Jm(i,a,{get:()=>e[a],enumerable:!(o=pY(e,a))||o.enumerable});return i};var T=(i,e,r)=>(r=i!=null?mY(cY(i)):{},QR(e||!i||!i.__esModule?Jm(r,"default",{value:i,enumerable:!0}):r,i)),R=i=>QR(Jm({},"__esModule",{value:!0}),i);var XR=(i,e,r)=>{if(!e.has(i))throw TypeError("Cannot "+r)};var b=(i,e,r)=>(XR(i,e,"read from private field"),r?r.call(i):e.get(i)),ye=(i,e,r)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,r)},ke=(i,e,r,o)=>(XR(i,e,"write to private field"),o?o.call(i,r):e.set(i,r),r),ex=(i,e,r,o)=>({set _(a){ke(i,e,a,r)},get _(){return b(i,e,o)}});var O,Zp,Ce=n(()=>{O=class{#e=[];#t=[];constructor(...e){this.#e.push(...e)}accepts(e){return this.#e.some(r=>e instanceof r)}entries(){return this.#t.slice()}every(e){return this.entries().every(e)}filter(e){return this.entries().filter(e)}forEach(e){return this.entries().forEach(e)}getBy(e,r){return this.filter(o=>{let a=o[e];return a instanceof Function?a.bind(o)()===r:o[e]===r})}includes(e){return this.#t.includes(e)}indexOf(e){return this.#t.indexOf(e)}get length(){return this.entries().length}map(e){return this.entries().map(e)}register(...e){e.forEach(r=>{if(!this.accepts(r))throw new TypeError(`Registry#register: Invalid entity attempted to be registered: '${r}'.`);this.#t.includes(r)||this.#t.push(r)})}some(e){return this.entries().some(e)}unregister(...e){e.forEach(r=>{let o=this.#t.indexOf(r);o>-1&&this.#t.splice(o,1)})}};t(O,"EntityRegistry");Zp=O});var Qp,te,$t=n(()=>{Qp=class{#e;#t;#r;constructor(e,r,o){this.#e=r,this.#t=o,this.#r=e}data(...e){return this.#t(...e)}key(){return this.#e}type(){return this.#r}};t(Qp,"AdditionalData");te=Qp});var Xp,re,kt=n(()=>{Ce();$t();Xp=class extends O{constructor(){super(te)}getByType(e){return this.filter(r=>r.type()===e||Object.prototype.isPrototypeOf.call(r.type(),e)||Object.prototype.isPrototypeOf.call(r.type().prototype,e))}};t(Xp,"AdditionalDataRegistry");re=new Xp});var eu,fY,Zm,S,Fe,Z=n(()=>{kt();Ce();eu={},fY=t(i=>{let e=i.sourceClass().name,r=eu[e];return r||(eu[e]=0),r===Number.MAX_SAFE_INTEGER&&(eu[e]=BigInt(r)),e+"-"+(++eu[e]).toString(36)},"idProvider"),Zm=t((i,e,r=a=>a,o=re)=>{if(i=r(i),i instanceof Zp&&(i=i.entries()),Array.isArray(i))return i.map(a=>Zm(a,e,r,o));if(i instanceof S){let a=i.id();if(!(a in e)){let s={_:i.sourceClass().name};e[a]=s,i.keys().forEach(p=>{let u=i[p]instanceof Function?i[p]():i[p];s[p]=Zm(u,e,r,o)}),o.getByType(i.sourceClass()).forEach(p=>{s[p.key()]=Zm(p.data(i),e,r,o)})}return{"#ref":a}}return i instanceof Function?{_:i.name}:i&&i instanceof Object?Object.entries(i).reduce((a,[s,p])=>(a[s]=Zm(p,e,r,o),a),{}):i},"toPlainObject"),S=class{#e;#t=["id"];constructor(){this.#e=fY(this)}addKey(...e){this.#t.push(...e)}id(){return this.#e}keys(){return this.#t}sourceClass(){return this.constructor}toPlainObject(e=o=>o,r=re){let o={};return{hierarchy:Zm(this,o,e,r),objects:o}}};t(S,"DataObject");Fe=S});var tu,Dr,ka=n(()=>{Z();tu=class extends S{#e;#t;constructor(e,r){super(),this.#e=e,this.#t=r,this.addKey("value")}player(){return this.#e}value(){return this.#t}};t(tu,"PlayerAction");Dr=tu});var ru,ni,Gs=n(()=>{ka();ru=class extends Dr{};t(ru,"MandatoryPlayerAction");ni=ru});var Da,tx=n(()=>{Gs();Da=class extends ni{};t(Da,"ActiveUnit")});var Oa,rx=n(()=>{ka();Oa=class extends Dr{};t(Oa,"InactiveUnit")});var Vd=n(()=>{tx();rx()});var iu,v,E=n(()=>{Z();iu=class extends Fe{};t(iu,"Advance");v=iu});var De,Hi=n(()=>{De=class{#e=[];#t=[];constructor(...e){this.#e.push(...e)}accepts(e){return typeof e=="function"&&this.#e.some(r=>Object.prototype.isPrototypeOf.call(r,e)||Object.prototype.isPrototypeOf.call(r.prototype,e))}entries(){return this.#t.slice()}every(e){return this.entries().every(e)}filter(e){return this.entries().filter(e)}forEach(e){return this.entries().forEach(e)}getBy(e,r){return this.filter(o=>{let a=o[e];return a instanceof Function?a.bind(o)()===r:o[e]===r})}includes(e){return this.#t.includes(e)}indexOf(e){return this.#t.indexOf(e)}get length(){return this.entries().length}map(e){return this.entries().map(e)}register(...e){e.forEach(r=>{if(!this.accepts(r))throw new TypeError(`Registry#register: Invalid entity attempted to be registered: '${r}'.`);this.#t.includes(r)||this.#t.push(r)})}some(e){return this.entries().some(e)}unregister(...e){e.forEach(r=>{let o=this.#t.indexOf(r);o>-1&&this.#t.splice(o,1)})}};t(De,"ConstructorRegistry")});var ou,h,A=n(()=>{E();Hi();ou=class extends De{constructor(){super(v)}};t(ou,"AdvanceRegistry");h=new ou});var Pl,l,B=n(()=>{Pl=class{#e=null;constructor(e){e&&(this.#e=e)}validate(...e){return this.#e===null?!0:this.#e(...e)}};t(Pl,"Criterion");l=Pl});var nu,au,$d=n(()=>{B();nu=class extends l{#e=[];constructor(...e){super(),e.forEach(r=>{this.#e.push(r)})}criteria(){return this.#e}validate(...e){return this.#e.every(r=>r.validate(...e))}};t(nu,"Criteria");au=nu});var su,Ya,Jd=n(()=>{$d();su=class extends au{};t(su,"And");Ya=su});var lu,m,I=n(()=>{lu=class{#e;constructor(e){this.#e=e}apply(...e){return this.#e(...e)}};t(lu,"Effect");m=lu});var mu,Or,Sa=n(()=>{mu=class{#e;constructor(e=2e3){this.#e=e}value(){return this.#e}};t(mu,"Priority");Or=mu});var Hn,Fa,Bl=n(()=>{Sa();Hn=class extends Or{constructor(){super(1e3)}};t(Hn,"High");Fa=Hn});var Qe,ix,Zd=n(()=>{Sa();Qe=class extends Or{constructor(){super(3e3)}};t(Qe,"Low");ix=Qe});var Al,ox=n(()=>{Sa();Al=class extends Or{constructor(){super(2e3)}};t(Al,"Normal")});var Kn=n(()=>{Bl();Zd();ox()});var pu,x,M=n(()=>{Jd();B();I();Kn();pu=class{#e;#t=!0;#r;#i=new Al;constructor(...e){let r=[];e.forEach(o=>{if(o instanceof m){if(this.#r)throw new TypeError("Rule: effect already specified, but another was provided.");this.#r=o;return}if(o instanceof l){r.push(o);return}this.#i=o}),r.length&&(this.#e=new Ya(...r))}disable(){this.#t=!1}enable(){this.#t=!0}enabled(){return this.#t}priority(){return this.#i}process(...e){if(!!this.#t&&this.#r instanceof m)return this.#r.apply(...e)}validate(...e){return this.#t?this.#e instanceof l?this.#e.validate(...e):!0:!1}};t(pu,"Rule");x=pu});var uu,d,P=n(()=>{Ce();M();uu=class extends O{#e=new Map;constructor(){super(x)}entries(){return super.entries().sort((e,r)=>e.priority().value()-r.priority().value())}get(e){return this.#e.has(e)||this.#e.set(e,this.filter(r=>r.enabled()&&r instanceof e)),this.#e.get(e)||[]}invalidateCache(e){this.#e.delete(e instanceof x?e.constructor:e)}process(e,...r){return this.get(e).filter(o=>o.validate(...r)).map(o=>o.process(...r))}register(...e){super.register(...e),e.forEach(r=>this.invalidateCache(r))}unregister(...e){super.unregister(...e),e.forEach(r=>this.invalidateCache(r))}};t(uu,"RuleRegistry");d=new uu});var cu,Na,yu=n(()=>{M();cu=class extends x{};t(cu,"Complete");Na=cu});var fu,du,Qd=n(()=>{M();fu=class extends x{};t(fu,"Cost");du=fu});var gu,hu,Xd=n(()=>{M();gu=class extends x{};t(gu,"Requirements");hu=gu});var za,W,$e=n(()=>{Z();za=class extends S{#e=[];#t=null;constructor(e=0,r="initial"){super(),this.addKey("value","values"),this.add(e,r)}add(e,r=""){if(e instanceof za)return this.add(e.value(),r);this.#e.push([e,r]),this.#t=null}clone(){return new this.constructor(this)}set(e,r=""){if(this.#e.splice(0),e instanceof za)return this.set(e.value(),r);this.#e.push([e,r]),this.#t=e}subtract(e,r=""){if(e instanceof za)return this.subtract(e.value(),r);this.#e.push([-e,r]),this.#t=null}value(){return this.#t===null&&(this.#t=this.#e.reduce((e,[r])=>e+r,0)),this.#t}values(){return this.#e}};t(za,"Yield");W=za});var ks,nx=n(()=>{$e();ks=class extends W{};t(ks,"Research")});var ax=n(()=>{nx()});var Ru,xu,eg=n(()=>{M();Ru=class extends x{};t(Ru,"Started");xu=Ru});var vu,Ul,bu=n(()=>{A();Z();P();yu();Qd();Xd();ax();eg();vu=class extends S{#e;#t=[];#r=null;#i;#o=new ks(1/0);#a=new ks(0);#n;constructor(e,r=h,o=d){super(),this.#e=r,this.#i=e,this.#n=o,this.addKey("available","complete","cost","progress","researching")}add(e){this.#a.add(e),this.check()}addAdvance(e){if(this.#t.some(o=>o instanceof e))return;this.#r===e&&(this.#r=null);let r=new e;this.#t.push(r),this.#n.process(Na,this,r)}available(){let e=this.#n.get(hu);return this.#e.filter(r=>e.filter(o=>o.validate(r,this.#t)).every(o=>o.process(r,this.#t)===!0)&&!this.#t.some(o=>o instanceof r))}check(){if(this.#r!==null&&this.#a.value()>=this.#o.value()){let e=new this.#r;this.#t.push(e),this.#r=null,this.#a.subtract(this.#o),this.#o.set(1/0),this.#n.process(Na,this,e)}}complete(){return this.#t}completed(e){return this.#t.some(r=>r instanceof e)}cost(){return this.#o}player(){return this.#i}progress(){return this.#a}research(e){let[r]=this.#n.process(du,e,this);this.#o.set(r),this.#r=e,this.#n.process(xu,this,e)}researching(){return this.#r}};t(vu,"PlayerResearch");Ul=vu});var Cu,z,He=n(()=>{Ce();bu();Cu=class extends O{constructor(){super(Ul)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of results for player.");return r[0]}};t(Cu,"PlayerResearchRegistry");z=new Cu});var Ml,El,Qm=n(()=>{Ml=class{#e;#t;constructor(e,r){this.#e=e,this.#t=r}goodyHut(){return this.#e}perform(){}unit(){return this.#t}};t(Ml,"Action");El=Ml});var La,sx=n(()=>{He();Qm();La=class extends El{#e;#t;constructor(e,r,o=z,a=()=>Math.random()){super(e,r),this.#e=o,this.#t=a}perform(){let e=this.#e.getByPlayer(this.unit().player()),r=e.available(),o=r[Math.floor(r.length*this.#t())];e.addAdvance(o)}};t(La,"Advance")});var Tu,yr,Ds=n(()=>{M();Tu=class extends x{};t(Tu,"Captured");yr=Tu});var Iu,Xe,Gl=n(()=>{M();Iu=class extends x{};t(Iu,"Cost");Xe=Iu});var wu,Wo,Pu=n(()=>{M();wu=class extends x{};t(wu,"Created");Wo=wu});var Bu,fr,Os=n(()=>{M();Bu=class extends x{};t(Bu,"Destroyed");fr=Bu});var Au,Uu,tg=n(()=>{M();Au=class extends x{};t(Au,"Created");Uu=Au});var Mu,bn,kl=n(()=>{Z();P();tg();Mu=class extends S{#e;constructor(e=d){super(),this.#e=e,this.#e.process(Uu,this)}clone(){return new this.constructor(this.#e)}};t(Mu,"Terrain");bn=Mu});var j,lx=n(()=>{kl();j=class extends bn{};t(j,"Land")});var Jt,rg=n(()=>{kl();Jt=class extends bn{};t(Jt,"Water")});var Zt=n(()=>{lx();rg()});var Eu,Gu,ig=n(()=>{M();Eu=class extends x{};t(Eu,"YieldModifier");Gu=Eu});var ku,ai,og=n(()=>{M();ku=class extends x{};t(ku,"Yield");ai=ku});var Dl,ue,Ki=n(()=>{Z();Zt();P();Ou();$e();ig();og();Dl=class extends S{#e;#t=[];#r;#i;#o;#a;#n=new Map;constructor(e,r,o,a,s=d){super(),this.#o=e,this.#a=r,this.#i=o,this.#e=a,this.#r=s,this.addKey("terrain","isCoast","isLand","isWater","x","y","yields")}clearYieldCache(e=null){this.#n.delete(e)}getAdjacent(){return this.getAdjacentDirections().map(e=>this.getNeighbour(e))}getAdjacentDirections(){return["n","e","s","w"]}getNeighbour(e){return e==="n"?this.#e.get(this.#o,this.#a-1):e==="ne"?this.#e.get(this.#o+1,this.#a-1):e==="e"?this.#e.get(this.#o+1,this.#a):e==="se"?this.#e.get(this.#o+1,this.#a+1):e==="s"?this.#e.get(this.#o,this.#a+1):e==="sw"?this.#e.get(this.#o-1,this.#a+1):e==="w"?this.#e.get(this.#o-1,this.#a):this.#e.get(this.#o-1,this.#a-1)}getNeighbouringDirections(){return["n","ne","e","se","s","sw","w","nw"]}getNeighbours(){return this.#t.length||(this.#t=this.getNeighbouringDirections().map(e=>this.getNeighbour(e))),this.#t}getSurroundingArea(e=2){return Du.fromSurrounding(this,e)}distanceFrom(e){let r=[[-1,1],[-1,0],[-1,-1],[0,1],[0,0],[0,-1],[1,1],[1,0],[1,-1]],[o]=r.map(([a,s])=>Math.hypot(this.#o-e.x()+a*this.#e.width(),this.#a-e.y()+s*this.#e.height())).sort((a,s)=>a-s);return o}isCoast(){let e=this;return e.isWater()&&e.getNeighbours().some(r=>r.isLand())||e.isLand()&&e.getNeighbours().some(r=>r.isWater())}isLand(){return this.#i instanceof j}isNeighbourOf(e){return this.getNeighbours().includes(e)}isWater(){return this.#i instanceof Jt}map(){return this.#e}score(e=null,r=[[W,3]]){return this.yields(e).map(a=>{let[s]=r.filter(([u])=>a instanceof u),p=s?s[1]||1:0;return a.value()*p}).reduce((a,s)=>a+s,0)}terrain(){return this.#i}setTerrain(e){this.#i=e}x(){return this.#o}y(){return this.#a}yields(e=null){if(!this.#n.has(e)){let r=this.#r.process(ai,this,e).flat();this.#r.process(Gu,this,e,r).flat(),this.#n.set(e,r)}return this.#n.get(e)}};t(Dl,"Tile");ue=Dl});var Ol,Du,Ou=n(()=>{Ce();Ki();Ol=class extends O{static from(...e){return new this(...e)}static fromSurrounding(e,r=2){let o=t(a=>{let s=[];for(let p=e.x()-a;p<=e.x()+a;p++)for(let u=e.y()-a;u<=e.y()+a;u++)s.push([p,u]);return s},"gen");return this.from(...o(r).map(([a,s])=>e.map().get(a,s)))}constructor(...e){super(Dl),this.register(...e)}push(...e){this.register(...e)}shift(){let[e]=this.entries();return this.unregister(e),e}score(e=null,r=[]){return this.entries().reduce((o,a)=>o+a.score(e,r),0)}yields(e=null){return this.entries().flatMap(r=>r.yields(e))}};t(Ol,"Tileset");Du=Ol});var Yl,jo,Sl=n(()=>{M();Yl=class extends x{};t(Yl,"Yield");jo=Yl});var Yu,Ys,Su=n(()=>{M();Yu=class extends x{};t(Yu,"YieldModifier");Ys=Yu});var Fu,et,qn=n(()=>{Z();P();Ds();Gl();Pu();Os();Ou();$e();Sl();Su();Fu=class extends S{#e;#t;#r;#i;#o;#a;#n=new Du;constructor(e,r,o,a=d){super(),this.#e=o,this.#t=e,this.#r=e,this.#o=r,this.#a=this.#o.getSurroundingArea(),this.#n.push(r),this.#i=a,this.#i.process(Wo,this),this.addKey("name","originalPlayer","player","tile","tiles","tilesWorked","yields")}capture(e){let r=this.#r;this.#r=e,this.#i.process(yr,this,e,r)}destroy(e=null){this.#i.process(fr,this,e)}name(){return this.#e}setName(e){this.#e=e}originalPlayer(){return this.#t}player(){return this.#r}tile(){return this.#o}tiles(){return this.#a}tilesWorked(){return this.#n}yields(){let e=[];return[this.#i.get(jo),this.#i.get(Ys),this.#i.get(Xe)].flat().forEach(r=>{if(!r.validate(this,e))return;let o=r.process(this,e);if(!!o){if(o instanceof W){e.push(o);return}o.forEach(a=>e.push(a))}}),e}};t(Fu,"City");et=Fu});var Nu,_,tt=n(()=>{Ce();qn();Nu=class extends O{constructor(){super(et)}getByPlayer(e){return this.filter(r=>r.player()===e)}getByTile(e){let[r]=this.filter(o=>o.tile()===e);return r??null}};t(Nu,"CityRegistry");_=new Nu});var Wa,mx=n(()=>{tt();P();Qm();qn();Wa=class extends El{#e;constructor(e,r,o=_){super(e,r),this.#e=o}perform(e=d){let r=this.unit().player(),o=new et(r,this.goodyHut().tile(),r.civilization().getCityName(!0),e);this.#e.register(o)}};t(Wa,"City")});var ja,px,zu=n(()=>{Z();P();ja=class extends S{static build(e,r=d){throw new TypeError("createFromObject: Must be overridden in extending class")}};t(ja,"Buildable");px=ja});var Lu,Cn,Fl=n(()=>{Hi();zu();Lu=class extends De{constructor(){super(px)}};t(Lu,"AvailableCityBuildItemsRegistry");Cn=new Lu});var Qt,ux,Xm=n(()=>{B();M();Qt=class extends x{process(e,r){let o=super.process(e,r);if(!(o instanceof Pl))throw new TypeError("Invalid build rule.");return o}};t(Qt,"Build");ux=Qt});var Wu,ju,ng=n(()=>{Z();Wu=class extends Fe{#e;constructor(e){super(),this.addKey("value"),this.#e=e}value(){return this.#e}};t(Wu,"BuildCost");ju=Wu});var ep,cx,Nl,dY,tp=n(()=>{ng();B();I();M();ep=class extends x{};t(ep,"BuildCost");cx=ep,Nl=t((i,e)=>dY([[i,e]]),"buildCost"),dY=t(i=>i.map(([e,r])=>new ep(new l(o=>o.item()===e),new m(()=>new ju(r)))),"buildCosts")});var _u,Hu,ag=n(()=>{P();ng();tp();Z();_u=class extends Fe{#e;#t=new ju(1/0);#r;#i;constructor(e,r=null,o=d){super(),this.#r=e,this.#e=r,this.#i=o,this.addKey("cost","item")}cost(){if(!Number.isFinite(this.#t.value())){let[e]=this.#i.process(cx,this,this.#e);e&&(this.#t=e)}return this.#t}item(){return this.#r}};t(_u,"BuildItem");Hu=_u});var Ss,yx=n(()=>{$e();Ss=class extends W{};t(Ss,"BuildProgress")});var fx=n(()=>{yx()});var Ku,dx,gx=n(()=>{M();Ku=class extends x{};t(Ku,"BuildingCancelled");dx=Ku});var qu,Vn,rp=n(()=>{M();qu=class extends x{};t(qu,"BuildingComplete");Vn=qu});var Vu,zl,$u=n(()=>{Fl();Z();P();Xm();ag();fx();gx();rp();Vu=class extends S{#e;#t=null;#r;#i=new Ss(1/0);#o=new Ss;#a;constructor(e,r=Cn,o=d){super(),this.#e=r,this.#r=e,this.#a=o,this.addKey("available","building","city","cost","progress","remaining")}add(e){this.#o.add(e)}available(){let e=this.#a.get(ux);return this.#e.filter(r=>e.filter(o=>o.validate(this.city(),r)).every(o=>o.process(this.city(),r).validate())).map(r=>new Hu(r,this.city(),this.#a))}build(e){let r=this.getAvailable(e);if(!r)throw new TypeError(`Cannot build ${e.name}, it's not available.`);this.#t=r,this.#i.set(this.#t.cost().value())}building(){return this.#t}check(){if(this.#o.value()>=this.#i.value()&&this.#t){let e=this.#t.item().build(this.#r,this.#a);return this.#o.set(0),this.#t=null,this.#i.set(1/0),this.#a.process(Vn,this,e),e}return null}city(){return this.#r}cost(){return this.#i}getAvailable(e){return this.available().filter(r=>r.item()===e)[0]}progress(){return this.#o}remaining(){return this.#i.value()-this.#o.value()}revalidate(){this.#t&&!this.getAvailable(this.#t.item())&&(this.#t=null,this.#i.set(1/0),this.#a.process(dx,this))}};t(Vu,"CityBuild");zl=Vu});var Ju,Xt,$n=n(()=>{Ce();$u();Ju=class extends O{constructor(){super(zl)}getByCity(e){let r=this.getBy("city",e);if(r.length!==1)throw new TypeError("Wrong number of entities returned.");return r[0]}};t(Ju,"CityBuildRegistry");Xt=new Ju});var Zu,Fs,sg=n(()=>{M();Zu=class extends x{};t(Zu,"Spend");Fs=Zu});var Qu,Xu,lg=n(()=>{$n();P();sg();$e();Qu=class extends W{#e;#t;#r;constructor(e,r=Xt,o=d){super(),this.#e=e,this.#t=o,this.#r=r}buy(e){let r=this.#r.getByCity(e),o=this.cost(e);e.player()!==this.#e||this.value()<o.value()||(r.add(new W(r.remaining())),this.subtract(o.value()))}cost(e){let r=this.#r.getByCity(e),o=new W;return this.#t.process(Fs,r,o).reduce((a,s)=>(a.add(s),a))}player(){return this.#e}};t(Qu,"PlayerTreasury");Xu=Qu});var ec,si,Ns=n(()=>{Ce();lg();ec=class extends O{constructor(){super(Xu)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerTreasuries for player.");return r[0]}};t(ec,"PlayerTreasuryRegistry");si=new ec});var er,tc,Ll=n(()=>{$e();er=class extends W{};t(er,"Gold");tc=er});var _a,hx=n(()=>{Ns();Qm();Ll();_a=class extends El{#e;constructor(e,r,o=si){super(e,r),this.#e=o}perform(){this.#e.getByPlayer(this.unit().player()).add(new er(50))}};t(_a,"Gold")});var rc,ic,mg=n(()=>{M();rc=class extends x{};t(rc,"Unit");ic=rc});var Ha,Rx=n(()=>{Qm();P();mg();Ha=class extends Ml{#e;#t;constructor(e,r,o=()=>Math.random(),a=d){super(e,r),this.#e=o,this.#t=a}perform(){this.#t.process(ic,this.goodyHut(),this.unit())}};t(Ha,"Unit")});var pg=n(()=>{sx();mx();hx();Rx()});var Ka,xx=n(()=>{ka();Ka=class extends Dr{};t(Ka,"ChangeProduction")});var Tn,vx=n(()=>{Gs();Tn=class extends ni{};t(Tn,"CityBuild")});var ug=n(()=>{xx();vx()});var qa,bx,oc=n(()=>{qa=class{#e;constructor(e){this.#e=e}player(){return this.#e}takeTurn(){return new Promise((e,r)=>r(new TypeError("Client#takeTurn must be implemented.")))}};t(qa,"Client");bx=qa});var nc,Va,ip=n(()=>{$e();nc=class extends W{#e;constructor(e,r){super(r),this.#e=e}leader(){return this.#e}};t(nc,"Trait");Va=nc});var ac,sc,cg=n(()=>{Ce();ip();ac=class extends O{constructor(){super(Va)}getByLeader(e){return this.getBy("leader",e)}getBySubclass(e){return this.filter(r=>r instanceof e)}};t(ac,"TraitRegistry");sc=new ac});var lc,ee,st=n(()=>{cg();Z();lc=class extends S{#e=[];constructor(e=sc){super();let r=e.getByLeader(this.sourceClass());this.#e.push(...r),this.addKey("name")}static civilization(){throw new TypeError("Must be implemented in extending class")}name(){throw new TypeError("Must be implemented in extending class")}traits(){return[...this.#e]}};t(lc,"Leader");ee=lc});var mc,In,Wl=n(()=>{Hi();st();mc=class extends De{constructor(){super(ee)}getByCivilization(e){return this.getBy("civilization",e)}};t(mc,"LeaderRegistry");In=new mc});var $a,Cx=n(()=>{ka();$a=class extends Dr{};t($a,"AdjustTradeRates")});var yg=n(()=>{Cx()});var pc,Te,dr=n(()=>{M();pc=class extends x{};t(pc,"Busy");Te=pc});var zs,Tx,fg=n(()=>{Gs();zs=class extends ni{};t(zs,"ChooseResearch");Tx=zs});var uc,cc,dg=n(()=>{M();uc=class extends x{};t(uc,"Cost");cc=uc});var wn,gg,yc=n(()=>{$e();wn=class extends W{};t(wn,"FoodStorage");gg=wn});var fc,np,hg=n(()=>{M();fc=class extends x{};t(fc,"FoodStorage");np=fc});var dc,Pn,gc=n(()=>{M();dc=class extends x{};t(dc,"Grow");Pn=dc});var hc,Ls,Rg=n(()=>{M();hc=class extends x{};t(hc,"Shrink");Ls=hc});var Rc,Ws,xc=n(()=>{Z();P();dg();yc();hg();gc();Rg();Rc=class extends S{#e;#t=new gg(1/0);#r=new gg;#i;#o=1;constructor(e,r=d){super(),this.#e=e,this.#i=r,this.setCost(),this.addKey("cost","progress","size")}add(e){this.#r.add(e)}check(){this.#i.process(np,this)}city(){return this.#e}cost(){return this.#t}setCost(){let e=this.#i.process(cc,this);e.length>0&&this.#t.set(e[0],"setCost")}empty(){this.#r.subtract(this.#r.value())}grow(){this.#o++,this.#i.process(Pn,this)}progress(){return this.#r}shrink(){this.#o--,this.#i.process(Ls,this)}size(){return this.#o}};t(Rc,"CityGrowth");Ws=Rc});var vc,ap,xg=n(()=>{M();vc=class extends x{};t(vc,"Created");ap=vc});var bc,Y,Ae=n(()=>{zu();P();xg();bc=class extends ja{#e;#t;constructor(e,r=d){super(),this.#e=e,this.#t=r,this.#t.process(ap,this,e)}city(){return this.#e}static build(e,r=d){return new this(e,r)}};t(bc,"CityImprovement");Y=bc});var Cc,fe,tr=n(()=>{Z();Cc=class extends S{#e;#t;#r;constructor(e,r,o){super(),this.#e=e,this.#t=r,this.#r=o,this.addKey("name","value")}civilization(){return this.#e}name(){return this.#t}value(){return this.#r}};t(Cc,"Attribute");fe=Cc});var jl,de,rr=n(()=>{Ce();tr();jl=class extends O{constructor(){super(fe)}getByCivilization(e){return this.getBy("civilization",e)}getByName(e){return this.getBy("name",e)}};t(jl,"AttributeRegistry");de=new jl});var Tc,Q,Dt=n(()=>{Tc=class{#e;#t;#r=!1;constructor(e,r,o=!1){this.#e=e,this.#t=r,this.#r=o}name(){return this.#e}civilization(){return this.#t}capital(){return this.#r}};t(Tc,"CityName");Q=Tc});var Ic,J,gt=n(()=>{Ce();Dt();Ic=class extends O{#e=1;#t;constructor(e=()=>Math.random()){super(Q),this.#t=e}takeByCivilization(e){let[r]=this.getBy("civilization",e).sort(()=>Math.floor(this.#t()*3)-1);return r instanceof Q?(this.unregister(r),r.name()):this.takeUnassociated()}takeCapitalByCivilization(e){let[r]=this.getBy("civilization",e).sort(()=>Math.floor(this.#t()*3)-1).filter(o=>o.capital());return r instanceof Q?(this.unregister(r),r.name()):this.takeByCivilization(e)}takeUnassociated(){let[e]=this.getBy("civilization",null).sort(()=>Math.floor(this.#t()*3)-1);return e instanceof Q?(this.unregister(e),e.name()):`City #${this.#e++}`}};t(Ic,"CityNameRegistry");J=new Ic});var wc,ae,Ot=n(()=>{rr();gt();Z();wc=class extends S{#e=null;#t;#r=new jl;constructor(e=de,r=J){super(),this.#t=r,this.#r.register(...e.getByCivilization(this.sourceClass())),this.addKey("name","leader","attributes")}attributes(){return this.#r.entries()}name(){return this.constructor.name}leader(){return this.#e}setLeader(e){this.#e=e}getCityName(e=!1){let r=this.sourceClass();return e?this.#t.takeCapitalByCivilization(r):this.#t.takeByCivilization(r)}};t(wc,"Civilization");ae=wc});var Ja,Ix=n(()=>{ka();Ja=class extends Dr{value(){return super.value()}};t(Ja,"CompleteProduction")});var vg=n(()=>{Ix()});var js,Bc,Ac=n(()=>{Gs();js=class extends ni{};t(js,"EndTurn");Bc=js});var Uc,ht,Jn=n(()=>{M();Uc=class extends x{};t(Uc,"Action");ht=Uc});var Mc,li,_s=n(()=>{M();Mc=class extends x{};t(Mc,"Added");li=Mc});var Ec,bg,Px=n(()=>{ka();Ec=class extends Dr{};t(Ec,"HiddenPlayerAction");bg=Ec});var Gc,H,_o=n(()=>{Z();P();Jn();_s();Px();Gs();Gc=class extends S{#e=null;#t;constructor(e=d){super(),this.#t=e,this.#t.process(li,this),this.addKey("actions","civilization","mandatoryActions")}action(){let[e]=this.actions();return e}actions(){return this.#t.process(ht,this).flat().filter(e=>!(e instanceof bg))}civilization(){if(this.#e===null)throw new TypeError("Player#civilization is unset.");return this.#e}hasActions(){return!!this.action()}hasMandatoryActions(){return this.actions().some(e=>e instanceof ni)}hiddenActions(){return this.#t.process(ht,this).flat().filter(e=>e instanceof bg)}mandatoryAction(){let[e]=this.mandatoryActions();return e}mandatoryActions(){return this.actions().filter(e=>e instanceof ni)}setCivilization(e){this.#e=e}};t(Gc,"Player");H=Gc});var kc,_l,Cg=n(()=>{kt();Z();Ki();kc=class extends S{#e={};#t;#r;#i;constructor(e,r,o=re){super(),this.#t=o,this.#r=r,this.#i=e,this.addKey("isCoast","isLand","isWater","terrain","x","y","yields"),this.setAdditionalData()}addKey(...e){super.addKey(...e)}isCoast(){return this.#i.isCoast()}isLand(){return this.#i.isLand()}isWater(){return this.#i.isWater()}player(){return this.#r}setAdditionalData(){this.#t.getByType(ue).forEach(e=>{this.#e[e.key()]=e.data(this.#i),Object.defineProperty(this,e.key(),{configurable:!0,value:()=>e.data(this.#i)}),this.addKey(e.key())})}terrain(){return this.#i.terrain()}tile(){return this.#i}update(){this.#i.clearYieldCache(this.#r),this.setAdditionalData()}x(){return this.#i.x()}y(){return this.#i.y()}yields(){return this.#i.yields(this.#r)}};t(kc,"PlayerTile");_l=kc});var Dc,Bx,Ax=n(()=>{kl();Dc=class extends bn{};t(Dc,"Unknown");Bx=Dc});var Oc,Ux,Mx=n(()=>{Ki();Ax();Oc=class extends ue{constructor(e,r,o){super(e,r,new Bx,o)}};t(Oc,"UndiscoveredTile");Ux=Oc});var Yc,Sc,Tg=n(()=>{M();Yc=class extends x{};t(Yc,"VisibilityChanged");Sc=Yc});var Fc,Hl,Nc=n(()=>{Z();P();Cg();Ki();Mx();Tg();Fc=class extends S{#e;#t;#r=[];#i;constructor(e,r,o=d){super(),this.#e=e,this.#i=r,this.#t=o,this.addKey("height","tiles","width")}entries(){return this.#r}filter(e){return this.entries().filter(e)}forEach(e){return this.#r.forEach(e)}get(e,r){let[o]=this.entries().filter(a=>a.x()===e&&a.y()===r);return o||new Ux(e,r,this.#i)}getByTile(e){let[r]=this.filter(o=>o.tile()===e);return r??null}height(){return this.#i.height()}includes(e){return e instanceof ue?!!this.getByTile(e):this.#r.includes(e)}map(e){return this.#r.map(e)}player(){return this.#e}register(...e){e.forEach(r=>{this.includes(r)||(this.#r.push(new _l(r,this.#e)),this.#t.process(Sc,r,this.player()))})}tiles(){return this.entries()}width(){return this.#i.width()}};t(Fc,"PlayerWorld");Hl=Fc});var Qa,kx=n(()=>{ka();Qa=class extends Dr{};t(Qa,"Revolution")});var Ig=n(()=>{kx()});var qi,Dx=n(()=>{$e();qi=class extends W{};t(qi,"Attack")});var mi,Ox=n(()=>{$e();mi=class extends W{};t(mi,"Defence")});var Vi,Yx,wg=n(()=>{$e();Vi=class extends W{};t(Vi,"Movement");Yx=Vi});var Vl,Sx=n(()=>{wg();Vl=class extends Yx{};t(Vl,"Moves")});var Xa,Fx=n(()=>{$e();Xa=class extends W{};t(Xa,"Visibility")});var $l=n(()=>{Dx();Ox();wg();Sx();Fx()});var At,Pg,$i,Zn,Jl,Bg=n(()=>{B();I();M();At=class extends x{};t(At,"Action");Pg=At,$i=new l(i=>i.moves().value()>=.1),Zn=new l((i,e,r=i.tile())=>r===e),Jl=new l((i,e,r=i.tile())=>e.isNeighbourOf(r))});var _c,Zl,Ag=n(()=>{M();_c=class extends x{};t(_c,"Activate");Zl=_c});var Hc,Qn,Kc=n(()=>{M();Hc=class extends x{};t(Hc,"Created");Qn=Hc});var qc,Xn,Vc=n(()=>{M();qc=class extends x{};t(qc,"Destroyed");Xn=qc});var $c,Jc,Ug=n(()=>{M();$c=class extends x{};t($c,"Visibility");Jc=$c});var es,Hs,cp,Nx,Ql=n(()=>{$l();B();I();M();es=class extends x{};t(es,"BaseYield");Hs=class extends x{};t(Hs,"Yield");cp=Hs,Nx=t((i,e=1,r=1,o=1,a=1)=>[...[[qi,e],[mi,r],[Vi,o],[Xa,a]].flatMap(([s,p])=>[new Hs(new l(u=>u instanceof i),new l((u,y)=>y instanceof s),new m((u,y)=>y.set(p))),new es(new l(u=>u===i),new l((u,y)=>y instanceof s),new m((u,y)=>y.set(p)))])],"unitYield")});var Zc,we,ea=n(()=>{$l();zu();P();Bg();Ag();Kc();Vc();Ug();Ql();Zc=class extends ja{#e=!0;#t=null;#r;#i=!1;#o=new Vl;#a;#n;#l=null;#s;#m=!1;constructor(e,r,o,a=d){super(),this.#r=e,this.#a=r,this.#s=o,this.#n=a,this.addKey("actions","actionsForNeighbours","active","attack","busy","city","defence","movement","moves","player","status","tile","visibility","waiting"),this.#n.process(Qn,this)}action(e,...r){return e.perform(...r)}actions(e=this.#s,r=this.#s){return typeof e=="string"&&(e=r.getNeighbour(e)),this.#n.process(Pg,this,e,r)}actionsForNeighbours(e=this.#s){return e.getNeighbouringDirections().reduce((r,o)=>({...r,[o]:this.#n.process(Pg,this,e.getNeighbour(o),e)}),{})}activate(){this.#n.process(Zl,this)}active(){return this.#e}setActive(e=!0){this.#e=e}applyVisibility(){this.#s.getSurroundingArea(this.visibility().value()).forEach(e=>{this.#n.process(Jc,e,this.#a)})}attack(){let[e]=this.yield(new qi);return e}busy(){return this.#t}setBusy(e=null){this.#t=e}city(){return this.#r}static build(e,r=d){return new this(e,e.player(),e.tile(),r)}defence(){let[e]=this.yield(new mi);return e}destroy(e=null){this.#n.process(Xn,this,e)}destroyed(){return this.#i}setDestroyed(){this.#i=!0}movement(){let[e]=this.yield(new Vi);return e}moves(){return this.#o}player(){return this.#a}status(){return this.#l}setStatus(e){this.#l=e}tile(){return this.#s}setTile(e){this.#s=e}visibility(){let[e]=this.yield(new Xa);return e}waiting(){return this.#m}setWaiting(e=!0){this.#m=e}yield(...e){let r=this.#n.get(cp);return e.forEach(o=>r.filter(a=>a.validate(this,o)).forEach(a=>a.process(this,o))),e}};t(Zc,"Unit");we=Zc});var Qc,ce,ir=n(()=>{Ce();xc();Qc=class extends O{constructor(){super(Ws)}getByCity(e){let r=this.getBy("city",e);if(r.length!==1)throw new TypeError("Wrong number of CityGrowths returned.");return r[0]}};t(Qc,"CityGrowthRegistry");ce=new Qc});var ge,xe,Pe=n(()=>{Ae();ge=class extends Y{};t(ge,"Wonder");xe=ge});var Xl,pi,ts=n(()=>{Ce();_o();Xl=class extends O{constructor(){super(H)}};t(Xl,"PlayerRegistry");pi=new Xl});var ry,ta,bp=n(()=>{ts();ry=class extends Xl{};t(ry,"CurrentPlayerRegistry");ta=new ry});var iy,oy,kg=n(()=>{iy=class{#e={};on(e,r){e in this.#e||(this.#e[e]=[]),this.#e[e].push(r)}once(e,r){let o=t((...a)=>{r(...a),this.off(e,o)},"onceHandler");this.on(e,o)}off(e,r){if(!(e in this.#e))return;let o=this.#e[e].indexOf(r);o!==-1&&this.#e[e].splice(o,1)}emit(e,...r){e in this.#e&&this.#e[e].forEach(o=>o(...r))}};t(iy,"EventEmitter");oy=iy});var ny,w,V=n(()=>{kg();ny=class extends oy{#e={};#t=!1;debug(e){if(!!this.option("debug"))return e()}emit(e,...r){return this.debug(()=>console.log(`Engine#emit: ${String(e)}: ${r}`)),super.emit(e,...r)}loadPlugins(){return this.emit("plugins:load:start"),new Promise((e,r)=>{this.once("plugins:load:end",()=>e())})}option(e,r=null){return this.#e[e]||r}setOption(e,r){this.#e[e]!==r&&(this.#e[e]=r,this.emit("option:changed",e,r))}start(){this.#t||(this.#t=!0,this.emit("engine:initialise"),this.loadPlugins().then(()=>{this.emit("engine:start")}))}};t(ny,"Engine");w=new ny});var ay,ie,Ji=n(()=>{Ce();Nc();ay=class extends O{constructor(){super(Hl)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError(`Wrong number of player worlds exist for player: ${e.id()}`);return r[0]}};t(ay,"PlayerWorldRegistry");ie=new ay});var sy,Ue,ui=n(()=>{Z();sy=class extends S{#e=0;constructor(){super(),this.addKey("value")}increment(){return this.#e++,this.#e}value(){return this.#e}};t(sy,"Turn");Ue=new sy});var ly,N,Ke=n(()=>{Ce();ea();ly=class extends O{constructor(){super(we)}getByCity(e){return this.getBy("city",e)}getByPlayer(e){return this.getBy("player",e)}getByTile(e){return this.getBy("tile",e)}};t(ly,"UnitRegistry");N=new ly});var my,rs,Dg=n(()=>{M();my=class extends x{};t(my,"Year");rs=my});var $,Ho,Ks=n(()=>{$e();$=class extends W{};t($,"Food");Ho=$});var K,ra,em=n(()=>{$e();K=class extends W{};t(K,"Production");ra=K});var se,ia,oa=n(()=>{$e();se=class extends W{};t(se,"Trade");ia=se});var is=n(()=>{Ks();em();oa()});var na,qe,Zi=n(()=>{na=t((i,...e)=>i.reduce((r,o)=>{let a=e.findIndex(s=>o instanceof s);return a===-1||(r[a]+=o.value()),r},e.map(()=>0)),"reduceYields"),qe=t((i,e)=>na(i,e).shift()??0,"reduceYield")});var gY,hY,jx,_x,os,tm=n(()=>{ir();is();Ji();Zi();gY=t((i,e=[[$,8],[K,3*(qe(i.tilesWorked().yields(i.player()),K)===0?3:1)],[se,1*(qe(i.tilesWorked().yields(i.player()),se)===0?3:1)]])=>i.tiles().entries().sort((r,o)=>o.score(i.player(),e)-r.score(i.player(),e)),"getHighestValueCityTiles"),hY=t((i,e=ie)=>gY(i).filter(r=>e.getByPlayer(i.player()).includes(r)&&!i.tilesWorked().includes(r)&&i.tile()!==r),"getHighestValueAvailableCityTiles"),jx=t((i,e=ie,r=ce)=>{i.tilesWorked().unregister(...i.tilesWorked().entries()),i.tilesWorked().register(i.tile()),_x(i,e,r)},"reassignWorkers"),_x=t((i,e=ie,r=ce)=>{let o=r.getByCity(i);hY(i,e).some(a=>i.tilesWorked().length>=o.size()+1?!0:(i.tilesWorked().register(a),!1))},"assignWorkers"),os=_x});var An,im,Vs=n(()=>{P();Z();An=class extends S{#e;#t;#r;#i;constructor(e,r,o,a=d){super(),this.#e=e,this.#t=a,this.#r=r,this.#i=o,this.addKey("from","to")}forUnit(e){return new this.constructor(this.#e,this.#r,e,this.#t)}from(){return this.#e}perform(...e){}ruleRegistry(){return this.#t}to(){return this.#r}unit(){return this.#i}};t(An,"Action");im=An});var yy,Ko,Cp=n(()=>{M();yy=class extends x{};t(yy,"Defeated");Ko=yy});var as,Vx=n(()=>{P();Ke();Vs();Cp();as=class extends im{#e;#t;constructor(e,r,o,a=d,s=N,p=()=>Math.random()){super(e,r,o,a),this.#t=s,this.#e=p}perform(){let[e]=this.#t.getByTile(this.to()).sort((o,a)=>a.defence().value()-o.defence().value()),r=Math.min(1,this.unit().moves().value());if(this.unit().attack().value()*r*this.#e()>=e.defence().value()*this.#e()){this.ruleRegistry().process(Ko,e,this.unit(),this),this.unit().moves().subtract(r,this.constructor.name);return}this.ruleRegistry().process(Ko,this.unit(),e,this)}};t(as,"Attack")});var fy,$x,Jx=n(()=>{dr();fy=class extends Te{};t(fy,"BuildingIrrigation");$x=fy});var dy,q,Ut=n(()=>{M();dy=class extends x{};t(dy,"Moved");q=dy});var gy,Je,Qi=n(()=>{Vs();P();ui();dr();B();I();Ut();gy=class extends An{#e;constructor(e,r,o,a=d,s=Ue){super(e,r,o,a),this.#e=s}perform(e,r=()=>{},o=Te){let a=this.#e.value()+e;this.unit().setActive(!1),this.unit().moves().set(0),this.unit().setBusy(new o(new l(()=>this.#e.value()===a),new m((...s)=>{let p=this.unit();p.setActive(),p.setBusy(),r(...s),this.ruleRegistry().process(q,this.unit(),this)})))}};t(gy,"DelayedAction");Je=gy});var hy,aa,Ry=n(()=>{M();hy=class extends x{};t(hy,"Built");aa=hy});var xy,qo,$s=n(()=>{Z();P();Ry();xy=class extends S{#e;constructor(e,r=d){super(),this.#e=e,r.process(aa,e,this)}tile(){return this.#e}};t(xy,"TileImprovement");qo=xy});var Be,Zx,Fg=n(()=>{$s();Be=class extends qo{};t(Be,"Irrigation");Zx=Be});var vy,ve,ci=n(()=>{M();vy=class extends x{};t(vy,"MovementCost");ve=vy});var ss,Qx=n(()=>{Jx();Qi();Fg();Ut();ci();ss=class extends Je{perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new Zx(this.unit().tile())},$x),this.ruleRegistry().process(q,this.unit(),this)}};t(ss,"BuildIrrigation")});var by,Xx,ev=n(()=>{dr();by=class extends Te{};t(by,"BuildingMine");Xx=by});var Ze,tv,Ng=n(()=>{$s();Ze=class extends qo{};t(Ze,"Mine");tv=Ze});var ls,rv=n(()=>{ev();Qi();Ng();Ut();ci();ls=class extends Je{perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new tv(this.unit().tile())},Xx),this.ruleRegistry().process(q,this.unit(),this)}};t(ls,"BuildMine")});var Cy,iv,ov=n(()=>{dr();Cy=class extends Te{};t(Cy,"BuildingRoad");iv=Cy});var Ye,nv,zg=n(()=>{$s();Ye=class extends qo{};t(Ye,"Road");nv=Ye});var ms,av=n(()=>{ov();Qi();Ut();ci();zg();ms=class extends Je{perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new nv(this.unit().tile())},iv),this.ruleRegistry().process(q,this.unit(),this)}};t(ms,"BuildRoad")});var Ty,sv,lv=n(()=>{dr();Ty=class extends Te{};t(Ty,"BuildingRailroad");sv=Ty});var or,mv,Lg=n(()=>{$s();or=class extends qo{};t(or,"Railroad");mv=or});var ps,pv=n(()=>{lv();Qi();Ut();ci();Lg();ps=class extends Je{perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new mv(this.unit().tile())},sv),this.ruleRegistry().process(q,this.unit(),this)}};t(ps,"BuildRailroad")});var Iy,Tp,Wg=n(()=>{M();Iy=class extends x{};t(Iy,"ValidateMove");Tp=Iy});var Yt,om,Ip=n(()=>{Vs();Ut();ci();Wg();Yt=class extends An{perform(){return this.validate()?(this.unit().setTile(this.to()),this.ruleRegistry().process(q,this.unit(),this),!0):!1}movementCost(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>r-o);return e}validate(){let[e]=this.ruleRegistry().process(Tp,this.unit(),this.movementCost());return e}};t(Yt,"Move");om=Yt});var nm,uv=n(()=>{P();Ip();nm=class extends om{#e;constructor(e,r,o,a,s=d){super(e,r,o,s),this.#e=a}perform(){return super.perform()?(this.#e.capture(this.unit().player()),!0):!1}};t(nm,"CaptureCity")});var wy,Ne,yi=n(()=>{Z();wy=class extends Fe{#e;constructor(e){super(),this.#e=e}clone(e=this.terrain()){return new this.constructor(e)}terrain(){return this.#e}};t(wy,"TerrainFeature");Ne=wy});var jg,Py,lt,Vo=n(()=>{Ce();yi();jg=new Map,Py=class extends O{constructor(){super(Ne)}getByTerrain(e){return jg.has(e)||jg.set(e,this.getBy("terrain",e)),jg.get(e)}};t(Py,"TerrainFeatureRegistry");lt=new Py});var By,cv,yv=n(()=>{dr();By=class extends Te{};t(By,"ClearingForest");cv=By});var me,Ay,Uy=n(()=>{Zt();me=class extends j{};t(me,"Plains");Ay=me});var us,fv=n(()=>{P();Vo();ui();yv();Qi();Ut();ci();Uy();us=class extends Je{#e;constructor(e,r,o,a=d,s=lt,p=Ue){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new Ay,o=this.#e.getByTerrain(this.from().terrain());this.#e.register(...o.map(a=>a.clone(r))),this.#e.unregister(...o),this.from().setTerrain(r)},cv),this.ruleRegistry().process(q,this.unit(),this)}};t(us,"ClearForest")});var My,dv,gv=n(()=>{dr();My=class extends Te{};t(My,"ClearingJungle");dv=My});var wp,cs,hv,am=n(()=>{Vo();B();I();M();wp=class extends x{};t(wp,"Feature");cs=wp,hv=t((i,e,r=.2,o=lt,a=()=>Math.random())=>[new wp(new l(s=>s===e),new l((s,p)=>p instanceof i),new l(()=>a()<=r),new m((s,p)=>o.register(new s(p))))],"feature")});var be,sm,Pp=n(()=>{Zt();be=class extends j{};t(be,"Grassland");sm=be});var $o,Ey,Gy=n(()=>{yi();$o=class extends Ne{};t($o,"Shield");Ey=$o});var ys,Rv=n(()=>{P();Vo();ui();gv();Qi();am();Pp();Ut();ci();Gy();ys=class extends Je{#e;constructor(e,r,o,a=d,s=lt,p=Ue){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new sm,o=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(cs,Ey,r),this.#e.unregister(...o),this.from().setTerrain(r)},dv),this.ruleRegistry().process(q,this.unit(),this)}};t(ys,"ClearJungle")});var ky,xv,vv=n(()=>{dr();ky=class extends Te{};t(ky,"ClearingSwamp");xv=ky});var fs,bv=n(()=>{P();Vo();ui();vv();Qi();am();Pp();Ut();ci();Gy();fs=class extends Je{#e;constructor(e,r,o,a=d,s=lt,p=Ue){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new sm,o=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(cs,Ey,r),this.#e.unregister(...o),this.from().setTerrain(r)},xv),this.ruleRegistry().process(q,this.unit(),this)}};t(fs,"ClearSwamp")});var ds,Cv=n(()=>{P();Ip();ds=class extends om{#e;constructor(e,r,o,a,s=d){super(e,r,o,s),this.#e=a}perform(){return super.perform()?(this.unit().moves().set(0),this.#e.unload(this.unit()),!0):!1}};t(ds,"Disembark")});var lm,Tv=n(()=>{P();dr();B();Ip();Ut();lm=class extends om{#e;constructor(e,r,o,a,s=d){super(e,r,o,s),this.#e=a}perform(){return super.perform()?(this.#e.stow(this.unit()),this.unit().setBusy(new Te(new l(()=>!1))),this.unit().setActive(!1),this.ruleRegistry().process(q,this.unit(),this),!0):!1}};t(lm,"Embark")});var Dy,mm,Oy=n(()=>{Z();Dy=class extends Fe{#e;constructor(e){super(),this.#e=e}unit(){return this.#e}};t(Dy,"UnitImprovement");mm=Dy});var Yy,nr,sa=n(()=>{Ce();Oy();Yy=class extends O{constructor(){super(mm)}getByUnit(e){return this.getBy("unit",e)}};t(Yy,"UnitImprovementRegistry");nr=new Yy});var Sy,Iv,wv=n(()=>{dr();Sy=class extends Te{};t(Sy,"Fortified");Iv=Sy});var fi,Pv,_g=n(()=>{Oy();fi=class extends mm{};t(fi,"Fortified");Pv=fi});var Fy,Bv,Av=n(()=>{dr();Fy=class extends Te{};t(Fy,"Fortifying");Bv=Fy});var gs,Uv=n(()=>{P();ui();sa();wv();B();Qi();_g();Av();Ut();ci();gs=class extends Je{#e;constructor(e,r,o,a=d,s=Ue,p=nr){super(e,r,o,a,s),this.#e=p}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{this.unit().moves().set(0),this.unit().setActive(!1),this.unit().setBusy(new Iv(new l(()=>!1))),this.#e.register(new Pv(this.unit()))},Bv),this.ruleRegistry().process(q,this.unit(),this)}};t(gs,"Fortify")});var pm,Mv=n(()=>{gt();P();Vs();qn();Ut();pm=class extends im{#e;constructor(e,r,o,a=J,s=d){super(e,r,o,s),this.#e=a}perform(){new et(this.unit().player(),this.unit().tile(),this.#e.takeCapitalByCivilization(this.unit().player().civilization().constructor),this.ruleRegistry()),this.unit().destroy(),this.ruleRegistry().process(q,this.unit(),this)}};t(pm,"FoundCity")});var Xi,Ev=n(()=>{Vs();Xi=class extends An{perform(){this.unit().moves().subtract(this.unit().moves())}};t(Xi,"NoOrders")});var Ny,ze,di=n(()=>{Ce();$s();Ny=class extends O{constructor(){super(qo)}getByTile(e){return this.getBy("tile",e)}};t(Ny,"TileImprovementRegistry");ze=new Ny});var hs,Gv=n(()=>{P();di();ui();Qi();Ut();ci();hs=class extends Je{#e;constructor(e,r,o,a=d,s=ze,p=Ue){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let[r]=this.#e.getByTile(this.from());this.#e.unregister(r)}),this.ruleRegistry().process(q,this.unit(),this)}};t(hs,"Pillage")});var Ve,kv,Hg=n(()=>{Zt();Ve=class extends j{};t(Ve,"Forest");kv=Ve});var eo,Dv,Kg=n(()=>{yi();eo=class extends Ne{};t(eo,"Horse");Dv=eo});var zy,Ov,Yv=n(()=>{dr();zy=class extends Te{};t(zy,"PlantingForest");Ov=zy});var Rs,Sv=n(()=>{P();Vo();ui();Qi();am();Hg();Kg();Ut();ci();Yv();Rs=class extends Je{#e;constructor(e,r,o,a=d,s=lt,p=Ue){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new kv,o=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(cs,Dv,r),this.#e.unregister(...o),this.from().setTerrain(r)},Ov),this.ruleRegistry().process(q,this.unit(),this)}};t(Rs,"PlantForest")});var Ly,Fv,Nv=n(()=>{dr();Ly=class extends Te{};t(Ly,"Sleeping");Fv=Ly});var la,zv,qg=n(()=>{P();ui();Ke();B();Qi();I();Nv();la=class extends Je{#e;constructor(e,r,o,a=d,s=Ue,p=N){super(e,r,o,a,s),this.#e=p}perform(){this.unit().setActive(!1),this.unit().moves().set(0),this.unit().setBusy(new Fv(new l(()=>this.from().getSurroundingArea(this.unit().visibility().value()).some(e=>this.#e.getByTile(e).some(r=>r.player()!==this.unit().player()))),new m(()=>{this.unit().setActive(),this.unit().setBusy()})))}};t(la,"Sleep");zv=la});var um,Lv=n(()=>{Vs();um=class extends im{perform(){this.unit().setWaiting(),this.unit().cargo().forEach(e=>{e.moves().set(e.movement()),e.activate()})}};t(um,"Unload")});var cm=n(()=>{Vx();Qx();rv();av();pv();uv();fv();Rv();bv();Cv();Tv();Uv();Mv();Ip();Ev();Gv();Sv();qg();Lv()});var St,Wv=n(()=>{Zt();St=class extends j{};t(St,"Arctic")});var Ie,jv=n(()=>{Zt();Ie=class extends j{};t(Ie,"Desert")});var Me,_v=n(()=>{Zt();Me=class extends j{};t(Me,"Hills")});var rt,Hv=n(()=>{Zt();rt=class extends j{};t(rt,"Jungle")});var Le,Kv=n(()=>{Zt();Le=class extends j{};t(Le,"Mountains")});var mt,qv=n(()=>{rg();mt=class extends Jt{};t(mt,"Ocean")});var oe,Vv,Vg=n(()=>{Zt();oe=class extends j{};t(oe,"River");Vv=oe});var it,$v=n(()=>{Zt();it=class extends j{};t(it,"Swamp")});var Rt,Jv=n(()=>{Zt();Rt=class extends j{};t(Rt,"Tundra")});var Jo=n(()=>{Wv();jv();Hg();Pp();_v();Hv();Kv();qv();Uy();Vg();$v();Jv()});var Ft,xs,ym=n(()=>{ea();Ft=class extends we{};t(Ft,"Air");xs=Ft});var ot,Wy,jy=n(()=>{ea();ot=class extends we{};t(ot,"Land");Wy=ot});var F,Nt=n(()=>{jy();F=class extends Wy{};t(F,"Fortifiable")});var We,Un,Js=n(()=>{ea();We=class extends we{};t(We,"Naval");Un=We});var _y,Hy,$g=n(()=>{_y=class{#e;#t;constructor(e,r){this.#e=e,this.#t=r}transport(){return this.#e}unit(){return this.#t}};t(_y,"TransportManifest");Hy=_y});var Ky,Mn,fm=n(()=>{Ce();$g();Ky=class extends O{constructor(){super(Hy)}getByTransport(e){return this.getBy("transport",e)}getByUnit(e){let r=this.getBy("unit",e);if(r.length!==1)throw new TypeError("Wrong number of results.");return r[0]}};t(Ky,"TransportRegistry");Mn=new Ky});var qy,Vy,Jg=n(()=>{M();qy=class extends x{};t(qy,"Stowed");Vy=qy});var $y,Zv,Qv=n(()=>{M();$y=class extends x{};t($y,"Unloaded");Zv=$y});var RY,Xv,eb=n(()=>{P();fm();Jg();$g();Qv();RY=t(i=>t(class extends i{#e=d;#t=Mn;canStow(r){return!this.cargo().includes(r)&&this.hasCapacity()}capacity(){return 0}cargo(){return this.#t.getByTransport(this).map(r=>r.unit())}hasCapacity(){return this.#t.getByTransport(this).length<this.capacity()}hasCargo(){return this.#t.getByTransport(this).length>0}setRuleRegistry(r){this.#e=r}setTransportRegistry(r){this.#t=r}stow(r){return!this.hasCapacity()||!this.canStow(r)?!1:(this.#t.register(new Hy(this,r)),this.#e.process(Vy,r,this),!0)}unload(r){try{let o=this.#t.getByUnit(r);return this.#t.unregister(o),this.#e.process(Zv,r,this),!0}catch{return!1}}},"Transport"),"Transport"),Xv=RY});var zt,En,Zs=n(()=>{P();fm();Js();eb();zt=class extends Xv(Un){constructor(e,r,o,a=d,s=Mn){super(e,r,o,a),this.setRuleRegistry(a),this.setTransportRegistry(s)}};t(zt,"NavalTransport");En=zt});var gr,Zg=n(()=>{jy();gr=class extends Wy{};t(gr,"Worker")});var Gn=n(()=>{ym();Nt();jy();Js();Zs();Zg()});var Zo,tb=n(()=>{yi();Zo=class extends Ne{};t(Zo,"Coal")});var Qo,rb=n(()=>{yi();Qo=class extends Ne{};t(Qo,"Fish")});var gi,ib=n(()=>{yi();gi=class extends Ne{};t(gi,"Game")});var Xo,ob=n(()=>{yi();Xo=class extends Ne{};t(Xo,"Gems")});var en,nb=n(()=>{yi();en=class extends Ne{};t(en,"Gold")});var hi,ab=n(()=>{yi();hi=class extends Ne{};t(hi,"Oasis")});var tn,sb=n(()=>{yi();tn=class extends Ne{};t(tn,"Oil")});var rn,lb=n(()=>{yi();rn=class extends Ne{};t(rn,"Seal")});var Bp=n(()=>{tb();rb();ib();ob();nb();Kg();ab();sb();lb();Gy()});var Jy,Qs,Qg=n(()=>{M();Jy=class extends x{};t(Jy,"Action");Qs=Jy});var Zy,Qy,Xg=n(()=>{M();Zy=class extends x{};t(Zy,"ActionPerformed");Qy=Zy});var Xy,dm,eh=n(()=>{M();Xy=class extends x{};t(Xy,"Discovered");dm=Xy});var ef,tf,th=n(()=>{Z();P();Qg();Xg();eh();ef=class extends S{#e;#t;constructor(e,r=d){super(),this.#e=r,this.#t=e,this.addKey("tile")}action(e){e.perform(),this.#e.process(Qy,this,e)}actions(e){return this.#e.process(Qs,this,e)}process(e){this.#e.process(dm,this,e)}tile(){return this.#t}};t(ef,"GoodyHut");tf=ef});var rf,Yr,vs=n(()=>{th();Ce();rf=class extends O{constructor(){super(tf)}getByTile(e){let r=this.filter(o=>o.tile()===e);return r.length===0?null:r[0]}};t(rf,"GoodyHutRegistry");Yr=new rf});var mb=n(()=>{$s()});var kn=n(()=>{Fg();Ng();mb();zg();Lg()});var of,pb,ub=n(()=>{of=class{#e;#t;#r;constructor(e,r,o){this.#e=o,this.#t=r,this.#r=e}end(){return this.#e}generate(){throw new Error(`PathFinder#generate: Must be overridden in '${this.constructor.name}'.`)}start(){return this.#t}unit(){return this.#r}};t(of,"PathFinder");pb=of});var nf,af,rh=n(()=>{Hi();ub();nf=class extends De{constructor(){super(pb)}};t(nf,"PathFinderRegistry");af=new nf});var sf,Sr,bs=n(()=>{Z();sf=class extends Fe{};t(sf,"Government");Sr=sf});var lf,gm,mf=n(()=>{Hi();bs();lf=class extends De{constructor(){super(Sr)}};t(lf,"AvailableGovernmentRegistry");gm=new lf});var pf,Ap,ih=n(()=>{M();pf=class extends x{};t(pf,"Availability");Ap=pf});var uf,Up,oh=n(()=>{M();uf=class extends x{};t(uf,"Changed");Up=uf});var cf,yf,nh=n(()=>{mf();Z();P();ih();oh();cf=class extends S{#e;#t=null;#r;#i;constructor(e,r=gm,o=d){super(),this.#r=e,this.#e=r,this.#i=o,this.addKey("available","current")}available(){return this.#e.filter(e=>this.#i.get(Ap).some(r=>r.validate(e,this.#r)))}current(){return this.#t}is(...e){return e.some(r=>this.#t instanceof r)}player(){return this.#r}set(e){this.#t=e,this.#i.process(Up,this.#r,e)}};t(cf,"PlayerGovernment");yf=cf});var ff,pt,on=n(()=>{Ce();nh();ff=class extends O{constructor(){super(yf)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerGovernments for player.");return r[0]}};t(ff,"PlayerGovernmentRegistry");pt=new ff});var df,gf,ah=n(()=>{oc();Wl();df=class extends qa{#e;#t;constructor(e,r=In,o=()=>Math.random()){super(e),this.#e=r,this.#t=o}chooseCivilization(e){let r=e[Math.floor(e.length*this.#t())],o=this.player(),a=new r;o.setCivilization(a),this.chooseLeader(a)}chooseLeader(e){let r=this.#e.getByCivilization(e.constructor),o=r[Math.floor(this.#t()*r.length)];e.setLeader(new o)}};t(df,"AIClient");gf=df});var cb=n(()=>{_g()});var ma,yb=n(()=>{Oy();ma=class extends mm{};t(ma,"Veteran")});var fb=n(()=>{yb()});var Mp=n(()=>{cb();fb()});var Ri,db,sh=n(()=>{E();Ri=class extends v{};t(Ri,"AdvancedFlight");db=Ri});var to,gb,lh=n(()=>{E();to=class extends v{};t(to,"Alphabet");gb=to});var xi,hb,mh=n(()=>{E();xi=class extends v{};t(xi,"Astronomy");hb=xi});var Dn,Rb,ph=n(()=>{E();Dn=class extends v{};t(Dn,"AtomicTheory");Rb=Dn});var ut,xb,uh=n(()=>{E();ut=class extends v{};t(ut,"Automobile");xb=ut});var vi,vb,ch=n(()=>{E();vi=class extends v{};t(vi,"Banking");vb=vi});var ro,bb,yh=n(()=>{E();ro=class extends v{};t(ro,"BridgeBuilding");bb=ro});var Fr,Cb,fh=n(()=>{E();Fr=class extends v{};t(Fr,"BronzeWorking");Cb=Fr});var bi,Tb,dh=n(()=>{E();bi=class extends v{};t(bi,"CeremonialBurial");Tb=bi});var nn,Ib,gh=n(()=>{E();nn=class extends v{};t(nn,"Chemistry");Ib=nn});var io,wb,hh=n(()=>{E();io=class extends v{};t(io,"Chivalry");wb=io});var hr,Pb,Rh=n(()=>{E();hr=class extends v{};t(hr,"CodeOfLaws");Pb=hr});var Nr,Bb,xh=n(()=>{E();Nr=class extends v{};t(Nr,"Combustion");Bb=Nr});var xt,Ab,vh=n(()=>{E();xt=class extends v{};t(xt,"Communism");Ab=xt});var Ci,Ub,bh=n(()=>{E();Ci=class extends v{};t(Ci,"Computers");Ub=Ci});var zr,Mb,Ch=n(()=>{E();zr=class extends v{};t(zr,"Conscription");Mb=zr});var Lr,Eb,Th=n(()=>{E();Lr=class extends v{};t(Lr,"Construction");Eb=Lr});var oo,Gb,Ih=n(()=>{E();oo=class extends v{};t(oo,"Corporation");Gb=oo});var Ti,kb,wh=n(()=>{E();Ti=class extends v{};t(Ti,"Currency");kb=Ti});var no,Db,Ph=n(()=>{E();no=class extends v{};t(no,"Democracy");Db=no});var Rr,Ob,Bh=n(()=>{E();Rr=class extends v{};t(Rr,"Electricity");Ob=Rr});var ct,Yb,Ah=n(()=>{E();ct=class extends v{};t(ct,"Electronics");Yb=ct});var an,Sb,Uh=n(()=>{E();an=class extends v{};t(an,"Engineering");Sb=an});var sn,Fb,Mh=n(()=>{E();sn=class extends v{};t(sn,"Explosives");Fb=sn});var On,Nb,Eh=n(()=>{E();On=class extends v{};t(On,"Feudalism");Nb=On});var ao,zb,Gh=n(()=>{E();ao=class extends v{};t(ao,"Flight");zb=ao});var pa,Lb,kh=n(()=>{E();pa=class extends v{};t(pa,"FusionPower");Lb=pa});var ln,Wb,Dh=n(()=>{E();ln=class extends v{};t(ln,"GeneticEngineering");Wb=ln});var yt,jb,Oh=n(()=>{E();yt=class extends v{};t(yt,"Gunpowder");jb=yt});var mn,_b,Yh=n(()=>{E();mn=class extends v{};t(mn,"HorsebackRiding");_b=mn});var vt,Hb,Sh=n(()=>{E();vt=class extends v{};t(vt,"Industrialization");Hb=vt});var xr,Kb,Fh=n(()=>{E();xr=class extends v{};t(xr,"Invention");Kb=xr});var Ii,qb,Nh=n(()=>{E();Ii=class extends v{};t(Ii,"IronWorking");qb=Ii});var pn,Vb,zh=n(()=>{E();pn=class extends v{};t(pn,"LaborUnion");Vb=pn});var vr,$b,Lh=n(()=>{E();vr=class extends v{};t(vr,"Literacy");$b=vr});var Lt,Jb,Wh=n(()=>{E();Lt=class extends v{};t(Lt,"Magnetism");Jb=Lt});var Wr,Zb,jh=n(()=>{E();Wr=class extends v{};t(Wr,"MapMaking");Zb=Wr});var Wt,Qb,_h=n(()=>{E();Wt=class extends v{};t(Wt,"Masonry");Qb=Wt});var jt,Xb,Hh=n(()=>{E();jt=class extends v{};t(jt,"MassProduction");Xb=jt});var br,eC,Kh=n(()=>{E();br=class extends v{};t(br,"Mathematics");eC=br});var wi,tC,qh=n(()=>{E();wi=class extends v{};t(wi,"Medicine");tC=wi});var jr,rC,Vh=n(()=>{E();jr=class extends v{};t(jr,"Metallurgy");rC=jr});var _r,iC,$h=n(()=>{E();_r=class extends v{};t(_r,"Monarchy");iC=_r});var _t,oC,Jh=n(()=>{E();_t=class extends v{};t(_t,"Mysticism");oC=_t});var ar,nC,Zh=n(()=>{E();ar=class extends v{};t(ar,"Navigation");nC=ar});var Hr,aC,Qh=n(()=>{E();Hr=class extends v{};t(Hr,"NuclearFission");aC=Hr});var so,sC,Xh=n(()=>{E();so=class extends v{};t(so,"NuclearPower");sC=so});var Kr,lC,eR=n(()=>{E();Kr=class extends v{};t(Kr,"Philosophy");lC=Kr});var Pi,mC,tR=n(()=>{E();Pi=class extends v{};t(Pi,"Physics");mC=Pi});var un,pC,rR=n(()=>{E();un=class extends v{};t(un,"Plastics");pC=un});var cn,uC,iR=n(()=>{E();cn=class extends v{};t(cn,"Pottery");uC=cn});var qr,cC,oR=n(()=>{E();qr=class extends v{};t(qr,"Railroad");cC=qr});var yn,yC,nR=n(()=>{E();yn=class extends v{};t(yn,"Recycling");yC=yn});var Bi,fC,aR=n(()=>{E();Bi=class extends v{};t(Bi,"Refining");fC=Bi});var bt,dC,sR=n(()=>{E();bt=class extends v{};t(bt,"Religion");dC=bt});var Vr,gC,lR=n(()=>{E();Vr=class extends v{};t(Vr,"Robotics");gC=Vr});var lo,hC,mR=n(()=>{E();lo=class extends v{};t(lo,"Rocketry");hC=lo});var mo,RC,pR=n(()=>{E();mo=class extends v{};t(mo,"SpaceFlight");RC=mo});var po,xC,uR=n(()=>{E();po=class extends v{};t(po,"SteamEngine");xC=po});var uo,vC,cR=n(()=>{E();uo=class extends v{};t(uo,"Steel");vC=uo});var co,bC,yR=n(()=>{E();co=class extends v{};t(co,"Superconductor");bC=co});var Ai,CC,fR=n(()=>{E();Ai=class extends v{};t(Ai,"TheRepublic");CC=Ai});var fn,TC,dR=n(()=>{E();fn=class extends v{};t(fn,"TheWheel");TC=fn});var yo,IC,gR=n(()=>{E();yo=class extends v{};t(yo,"TheoryOfGravity");IC=yo});var Ui,wC,hR=n(()=>{E();Ui=class extends v{};t(Ui,"Trade");wC=Ui});var sr,PC,RR=n(()=>{E();sr=class extends v{};t(sr,"University");PC=sr});var Cr,BC,xR=n(()=>{E();Cr=class extends v{};t(Cr,"Writing");BC=Cr});var lr=n(()=>{sh();lh();mh();ph();uh();ch();yh();fh();dh();gh();hh();Rh();xh();vh();bh();Ch();Th();Ih();wh();Ph();Bh();Ah();Uh();Mh();Eh();Gh();kh();Dh();Oh();Yh();Sh();Fh();Nh();zh();Lh();Wh();jh();_h();Hh();Kh();qh();Vh();$h();Jh();Zh();Qh();Xh();eR();tR();rR();iR();oR();nR();aR();sR();lR();mR();pR();uR();cR();yR();fR();dR();gR();hR();RR();xR()});var Mi,AC=n(()=>{bs();Mi=class extends Sr{};t(Mi,"Anarchy")});var Ct,UC=n(()=>{bs();Ct=class extends Sr{};t(Ct,"Communism")});var nt,MC=n(()=>{bs();nt=class extends Sr{};t(nt,"Democracy")});var Ht,EC=n(()=>{bs();Ht=class extends Sr{};t(Ht,"Despotism")});var at,GC=n(()=>{bs();at=class extends Sr{};t(at,"Monarchy")});var ft,kC=n(()=>{bs();ft=class extends Sr{};t(ft,"Republic")});var dn=n(()=>{AC();UC();MC();EC();GC();kC()});var $r,DC=n(()=>{Ae();$r=class extends Y{};t($r,"Aqueduct")});var mr,OC=n(()=>{Ae();mr=class extends Y{};t(mr,"Bank")});var Jr,YC=n(()=>{Ae();Jr=class extends Y{};t(Jr,"Barracks")});var pr,SC=n(()=>{Ae();pr=class extends Y{};t(pr,"Cathedral")});var fo,FC=n(()=>{Ae();fo=class extends Y{};t(fo,"CityWalls")});var Zr,NC=n(()=>{Ae();Zr=class extends Y{};t(Zr,"Colosseum")});var Tr,zC=n(()=>{Ae();Tr=class extends Y{};t(Tr,"Courthouse")});var Kt,LC=n(()=>{Ae();Kt=class extends Y{};t(Kt,"Factory")});var Qr,WC=n(()=>{Ae();Qr=class extends Y{};t(Qr,"Granary")});var Tt,jC=n(()=>{Ae();Tt=class extends Y{};t(Tt,"HydroPlant")});var Ir,_C=n(()=>{Ae();Ir=class extends Y{};t(Ir,"Library")});var wr,HC=n(()=>{Ae();wr=class extends Y{};t(wr,"ManufacturingPlant")});var ur,KC=n(()=>{Ae();ur=class extends Y{};t(ur,"Marketplace")});var go,qC=n(()=>{Ae();go=class extends Y{};t(go,"MassTransit")});var It,VC=n(()=>{Ae();It=class extends Y{};t(It,"NuclearPlant")});var dt,$C,vR=n(()=>{Ae();dt=class extends Y{};t(dt,"Palace");$C=dt});var wt,JC=n(()=>{Ae();wt=class extends Y{};t(wt,"PowerPlant")});var ho,ZC=n(()=>{Ae();ho=class extends Y{};t(ho,"RecyclingCenter")});var Ro,QC=n(()=>{Ae();Ro=class extends Y{};t(Ro,"SdiDefence")});var Mt,XC=n(()=>{Ae();Mt=class extends Y{};t(Mt,"Temple")});var Pr,eT=n(()=>{Ae();Pr=class extends Y{};t(Pr,"University")});var Ei=n(()=>{DC();OC();YC();SC();FC();NC();zC();LC();WC();jC();_C();HC();KC();qC();VC();vR();JC();ZC();QC();XC();eT()});var hf,Cs,tT=n(()=>{rh();Ou();hf=class extends Ol{#e=1/0;end(){return this.entries()[this.length-1]}static for(e,r,o,a=af){let[s]=a.entries().map(p=>new p(e,r,o)).map(p=>p.generate()).sort((p,u)=>p.movementCost()-u.movementCost());return s&&(s.shift(),s)}movementCost(){return this.#e}setMovementCost(e){this.#e=e}push(...e){e.forEach(r=>{let o=this.end();if(this.length>0&&!r.isNeighbourOf(o))throw new TypeError(`Tile#push: Invalid element passed, ${r.x()},${r.y()} is not a neighbour of ${o.x()},${o.y()}.`);super.push(r)})}start(){return this.entries()[0]}};t(hf,"Path");Cs=hf});var xo,rT=n(()=>{Nt();xo=class extends F{};t(xo,"Artillery")});var vo,iT=n(()=>{Js();vo=class extends Un{};t(vo,"Battleship")});var bo,oT=n(()=>{ym();bo=class extends xs{};t(bo,"Bomber")});var Gi,nT=n(()=>{Nt();Gi=class extends F{};t(Gi,"Cannon")});var Co,aT=n(()=>{Nt();Co=class extends F{};t(Co,"Caravan")});var To,sT=n(()=>{ym();Zs();To=class extends En{canStow(e){return e instanceof xs&&super.canStow(e)}capacity(){return 8}};t(To,"Carrier")});var ki,lT=n(()=>{Nt();ki=class extends F{};t(ki,"Catapult")});var Di,mT=n(()=>{Nt();Di=class extends F{};t(Di,"Chariot")});var Io,pT=n(()=>{Js();Io=class extends Un{};t(Io,"Cruiser")});var wo,uT=n(()=>{Nt();wo=class extends F{};t(wo,"Diplomat")});var Xr,cT=n(()=>{ym();Xr=class extends xs{};t(Xr,"Fighter")});var Oi,yT=n(()=>{Zs();Oi=class extends En{capacity(){return 4}};t(Oi,"Frigate")});var Br,fT=n(()=>{Nt();Br=class extends F{};t(Br,"Horseman")});var Yi,dT=n(()=>{Js();Yi=class extends Un{};t(Yi,"Ironclad")});var Si,gT=n(()=>{Nt();Si=class extends F{};t(Si,"Knight")});var Po,hT=n(()=>{Nt();Po=class extends F{};t(Po,"MechanizedInfantry")});var Fi,RT=n(()=>{Nt();Fi=class extends F{};t(Fi,"Musketman")});var Bo,xT=n(()=>{ym();Bo=class extends xs{};t(Bo,"Nuclear")});var Ao,vT=n(()=>{Nt();Ao=class extends F{};t(Ao,"Rifleman")});var Ni,bT=n(()=>{Zs();Ni=class extends En{capacity(){return 3}};t(Ni,"Sail")});var je,CT,bR=n(()=>{Zg();je=class extends gr{};t(je,"Settlers");CT=je});var zi,TT=n(()=>{Nt();zi=class extends F{};t(zi,"Spearman")});var Uo,IT=n(()=>{Js();Uo=class extends Un{};t(Uo,"Submarine")});var Ar,wT=n(()=>{Nt();Ar=class extends F{};t(Ar,"Swordman")});var Mo,PT=n(()=>{Nt();Mo=class extends F{};t(Mo,"Tank")});var Eo,BT=n(()=>{Zs();Eo=class extends En{capacity(){return 8}};t(Eo,"Transport")});var Ur,AT=n(()=>{Zs();Ur=class extends En{capacity(){return 2}};t(Ur,"Trireme")});var Go,UT=n(()=>{Nt();Go=class extends F{};t(Go,"Warrior")});var gn=n(()=>{rT();iT();oT();nT();aT();sT();lT();mT();pT();uT();cT();yT();fT();dT();gT();hT();RT();xT();vT();bT();bR();TT();IT();wT();PT();BT();AT();UT()});var Rf,xf,Yn,hm=n(()=>{$l();cm();$n();ir();tt();Jo();is();Gn();Bp();vs();kn();Wl();rh();on();He();Ns();Ji();P();Vo();di();sa();Ke();ah();Ql();$u();Ac();Mp();lr();dn();Ei();tT();bu();gn();Ki();ea();Pe();tm();Rf=t((i,e,r=_)=>{let o=r.getByTile(i);return o===null?!1:o.player()===e},"hasPlayerCity"),xf=class extends gf{#e=e=>{let r=this.#B.getByTerrain(e.terrain());return(e.terrain()instanceof be||e.terrain()instanceof oe||e.terrain()instanceof me||r.some(o=>o instanceof hi)||r.some(o=>o instanceof gi))&&e.getSurroundingArea().score(this.player(),[[$,4],[K,2],[se,1]])>=180&&!e.getSurroundingArea(4).filter(o=>this.#u.getByTile(o)!==null).length};#t=e=>[Ie,me,be,oe].some(r=>e.terrain()instanceof r)&&!this.#R.getByTile(e).some(r=>r instanceof Be)&&e.getSurroundingArea().some(r=>Rf(r,this.player(),this.#u))&&[...e.getAdjacent(),e].some(r=>r.terrain()instanceof oe||r.isCoast()||this.#R.getByTile(r).some(o=>o instanceof Be)&&this.#u.getByTile(r)===null);#r=e=>[Me,Le].some(r=>e.terrain()instanceof r)&&!this.#R.getByTile(e).some(r=>r instanceof Ze)&&e.getSurroundingArea().some(r=>Rf(r,this.player(),this.#u));#i=e=>!this.#R.getByTile(e).some(r=>r instanceof Ye)&&e.getSurroundingArea().some(r=>Rf(r,this.player(),this.#u));#o=new Map;#a=new Map;#n=new Map;#l=[];#s=[];#m=[];#g=[];#y=[];#f=[];#p=[];#u;#b;#x;#C;#d;#T;#I;#w;#h;#P;#B;#R;#v;#c;constructor(e,r=_,o=Xt,a=ce,s=Yr,p=In,u=af,y=pt,c=z,f=si,g=ie,G=d,k=lt,D=ze,U=nr,L=N){super(e,p),this.#u=r,this.#b=o,this.#x=a,this.#C=s,this.#d=u,this.#T=y,this.#I=c,this.#w=f,this.#h=g,this.#P=G,this.#B=k,this.#v=U,this.#R=D,this.#c=L}scoreUnitMove(e,r){let o=e.actions(r),{attack:a,buildIrrigation:s,buildMine:p,buildRoad:u,captureCity:y,disembark:c,embark:f,fortify:g,foundCity:G,noOrders:k}=o.reduce((ne,_e)=>({...ne,[_e.constructor.name.replace(/^./,oi=>oi.toLowerCase())]:_e}),{});if(!o.length||o.length===1&&k||e instanceof F&&o.length===2&&g&&k)return-1;let D=0;this.#C.getByTile(r)!==null&&(D+=60),(G&&this.#e(r)||p&&this.#r(r)||s&&this.#t(r)||u&&this.#i(r))&&(D+=24);let L=this.#c.getByTile(r).sort((ne,_e)=>_e.defence().value()-ne.defence().value()),[Re]=L,Se=L.some(ne=>ne.player()===this.player());e instanceof zt&&e.hasCapacity()&&L.length&&Se&&(D+=10),e instanceof zt&&e.hasCargo()&&r.isCoast()&&r.isWater()&&(D+=16),f&&(D+=16),c&&(D+=16),y&&(D+=100),a&&e.attack()>Re.defence()&&(D+=24*(e.attack().value()-Re.defence().value())),a&&e.attack().value()>=Re.defence().value()&&(D+=16),a&&e.attack().value()>=Re.defence().value()*(2/3)&&(D+=8);let Bt=this.#h.getByPlayer(this.player()),Ga=r.getNeighbours().filter(ne=>!Bt.includes(ne)).length;Ga>0&&(D+=Ga*3);let wl=this.#n.get(e);return wl instanceof ue&&r.distanceFrom(wl)<e.tile().distanceFrom(wl)&&(D+=14),(this.#o.get(e)||[]).includes(r)||(D*=4),D}moveUnit(e){let r=0;for(;e.active()&&e.moves().value()>=.1;){if(r++>1e3){console.log("SimpleAIClient#moveUnit: loopCheck: aborting"),console.log(`${e.player().civilization().name()} ${e.constructor.name}`),console.log(e.actions()),console.log(e.actionsForNeighbours()),e.action(new Xi(e.tile(),e.tile(),e));return}let o=this.#a.get(e);if(o){let c=o.shift(),[f]=e.actions(c).filter(g=>g instanceof Yt);if(f){e.action(f),o.length===0&&this.#a.delete(e);return}if(o.length>0){let g=Cs.for(e,e.tile(),o.end());if(g){this.#a.set(e,g);continue}}this.#a.delete(e)}let[a]=e.tile().getNeighbours().map(c=>[c,this.scoreUnitMove(e,c)]).filter(([,c])=>c>-1).sort(([,c],[,f])=>f-c||Math.floor(Math.random()*3)-1).map(([c])=>c);if(!a){e.action(new Xi(e.tile(),e.tile(),e));return}let s=e.actions(a),[p]=s,u=this.#o.get(e)||[],y=this.#n.get(e);if(!p){e.action(new Xi(e.tile(),e.tile(),e));return}y===a&&this.#n.delete(e),u.push(a),this.#o.set(e,u.slice(-50)),e.action(p)}e.moves().value()>0&&e.action(new Xi(e.tile(),e.tile(),e))}preProcessTurn(){this.#l.splice(0),this.#s.splice(0),this.#m.splice(0),this.#g.splice(0),this.#y.splice(0),this.#f.splice(0),this.#p.splice(0);let e=this.#h.getByPlayer(this.player());e.entries().forEach(r=>{let o=r.tile(),a=this.#u.getByTile(o),s=this.#c.getBy("tile",o),p=this.#p.includes(o)&&![...this.#n.values(),...[...this.#a.values()].map(u=>u.end())].includes(o);a&&a.player()===this.player()&&!s.length&&!this.#p.includes(o)&&!p?this.#p.push(o):a&&a.player()!==this.player()&&a.originalPlayer()===this.player()?this.#l.push(o):a&&a.player()!==this.player()&&!this.#s.includes(o)?this.#s.push(o):s.length&&s.some(u=>u.player()!==this.player())&&this.#m.includes(o)?this.#m.push(o):o.isLand()&&o.getNeighbours().some(u=>!e.includes(u))&&!this.#y.includes(o)&&!p?this.#y.push(o):o.isWater()&&o.getNeighbours().some(u=>!e.includes(u))&&this.#f.includes(o)&&!p&&this.#f.push(o),this.#e(o)&&this.#g.includes(o)&&!p&&this.#g.push(o)}),this.#u.getByPlayer(this.player()).forEach(r=>{let o=this.#c.getByTile(r.tile());os(r,this.#h,this.#x),!o.length&&!this.#p.includes(r.tile())&&this.#p.push(r.tile())})}takeTurn(){return new Promise((e,r)=>{try{let o=0;this.preProcessTurn();let[a]=this.#T.filter(p=>p.player()===this.player()),[s]=this.#I.filter(p=>p.player()===this.player());for(s.completed(_r)&&!a.is(at)&&a.set(new at);this.player().hasMandatoryActions();){let p=this.player().mandatoryAction(),u=p.value();if(o++>1e3){console.log(""),console.log(""),console.log(u),u instanceof we&&(console.log(u.actions()),u.tile().getNeighbours().forEach(y=>console.log(u.actions(y))),console.log(u.active()),console.log(u.busy()),console.log(u.moves().value()),console.log(this.#v.getByUnit(u))),u.action(new Xi(u.tile(),u.tile(),u)),console.error("SimpleAIClient: Couldn't pick an action to do.");break}if(u instanceof we){let y=u,c=y.tile(),f=this.#n.get(y),g=y.actions(),{buildIrrigation:G,buildMine:k,buildRoad:D,fortify:U,foundCity:L,unload:Re}=g.reduce((Ge,ne)=>({...Ge,[ne.constructor.name.replace(/^./,_e=>_e.toLowerCase())]:ne}),{}),Se=this.#c.getByTile(c);if(this.#o.get(y)||this.#o.set(y,[y.tile()]),y instanceof zt&&Re&&c.isCoast()&&y.cargo().some(Ge=>!c.getNeighbours().some(ne=>(this.#o.get(Ge)||[]).includes(ne)))){y.action(Re),y.setWaiting();continue}if(y instanceof gr){L&&this.#e(c)?y.action(L):G&&this.#t(c)?y.action(G):k&&this.#r(c)?y.action(k):D&&this.#i(c)?y.action(D):!f&&this.#g.length&&this.#n.set(y,this.#g.shift()),this.moveUnit(y);continue}let[Ga]=Se.filter(Ge=>this.#v.getByUnit(Ge).some(ne=>ne instanceof fi)&&y.defence()>Ge.defence()),wl=this.#u.getByTile(c);if(U&&wl&&(Ga||Se.length<=Math.ceil(this.#x.getByCity(wl).size()/5))){y.action(U),Ga&&Ga.activate();continue}if(!f){if(y instanceof F&&y.defence().value()>0&&this.#p.length>0){let[Ge]=this.#p.sort((_e,oi)=>_e.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),ne=Cs.for(y,y.tile(),Ge,this.#d);ne&&(this.#p.splice(this.#p.indexOf(Ge),1),this.#a.set(y,ne))}else if(y.attack().value()>0&&this.#l.length>0){let[Ge]=this.#l.filter(_e=>y instanceof ot&&_e.isLand()).sort((_e,oi)=>_e.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),ne=Cs.for(y,y.tile(),Ge,this.#d);ne&&(this.#l.splice(this.#l.indexOf(Ge),1),this.#a.set(y,ne))}else if(y.attack().value()>0&&this.#m.length>0){let[Ge]=this.#m.filter(_e=>y instanceof ot&&_e.isLand()||y instanceof We&&_e.isWater()).sort((_e,oi)=>_e.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),ne=Cs.for(y,y.tile(),Ge,this.#d);ne&&(this.#m.splice(this.#m.indexOf(Ge),1),this.#a.set(y,ne))}else if(y instanceof ot&&y.attack().value()>0&&this.#s.length>0){let[Ge]=this.#s.sort((_e,oi)=>_e.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),ne=Cs.for(y,y.tile(),Ge,this.#d);ne&&(this.#s.splice(this.#s.indexOf(Ge),1),this.#a.set(y,ne))}else if(y instanceof ot&&this.#y.length>0){let[Ge]=this.#y.sort((_e,oi)=>_e.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),ne=Cs.for(y,y.tile(),Ge,this.#d);ne&&(this.#y.splice(this.#y.indexOf(Ge),1),this.#a.set(y,ne))}else if(y instanceof We&&this.#f.length>0){let[Ge]=this.#f.sort((_e,oi)=>_e.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),ne=Cs.for(y,y.tile(),Ge,this.#d);ne&&(this.#f.splice(this.#f.indexOf(Ge),1),this.#a.set(y,ne))}}this.moveUnit(y);continue}if(u instanceof zl){this.buildItemInCity(u.city());continue}if(u instanceof Ul){let y=u.available();y.length&&u.research(y[Math.floor(y.length*Math.random())]);continue}if(p instanceof Bc)break;console.log(`Can't process: '${u.constructor.name}'`);break}e()}catch(o){if(typeof o=="string"){r(new Error(o));return}if(o instanceof Error){r(o);return}r(new Error(`An unknown error occurred: ${o}`))}})}buildItemInCity(e){let r=e.tile(),o=this.#b.getByCity(e),a=this.#c.getByTile(r),s=o.available(),p=[dt,je],u=s.filter(U=>!p.includes(U.item())&&!Object.prototype.isPrototypeOf.call(xe,U.item())),y=s.filter(U=>Object.prototype.isPrototypeOf.call(xe,U.item())),c=u.filter(U=>Object.prototype.isPrototypeOf.call(we,U.item())),f=u[Math.floor(u.length*Math.random())].item(),g=t(U=>{let[[L]]=c.map(Re=>{let Se=Re.item(),Bt=new U;return this.#P.process(es,Se,Bt),[Se,Bt]}).sort(([,Re],[,Se])=>Se.value()-Re.value());return L},"getUnitByYield"),G=(U=>()=>U||(U=g(mi)))(),k=(U=>()=>U||(U=g(qi)))();if(this.#c.getByTile(r).length<2&&G()){o.build(G());return}let D=this.#x.getByCity(o.city());if(s.some(U=>U.item()===je)&&!this.#c.getByCity(o.city()).some(U=>U instanceof je)&&this.#c.getByPlayer(this.player()).filter(U=>U instanceof je).length<3&&D.size()>1){o.build(je);return}if(this.#l.length>0||this.#s.length>0||this.#m.length>4){o.build(k());return}if(a.filter(U=>this.#v.getByUnit(U).filter(L=>L instanceof fi)).length<2||this.#p.length){o.build(G());return}if(o.city().yields().filter(U=>U instanceof K).some(U=>U.value()>4)){let U=y.map(L=>L.item());o.build(U[Math.floor(Math.random()*U.length)])}f&&o.build(f)}cityLost(e,r,o){if(!r)return;let a=this.#h.getByPlayer(this.player());if(o){this.#s.push(...a.entries().filter(s=>Rf(s.tile(),this.player(),this.#u)).map(s=>s.tile())),this.#m.push(...a.entries().filter(s=>this.#c.getByTile(s.tile()).some(p=>p.player()===r)).map(s=>s.tile()));return}this.#l.push(e.tile())}unitDestroyed(e,r){let o=this.#u.getByTile(e.tile()),a=this.#c.getByTile(e.tile());o&&o.player()===this.player()&&a.length<2&&(this.buildItemInCity(o),this.#w.getByPlayer(this.player()).buy(o))}};t(xf,"SimpleAIClient");Yn=xf});var vf,ko,Xs=n(()=>{Ce();oc();vf=class extends O{constructor(){super(bx)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of Clients for Player.");return r[0]}};t(vf,"ClientRegistry");ko=new vf});var el,tl,Rm=n(()=>{Ot();el=class extends ae{};t(el,"American");tl=el});var xY={};var MT=n(()=>{Rm();tr();rr();Object.entries({people:"American",nation:"America",colors:["#0055A4","#FFF"]}).forEach(([i,e])=>de.register(new fe(tl,i,e)))});var vY={};var ET=n(()=>{Rm();Dt();gt();["Washington","New York","Los Angeles","Chicago","Houston","Phoenix","Philadelphia","San Antonio","San Diego","Dallas","San Jose","Austin","Jacksonville","Fort Worth","Columbus","San Francisco","Charlotte","Indianapolis","Seattle","Denver","Boston","El Paso","Detroit","Nashville","Portland","Memphis","Oklahoma City","Las Vegas","Louisville","Baltimore","Milwaukee","Albuquerque","Tucson","Fresno","Mesa","Sacramento","Atlanta","Kansas City","Colorado Springs","Miami","Raleigh","Omaha","Long Beach","Virginia Beach","Oakland","Minneapolis","Tulsa","Arlington","Tampa","New Orleans","Wichita","Cleveland","Bakersfield","Aurora","Anaheim","Honolulu","Santa Ana","Riverside","Corpus Christi","Lexington","Stockton","Henderson","Saint Paul","St. Louis","Cincinnati","Pittsburgh","Greensboro","Anchorage","Plano","Lincoln","Orlando","Irvine","Newark","Toledo","Durham","Chula Vista","Fort Wayne","Jersey City","St. Petersburg","Laredo","Madison","Chandler","Buffalo","Lubbock","Scottsdale","Reno","Glendale","Gilbert","Winston\u2013Salem","North Las Vegas","Norfolk","Chesapeake","Garland","Irving","Hialeah","Fremont","Boise","Richmond","Baton Rouge","Spokane","Des Moines","Tacoma","San Bernardino","Modesto","Fontana","Santa Clarita","Birmingham","Oxnard","Fayetteville","Moreno Valley","Rochester","Glendale","Huntington Beach","Salt Lake City","Grand Rapids","Amarillo","Yonkers","Aurora","Montgomery","Akron","Little Rock","Huntsville","Augusta","Port St. Lucie","Grand Prairie","Columbus","Tallahassee","Overland Park","Tempe","McKinney","Mobile","Cape Coral","Shreveport","Frisco","Knoxville","Worcester","Brownsville","Vancouver","Fort Lauderdale","Sioux Falls","Ontario","Chattanooga","Providence","Newport News","Rancho Cucamonga","Santa Rosa","Oceanside","Salem","Elk Grove","Garden Grove","Pembroke Pines","Peoria","Eugene","Corona","Cary","Springfield","Fort Collins","Jackson","Alexandria","Hayward","Lancaster","Lakewood","Clarksville","Palmdale","Salinas","Springfield","Hollywood","Pasadena","Sunnyvale","Macon","Kansas City","Pomona","Escondido","Killeen","Naperville","Joliet","Bellevue","Rockford","Savannah","Paterson","Torrance","Bridgeport","McAllen","Mesquite","Syracuse","Midland","Pasadena","Murfreesboro","Miramar","Dayton","Fullerton","Olathe","Orange","Thornton","Roseville","Denton","Waco","Surprise","Carrollton","West Valley City","Charleston","Warren","Hampton","Gainesville","Visalia","Coral Springs","Columbia","Cedar Rapids","Sterling Heights","New Haven","Stamford","Concord","Kent","Santa Clara","Elizabeth","Round Rock","Thousand Oaks","Lafayette","Athens","Topeka","Simi Valley","Fargo","Norman","Columbia","Abilene","Wilmington","Hartford","Victorville","Pearland","Vallejo","Ann Arbor","Berkeley","Allentown","Richardson","Odessa","Arvada","Cambridge","Sugar Land","Beaumont","Lansing","Evansville","Rochester","Independence","Fairfield","Provo","Clearwater","College Station","West Jordan","Carlsbad","El Monte","Murrieta","Temecula","Springfield","Palm Bay","Costa Mesa","Westminster","North Charleston","Miami Gardens","Manchester","High Point","Downey","Clovis","Pompano Beach","Pueblo","Elgin","Lowell","Antioch","West Palm Beach","Peoria","Everett","Ventura","Centennial","Lakeland","Gresham","Richmond","Billings","Inglewood","Broken Arrow","Sandy Springs","Jurupa Valley","Hillsboro","Waterbury","Santa Maria","Boulder","Greeley","Daly City","Meridian","Lewisville","Davie","West Covina","League City","Tyler","Norwalk","San Mateo","Green Bay","Wichita Falls","Sparks","Lakewood","Burbank","Rialto","Allen","El Cajon","Las Cruces","Renton","Davenport","South Bend","Vista","Tuscaloosa","Clinton","Edison","Woodbridge","San Angelo","Kenosha","Vacaville"].forEach((i,e)=>J.register(new Q(i,tl,e===0)))});var kT=C(GT=>{"use strict";Object.defineProperty(GT,"__esModule",{value:!0});MT();ET()});var rl,xm,Ep=n(()=>{Ot();rl=class extends ae{};t(rl,"Aztec");xm=rl});var bY={};var DT=n(()=>{Ep();tr();rr();Object.entries({people:"Aztec",nation:"Aztec",colors:["#A1DAB5","#EA6B76"]}).forEach(([i,e])=>de.register(new fe(xm,i,e)))});var CY={};var OT=n(()=>{Ep();Dt();gt();["Tenochtitlan","Teotihuacan","Tlatelolco","Texcoco","Tlaxcala","Calixtlahuaca","Xochicalco","Tlacopan","Atzcapotzalco","Tzintzuntzan","Malinalco","Tula","Tamuin","Teayo","Cempoala","Chalco","Tlalmanalco","Ixtapaluca","Huexotla","Tepexpan","Tepetlaoxtoc","Chiconautla","Zitlaltepec","Coyotepec","Tequixquiac","Jilotzingo","Tlapanaloya","Tultitan","Ecatepec","Coatepec","Chalchiuites","Chiauhita","Chapultepec","Itzapalapa","Ayotzinco","Iztapam"].forEach((i,e)=>J.register(new Q(i,xm,e===0)))});var ST=C(YT=>{"use strict";Object.defineProperty(YT,"__esModule",{value:!0});DT();OT()});var il,vm,Gp=n(()=>{Ot();il=class extends ae{};t(il,"Babylonian");vm=il});var TY={};var FT=n(()=>{Gp();tr();rr();Object.entries({people:"Babylonian",nation:"Babylon",colors:["#D0B8A6","#2f7b00"]}).forEach(([i,e])=>de.register(new fe(vm,i,e)))});var IY={};var NT=n(()=>{Gp();Dt();gt();["Babilim","Eshnunna","Diniktum","Tutub","Der","Sippar","Kutha","Jemdet Nasr","Kish","Borsippa","Mashkan-shapir","Dilbat","Nippur","Marad","Adab","Isin","Kisurra","Shuruppak","Bad-tibira","Zabalam","Umma","Girsu","Lagash","Urum","Uruk","Larsa","Ur","Kuara","Eridu","Akshak","Akkad"].forEach((i,e)=>J.register(new Q(i,vm,e===0)))});var LT=C(zT=>{"use strict";Object.defineProperty(zT,"__esModule",{value:!0});FT();NT()});var ol,bm,kp=n(()=>{Ot();ol=class extends ae{};t(ol,"Chinese");bm=ol});var wY={};var WT=n(()=>{kp();tr();rr();Object.entries({people:"Chinese",nation:"China",colors:["#ee1c25","#ff0"]}).forEach(([i,e])=>de.register(new fe(bm,i,e)))});var PY={};var jT=n(()=>{kp();Dt();gt();["Beijing","Shanghai","Chongqing","Tianjin","Guangzhou","Shenzhen\u2020","Chengdu","Nanjing","Wuhan","Xi'an","Hangzhou","Dongguan","Foshan","Shenyang","Harbin","Qingdao","Dalian","Jinan","Zhengzhou","Changsha","Kunming","Changchun","\xDCr\xFCmqi","Shantou","Hefei","Shijiazhuang","Ningbo","Taiyuan","Nanning","Xiamen\u2020","Fuzhou","Changzhou","Wenzhou","Nanchang","Tangshan","Guiyang","Wuxi","Lanzhou","Zhongshan","Handan","Huai'an","Weifang","Zibo","Shaoxing","Yantai","Huizhou","Luoyang","Nantong","Baotou","Liuzhou"].forEach((i,e)=>J.register(new Q(i,bm,e===0)))});var HT=C(_T=>{"use strict";Object.defineProperty(_T,"__esModule",{value:!0});WT();jT()});var nl,Cm,Dp=n(()=>{Ot();nl=class extends ae{};t(nl,"Egyptian");Cm=nl});var BY={};var KT=n(()=>{Dp();tr();rr();Object.entries({people:"Egyptian",nation:"Egypt",colors:["#CE1126","#FFF"]}).forEach(([i,e])=>de.register(new fe(Cm,i,e)))});var AY={};var qT=n(()=>{Dp();Dt();gt();["Cairo","Alexandria","Gizeh","Shubra El-Kheima","Port Said","Suez","Luxor","al-Mansura","El-Mahalla El-Kubra","Tanta","Asyut","Ismailia","Fayyum","Zagazig","Aswan","Damietta","Damanhur","al-Minya","Beni Suef","Qena","Sohag","Hurghada","6th of October City","Shibin El Kom","Banha","Kafr el-Sheikh","Arish","Mallawi","10th of Ramadan City","Bilbais","Marsa Matruh","Idfu","Mit Ghamr","Al-Hamidiyya","Desouk","Qalyub","Abu Kabir","Kafr el-Dawwar","Girga","Akhmim","Matarey"].forEach((i,e)=>J.register(new Q(i,Cm,e===0)))});var $T=C(VT=>{"use strict";Object.defineProperty(VT,"__esModule",{value:!0});KT();qT()});var al,sl,Tm=n(()=>{Ot();al=class extends ae{};t(al,"English");sl=al});var UY={};var JT=n(()=>{Tm();tr();rr();Object.entries({people:"English",nation:"England",colors:["#FFF","#C8102E"]}).forEach(([i,e])=>de.register(new fe(sl,i,e)))});var MY={};var ZT=n(()=>{Tm();Dt();gt();["London","Birmingham","Liverpool","Leeds","Sheffield","Bristol","Manchester","Leicester","Coventry","Kingston upon Hull","Stoke-on-Trent","Wolverhampton","Nottingham","Plymouth","Southampton","Reading","Derby","Dudley","Newcastle upon Tyne","Northampton","Portsmouth","Luton","Preston","Sunderland","Norwich","Walsall","Bournemouth","Southend-on-Sea","Swindon","Huddersfield","Poole","Oxford","Middlesbrough","Blackpool","Oldbury","Boldon","Ipswich","York","West Bromwich","Peterborough","Stockport","Brighton","Slough","Gloucester","Rotherham","Cambridge","Exeter","Eastbourne","Sutton Coldfield","Blackburn","Colchester","Oldham","St Helens","Woking","Chesterfield","Crawley"].forEach((i,e)=>J.register(new Q(i,sl,e===0)))});var XT=C(QT=>{"use strict";Object.defineProperty(QT,"__esModule",{value:!0});JT();ZT()});var ll,Im,Op=n(()=>{Ot();ll=class extends ae{};t(ll,"French");Im=ll});var EY={};var eI=n(()=>{Op();tr();rr();Object.entries({people:"French",nation:"France",colors:["#FFF","#0055A4"]}).forEach(([i,e])=>de.register(new fe(Im,i,e)))});var GY={};var tI=n(()=>{Op();Dt();gt();["Paris","Marseille","Lyon","Toulouse","Nice","Nantes","Strasbourg","Montpellier","Bordeaux","Lille","Rennes","Reims","Le Havre","Saint-\xC9tienne","Toulon","Grenoble","Dijon","N\xEEmes","Angers","Villeurbanne","Le Mans","Saint-Denis","Aix-en-Provence","Clermont-Ferrand","Brest","Limoges","Tours","Amiens","Perpignan","Metz","Besan\xE7on","Boulogne-Billancourt","Orl\xE9ans","Mulhouse","Rouen","Saint-Denis","Caen","Argenteuil","Saint-Paul","Montreuil","Nancy","Roubaix","Tourcoing","Nanterre","Avignon","Vitry-sur-Seine","Cr\xE9teil","Dunkirk","Poitiers","Asni\xE8res-sur-Seine","Courbevoie","Versailles","Colombes","Fort-de-France","Aulnay-sous-Bois","Saint-Pierre","Rueil-Malmaison","Pau","Aubervilliers","Le Tampon","Champigny-sur-Marne","Antibes","B\xE9ziers","La Rochelle","Saint-Maur-des-Foss\xE9s","Cannes","Calais","Saint-Nazaire","M\xE9rignac","Drancy","Colmar","Ajaccio","Bourges","Issy-les-Moulineaux","Levallois-Perret","La Seyne-sur-Mer","Quimper","Noisy-le-Grand","Villeneuve-d'Ascq","Neuilly-sur-Seine","Valence","Antony","Cergy","V\xE9nissieux","Pessac","Troyes","Clichy","Ivry-sur-Seine","Chamb\xE9ry","Lorient","Les Abymes","Montauban","Sarcelles","Niort","Villejuif","Saint-Andr\xE9","Hy\xE8res","Saint-Quentin","Beauvais","\xC9pinay-sur-Seine","Cayenne","Maisons-Alfort","Cholet","Meaux","Chelles","Pantin","\xC9vry","Fontenay-sous-Bois","Fr\xE9jus","Vannes","Bondy","Le Blanc-Mesnil","La Roche-sur-Yon","Saint-Louis","Arles","Clamart","Narbonne","Annecy","Sartrouville","Grasse","Laval","Belfort","Bobigny","\xC9vreux","Vincennes","Montrouge","Sevran","Albi","Charleville-M\xE9zi\xE8res","Suresnes","Martigues","Corbeil-Essonnes","Saint-Ouen","Bayonne","Cagnes-sur-Mer","Brive-la-Gaillarde","Carcassonne","Massy","Blois","Aubagne","Saint-Brieuc","Ch\xE2teauroux","Chalon-sur-Sa\xF4ne","Mantes-la-Jolie","Meudon","Saint-Malo","Ch\xE2lons-en-Champagne","Alfortville","S\xE8te","Salon-de-Provence","Vaulx-en-Velin","Puteaux","Rosny-sous-Bois","Saint-Herblain","Gennevilliers","Le Cannet","Livry-Gargan","Saint-Priest","Istres","Valenciennes","Choisy-le-Roi","Caluire-et-Cuire","Boulogne-sur-Mer","Bastia","Angoul\xEAme","Garges-l\xE8s-Gonesse","Castres","Thionville","Wattrelos","Talence","Saint-Laurent-du-Maroni","Douai","Noisy-le-Sec","Tarbes","Arras","Al\xE8s","La Courneuve","Bourg-en-Bresse","Compi\xE8gne","Gap","Melun","Le Lamentin","Rez\xE9","Saint-Germain-en-Laye","Marcq-en-Bar\u0153ul","Gagny","Anglet","Draguignan","Chartres","Bron","Bagneux","Colomiers","Saint-Martin-d'H\xE8res","Pontault-Combault","Montlu\xE7on","Jou\xE9-l\xE8s-Tours","Saint-Joseph","Poissy","Savigny-sur-Orge","Cherbourg-Octeville","Mont\xE9limar","Villefranche-sur-Sa\xF4ne","Stains","Saint-Beno\xEEt","Bagnolet","Ch\xE2tillon","Le Port","Sainte-Genevi\xE8ve-des-Bois","\xC9chirolles","Roanne","Villepinte","Saint-Chamond","Conflans-Sainte-Honorine","Auxerre","Nevers","Neuilly-sur-Marne","La Ciotat","Tremblay-en-France","Thonon-les-Bains","Vitrolles","Haguenau","Six-Fours-les-Plages","Agen","Creil","Annemasse","Saint-Rapha\xEBl","Marignane","Romans-sur-Is\xE8re","Montigny-le-Bretonneux","Le Perreux-sur-Marne","Franconville","M\xE2con","Saint-Leu","Cambrai","Ch\xE2tenay-Malabry","Sainte-Marie","Villeneuve-Saint-Georges","Houilles","\xC9pinal","Lens","Li\xE9vin","Les Mureaux","Schiltigheim","La Possession","Meyzieu","Dreux","Nogent-sur-Marne","Plaisir","Mont-de-Marsan","Palaiseau","Ch\xE2tellerault","Goussainville","L'Ha\xFF-les-Roses","Viry-Ch\xE2tillon","Vigneux-sur-Seine","Chatou","Trappes","Clichy-sous-Bois","Rillieux-la-Pape","Villenave-'Ornon","Maubeuge","Charenton-le-Pont","Malakoff","Matoury","Dieppe","Athis-Mons","Savigny-le-Temple","P\xE9rigueux","Baie-Mahault","Vandoeuvre-l\xE8s-Nancy","Pontoise","Aix-les-Bains","Cachan","Vienne","Thiais","Orange","Saint-M\xE9dard-en-Jalles","Villemomble","Saint-Cloud","Saint-Laurent-du-Var","Yerres","Saint-\xC9tienne-du-Rouvray","Sotteville-l\xE8s-Rouen","Draveil","Le Chesnay","Bois-Colombes","Le Plessis-Robinson","La Garenne-Colombes","Lambersart","Soissons","Pierrefitte-sur-Seine","Carpentras","Villiers-sur-Marne","Vanves","Menton","Bergerac","Ermont","Bezons","Grigny","Guyancourt","Saumur","Herblay","Ris-Orangis","Villiers-le-Bel","Bourgoin-Jallieu","Vierzon","Le Gosier","D\xE9cines-Charpieu","H\xE9nin-Beaumont","Fresnes","Aurillac","Sannois","Vallauris","Illkirch-Graffenstaden","Alen\xE7on","\xC9lancourt","Tournefeuille","B\xE8gles","Gonesse","Oullins","Brunoy","Taverny","Armenti\xE8res","Montfermeil","Rambouillet","Villeparisis","Le Kremlin-Bic\xEAtre","Sucy-en-Brie","Kourou","Montb\xE9liard","Romainville","Cavaillon","Saint-Dizier","Br\xE9tigny-sur-Orge","Saint-S\xE9bastien-sur-Loire","Saintes","La Teste-de-Buch","Villeneuve-la-Garenne","B\xE9thune","Bussy-Saint-Georges","Vichy","La Garde","Agde","Laon","Sens","Lunel","Miramas","Biarritz","Le Grand-Quevilly","Orvault","Les Ulis","Champs-sur-Marne","Rochefort","Muret","Sainte-Anne","Eaubonne","\xC9tampes","Gradignan","Vernon","Petit-Bourg","Libourne","Abbeville","Rodez","Saint-Ouen-l'Aum\xF4ne","Torcy","Maisons-Laffitte","Montgeron","Villeneuve-sur-Lot","Cormeilles-en-Parisis","\xC9pernay","S\xE8vres","Dole","Le Robert","Le Bouscat","Blagnac","Frontignan","Cenon","Mandelieu-la-Napoule","Vertou","Les Lilas","Bruay-la-Buissi\xE8re","Les Pavillons-sous-Bois","Chaumont","Roissy-en-Brie","Le Moule","Le Petit-Quevilly","Manosque","Saint-Mand\xE9","Fontenay-aux-Roses","Orly","Le Creusot","Oyonnax","La Madeleine","Sainte-Suzanne","Millau","Combs-la-Ville","Fontaine","Deuil-la-Barre","Coudekerque-Branche","Auch","Lanester","Beaune","Montigny-l\xE8s-Metz","Hazebrouck","Longjumeau","Sainte-Foy-l\xE8s-Lyon","Forbach","Sarreguemines","Mons-en-Bar\u0153ul","La Valette-du-Var","H\xE9rouville-Saint-Clair","Morsang-sur-Orge","Grande-Synthe","La Celle-Saint-Cloud","Lisieux","Croix","Dammarie-les-Lys","V\xE9lizy-Villacoublay","Wasquehal","Saint-Gratien","Halluin","Neuilly-Plaisance","Montmorency","Dax","Lagny-sur-Marne","Le M\xE9e-sur-Seine","Saint-Genis-Laval","Fleury-les-Aubrais","Loos","Gif-sur-Yvette","Denain","Saint-Di\xE9-des-Vosges","Sainte-Rose","Saint-Michel-sur-Orge"].forEach((i,e)=>J.register(new Q(i,Im,e===0)))});var iI=C(rI=>{"use strict";Object.defineProperty(rI,"__esModule",{value:!0});eI();tI()});var ml,pl,wm=n(()=>{Ot();ml=class extends ae{};t(ml,"German");pl=ml});var kY={};var oI=n(()=>{wm();tr();rr();Object.entries({people:"German",nation:"Germany",colors:["#000","#FC0"]}).forEach(([i,e])=>de.register(new fe(pl,i,e)))});var DY={};var nI=n(()=>{wm();Dt();gt();["Berlin","Hamburg","Munich","Cologne","Frankfurt","Stuttgart","D\xFCsseldorf","Dortmund","Essen","Leipzig","Bremen","Dresden","Hanover","Nuremberg","Duisburg","Bochum","Wuppertal","Bielefeld","Bonn","M\xFCnster","Karlsruhe","Mannheim","Augsburg","Wiesbaden","Gelsenkirchen","M\xF6nchengladbach","Braunschweig","Chemnitz","Kiel","Aachen","Halle","Magdeburg","Freiburg","Krefeld","L\xFCbeck","Oberhausen","Erfurt","Mainz","Rostock","Kassel","Hagen","Hamm","Saarbr\xFCcken","M\xFClheim an der Ruhr","Potsdam","Ludwigshafen am Rhein","Oldenburg","Leverkusen","Osnabr\xFCck","Solingen"].forEach((i,e)=>J.register(new Q(i,pl,e===0)))});var sI=C(aI=>{"use strict";Object.defineProperty(aI,"__esModule",{value:!0});oI();nI()});var ul,Pm,Yp=n(()=>{Ot();ul=class extends ae{};t(ul,"Greek");Pm=ul});var OY={};var lI=n(()=>{Yp();tr();rr();Object.entries({people:"Greek",nation:"Greece",colors:["#2175D8","#FFF"]}).forEach(([i,e])=>de.register(new fe(Pm,i,e)))});var YY={};var mI=n(()=>{Yp();Dt();gt();["Athens","Thessaloniki","Patras","Piraeus","Larissa","Heraklion","Peristeri","Kallithea","Acharnes","Kalamaria","Nikaia","Glyfada","Volos","Ilio","Ilioupoli","Keratsini","Evosmos","Chalandri","Nea Smyrni","Marousi","Agios Dimitrios","Zografou","Egaleo","Nea Ionia","Ioannina","Palaio Faliro","Korydallos","Trikala","Vyronas","Agia Paraskevi","Galatsi","Agrinio","Chalcis","Petroupoli","Serres","Alexandroupoli","Xanthi","Katerini","Kalamata","Kavala","Chania","Lamia","Komotini","Irakleio","Rhodes","Kifissia","Stavroupoli","Chaidari","Drama","Veria","Alimos","Kozani","Polichni","Karditsa","Sykies","Ampelokipoi","Pylaia","Agioi Anargyroi","Argyroupoli","Ano Liosia","Nea Ionia","Rethymno","Ptolemaida","Tripoli","Cholargos","Vrilissia","Aspropyrgos","Corinth","Gerakas","Metamorfosi","Giannitsa","Voula","Kamatero","Mytilene","Neapoli","Eleftherio-Kordelio","Chios","Agia Varvara","Kaisariani","Nea Filadelfeia","Moschato","Perama","Salamina","Eleusis","Corfu","Pyrgos","Megara","Kilkis","Dafni","Thebes","Melissia","Argos","Arta","Artemida","Livadeia","Pefki","Oraiokastro","Aigio","Kos","Koropi","Preveza","Naousa","Orestiada","Peraia","Edessa","Florina","Panorama","Nea Erythraia1","Elliniko1","Amaliada","Pallini","Sparta","Agios Ioannis Rentis","Thermi","Vari","Nea Makri","Tavros","Alexandreia","Menemeni","Paiania","Kalyvia Thorikou","Nafplio","Drapetsona","Efkarpia","Papagou","Nafpaktos","Kastoria","Grevena","Pefka","Nea Alikarnassos","Missolonghi","Gazi","Ierapetra","Kalymnos","Rafina","Loutraki","Agios Nikolaos","Ermoupoli","Ialysos","Mandra","Tyrnavos","Glyka Nera","Ymittos","Neo Psychiko"].forEach((i,e)=>J.register(new Q(i,Pm,e===0)))});var uI=C(pI=>{"use strict";Object.defineProperty(pI,"__esModule",{value:!0});lI();mI()});var cl,Bm,Sp=n(()=>{Ot();cl=class extends ae{};t(cl,"Indian");Bm=cl});var SY={};var cI=n(()=>{Sp();tr();rr();Object.entries({people:"Indian",nation:"India",colors:["#138808","#FF9933"]}).forEach(([i,e])=>de.register(new fe(Bm,i,e)))});var FY={};var yI=n(()=>{Sp();Dt();gt();["Delhi","Mumbai","Bangalore","Hyderabad","Ahmedabad","Chennai","Kolkata","Surat","Pune","Jaipur","Lucknow","Kanpur","Nagpur","Indore","Thane","Bhopal","Visakhapatnam","Pimpri-Chinchwad","Patna","Vadodara","Ghaziabad","Ludhiana","Agra","Nashik","Faridabad","Meerut","Rajkot","Kalyan-Dombivli","Vasai-Virar","Varanasi","Srinagar","Aurangabad","Dhanbad","Amritsar","Navi Mumbai","Allahabad","Howrah","Ranchi","Gwalior","Jabalpur","Coimbatore","Vijayawada","Jodhpur","Madurai","Raipur","Kota","Chandigarh","Guwahati","Solapur","Hubli\u2013Dharwad","Tiruchirappalli","Bareilly","Moradabad","Mysore","Tiruppur","Gurgaon","Aligarh","Jalandhar","Bhubaneswar","Salem","Mira-Bhayandar","Warangal","Jalgaon","Guntur","Bhiwandi","Saharanpur","Gorakhpur","Bikaner","Amravati","Noida","Jamshedpur","Bhilai","Cuttack","Firozabad","Kochi","Nellore","Bhavnagar","Dehradun","Durgapur","Asansol","Rourkela","Nanded","Kolhapur","Ajmer","Akola","Gulbarga","Jamnagar","Ujjain","Loni","Siliguri","Jhansi","Ulhasnagar","Jammu","Sangli-Miraj & Kupwad","Mangalore","Erode","Belgaum","Ambattur","Tirunelveli","Malegaon","Gaya","Thiruvananthapuram","Udaipur","Maheshtala","Davanagere","Kozhikode","Kurnool","Rajpur Sonarpur","Rajahmundry","Bokaro","South Dumdum","Bellary","Patiala","Gopalpur","Agartala","Bhagalpur","Muzaffarnagar","Bhatpara","Panihati","Latur","Dhule","Tirupati","Rohtak","Korba","Bhilwara","Berhampur","Muzaffarpur","Ahmednagar","Mathura","Kollam","Avadi","Kadapa","Kamarhati","Sambalpur","Bilaspur","Shahjahanpur","Satara","Bijapur","Kakinada","Rampur","Shimoga","Chandrapur","Junagadh","Thrissur","Alwar","Bardhaman","Kulti","Nizamabad","Parbhani","Tumkur","Khammam","Ozhukarai","Bihar Sharif","Panipat","Darbhanga","Bally","Aizawl","Dewas","Ichalkaranji","Karnal","Bathinda","Jalna","Eluru","Barasat","Kirari Suleman Nagar","Purnia","Satna","Mau","Sonipat","Farrukhabad","Sagar","Durg","Imphal","Ratlam","Hapur","Arrah","Anantapur","Karimnagar","Etawah","Ambarnath","North Dumdum","Bharatpur","Begusarai","New Delhi","Gandhidham","Baranagar","Tiruvottiyur","Pondicherry","Sikar","Thoothukudi","Rewa","Mirzapur","Raichur","Pali","Ramagundam","Haridwar","Vijayanagaram","Katihar","Nagercoil","Sri Ganganagar","Karawal Nagar","Mango","Thanjavur","Bulandshahr","Uluberia","Katni","Sambhal","Singrauli","Nadiad","Secunderabad","Naihati","Yamunanagar","Bidhannagar","Pallavaram","Bidar","Munger","Panchkula","Burhanpur","Raurkela Industrial Township","Kharagpur","Dindigul","Gandhinagar","Hospet","Nangloi Jat","Malda","Ongole","Deoghar","Chapra","Haldia","Khandwa","Nandyal","Morena","Amroha","Anand","Bhind","Bhalswa Jahangir Pur","Madhyamgram","Bhiwani","Berhampore","Ambala","Morbi","Fatehpur","Raebareli","Mahaboobnagar","Chittoor","Bhusawal","Orai","Bahraich","Vellore","Mehsana","Raiganj","Sirsa","Danapur","Serampore","Sultan Pur Majra","Guna","Jaunpur","Panvel","Shivpuri","Surendranagar Dudhrej","Unnao","Chinsurah","Alappuzha","Kottayam","Machilipatnam","Shimla","Adoni","Udupi","Tenali","Proddatur","Saharsa","Hindupur","Sasaram","Hajipur","Bhimavaram","Kumbakonam","Dehri","Madanapalle","Siwan","Bettiah","Guntakal","Srikakulam","Motihari","Dharmavaram","Gudivada","Phagwara","Narasaraopet","Suryapet","Miryalaguda","Tadipatri","Karaikudi","Kishanganj","Jamalpur","Ballia","Kavali","Tadepalligudem","Amaravati","Buxar","Jehanabad","Aurangabad","Gangtok"].forEach((i,e)=>J.register(new Q(i,Bm,e===0)))});var dI=C(fI=>{"use strict";Object.defineProperty(fI,"__esModule",{value:!0});cI();yI()});var yl,Am,Fp=n(()=>{Ot();yl=class extends ae{};t(yl,"Mongol");Am=yl});var NY={};var gI=n(()=>{Fp();tr();rr();Object.entries({people:"Mongol",nation:"Mongolia",colors:["#DA2032","#0066B3"]}).forEach(([i,e])=>de.register(new fe(Am,i,e)))});var zY={};var hI=n(()=>{Fp();Dt();gt();["Ulaanbaatar","Erdenet","Darkhan","Choibalsan","M\xF6r\xF6n","Nalaikh","Bayankhongor","\xD6lgii","Khovd","Arvaikheer","Ulaangom","Baganuur","Sainshand","Tsetserleg","S\xFCkhbaatar","\xD6nd\xF6rkhaan","Dalanzadgad","Z\xFC\xFCnkharaa","Uliastai","Altai","Baruun-Urt","Mandalgovi","Zuunmod","Zamyn-\xDC\xFCd","Bulgan","Kharkhorin","Choir","Bor-\xD6nd\xF6r","Sharyngo"].forEach((i,e)=>J.register(new Q(i,Am,e===0)))});var xI=C(RI=>{"use strict";Object.defineProperty(RI,"__esModule",{value:!0});gI();hI()});var fl,Um,Np=n(()=>{Ot();fl=class extends ae{};t(fl,"Roman");Um=fl});var LY={};var vI=n(()=>{Np();tr();rr();Object.entries({people:"Roman",nation:"Rome",colors:["#A20101","#D1B24F"]}).forEach(([i,e])=>de.register(new fe(Um,i,e)))});var WY={};var bI=n(()=>{Np();Dt();gt();["Roma","Ariminum","Belum","Placentia","Tarraco","Italica","Mod","Salernum","Bononia","Forum Livii","Regium Lepidi","Aquileia","Ascrivium","Valentia Edetanorum","Scalabis","Villa Euracini","Palma","Colonia Narbo Martius","Massa","Pistoria","Segovia","Gerunda","Pompaelo","Naissus","Brigantium","Florentia","Vesontio","Lutetia Parisiorum","Atuatuca Tungrorum","Iulia Romula Hispalis","Augusta Raurica","Noviodunum","Lugdunum","Siscia","Marsonia","Augusta Treverorum","Castra Legionis","Augusta Taurinorum","Augusta Praetoria Salassorum","Emerita Augusta","Norba Caesarina","Lucus Augusta","Caesarea","Bracara Augusta","Novaesium","Castra Vetera","Pons Drusi","Ovilava","Iuvavum","Augusta Vindelicorum","Turicum","Asturica Augusta","Borbetomagus","Caesaraugusta","Sirmium","Sorviodurum","Mogontiacum","Argentoratum","Bonna","Noviomagus","Castellum apud Confluentes","Divodurum","Caesaromagus","Ambianum","Faventia Paterna Barcino","Abila","Lousonna","Ulpia Noviomagus Batavorum","Rigomagus","Aquae Mattiacorum","Mursa","Emona","Vindonissa","Aventicum","Praetorium Agrippinae","Lugdunum Batavorum","Aequum","Londinium","Albanianis","Lauri","Durovernum Cantiacorum","Regulbium","Rutupiae","Viminacium","Camulodunum","Traiectum","Matilo","Forum Hadriani","Nigrum Pullum","Lindum Colonia","Ratae Corieltauvorum","Durocobrivis","Colonia Agrippina","Durocornovium","Verulamium","Letocetum","Dubris","Danum","Mediolanum","Isca Dumnoniorum","Blestium","Viroconium Cornoviorum","Aquae Sulis","Durnovaria","Lindinis","Ad Flexum","Clausentum","Venta Belgarum","Calleva Atrebatum","Duroliponte","Concangis","Condate","Corinium Dobunnorum","Eboracum","Luguvalium","Arae Flaviae","Isca Augusta","Lagentium","Lopodunum","Moridunum","Venta Silurum","Deva Victrix","Mamucium","Olicana","Vinovia","Bonames","Coria","Gerulata","Vindobona","Biriciana","Cannstatt Castrum","Colonia Nervia Glevensium","Sumelocenna","Lopodunum","Traiectum ad Nicrem","Castra Batavar","Nida","Lactodurum","Bovium","Burgodunum","Lentia","Aquae Granni","Complutum","Aeminium","Traiectum ad Mosam","Coriovallum","Portus Lemanis","Andautonia","Salona","Cibalae","Aquae Helveticae","Aquincum","Apulum","Pons Aelius","Durovigutum","Aelia Capitolina","Ala","Castra Regina","Theranda","Pomaria","Partiscum","Gesoriacum","Aurelia Aquensis","Urbs Aurelianorum","Venetiae","Ragusium"].forEach((i,e)=>J.register(new Q(i,Um,e===0)))});var TI=C(CI=>{"use strict";Object.defineProperty(CI,"__esModule",{value:!0});vI();bI()});var dl,gl,Mm=n(()=>{Ot();dl=class extends ae{};t(dl,"Russian");gl=dl});var jY={};var II=n(()=>{Mm();tr();rr();Object.entries({people:"Russian",nation:"Russia",colors:["#0032A0","#DA291C"]}).forEach(([i,e])=>de.register(new fe(gl,i,e)))});var _Y={};var wI=n(()=>{Mm();Dt();gt();["Moscow","Saint Petersburg","Novosibirsk","Yekaterinburg","Nizhny Novgorod","Kazan","Chelyabinsk","Omsk","Samara","Ufa","Rostov-on-Don","Krasnoyarsk","Voronezh","Perm","Volgograd","Krasnodar","Saratov","Tyumen","Makhachkala","Tolyatti","Barnaul","Ulyanovsk","Izhevsk","Vladivostok","Irkutsk","Khabarovsk","Yaroslavl","Tomsk","Orenburg","Kemerovo","Novokuznetsk","Tula","Ryazan","Kirov","Astrakhan","Naberezhnye Chelny","Sochi","Penza","Lipetsk","Cheboksary","Balashikha","Kaliningrad","Kursk","Stavropol","Ulan-Ude","Bryansk","Tver","Magnitogorsk","Ivanovo","Belgorod","Surgut","Vladimir","Arkhangelsk","Nizhny Tagil","Kaluga","Chita","Saransk","Yakutsk","Smolensk","Podolsk","Volzhsky","Vladikavkaz","Vologda","Cherepovets","Kurgan","Oryol","Grozny","Murmansk","Tambov","Petrozavodsk","Sterlitamak","Kostroma","Nizhnevartovsk","Novorossiysk","Yoshkar-Ola","Taganrog","Komsomolsk-on-Amur","Khimki","Syktyvkar","Nalchik","Nizhnekamsk","Shakhty","Dzerzhinsk","Bratsk","Orsk","Angarsk","Engels","Blagoveshchensk","Stary Oskol","Veliky Novgorod","Korolyov","Pskov","Mytishchi","Biysk","Lyubertsy","Prokopyevsk","Yuzhno-Sakhalinsk","Balakovo","Armavir","Rybinsk","Severodvinsk","Abakan","Petropavlovsk-Kamchatsky","Norilsk","Syzran","Volgodonsk","Ussuriysk","Kamensk-Uralsky","Novocherkassk","Zlatoust","Elektrostal","Almetyevsk","Krasnogorsk","Salavat","Miass","Nakhodka","Kopeysk","Pyatigorsk","Rubtsovsk","Berezniki","Kolomna","Maykop","Odintsovo","Khasavyurt","Kovrov","Kislovodsk","Neftekamsk","Nefteyugansk","Novocheboksarsk","Serpukhov","Shchyolkovo","Novomoskovsk","Bataysk","Pervouralsk","Domodedovo","Derbent","Cherkessk","Orekhovo-Zuyevo","Nevinnomyssk","Dimitrovgrad","Nazran","Kyzyl","Oktyabrsky","Obninsk","Kaspiysk","Novy Urengoy","Ramenskoye","Kamyshin","Murom","Zhukovsky"].forEach((i,e)=>J.register(new Q(i,gl,e===0)))});var BI=C(PI=>{"use strict";Object.defineProperty(PI,"__esModule",{value:!0});II();wI()});var hl,Em,zp=n(()=>{Ot();hl=class extends ae{};t(hl,"Zulu");Em=hl});var HY={};var AI=n(()=>{zp();tr();rr();Object.entries({people:"Zulu",nation:"Zulus",colors:["#FFFD1E","#000"]}).forEach(([i,e])=>de.register(new fe(Em,i,e)))});var KY={};var UI=n(()=>{zp();Dt();gt();["uMgungundlovu","Nobamba","Bulawayo","KwaDukuza","Nongoma","oNdini","Nodwengu","Ndondakusuka","Babanango","Khangela","Kwahlomendlini","Hlobane","eThekwini","Mlambongwenya","Eziqwaqweni","Isiphezi","Masotsheni","Mtunzini","Nyakamubi","Hlatikulu","Mthonjaneni","Empangeni","Pongola","Tungela","Kwamashu","Ingwavuma","Hluhluwe","Mtubatuba","Mhlahlandlela","Mthatha","Maseru","Lobamba","Qunu"].forEach((i,e)=>J.register(new Q(i,Em,e===0)))});var EI=C(MI=>{"use strict";Object.defineProperty(MI,"__esModule",{value:!0});AI();UI()});var qY={};var GI=n(()=>{A();sh();h.register(db)});var DI=C(kI=>{"use strict";Object.defineProperty(kI,"__esModule",{value:!0});GI()});var VY={};var OI=n(()=>{A();lh();h.register(gb)});var SI=C(YI=>{"use strict";Object.defineProperty(YI,"__esModule",{value:!0});OI()});var $Y={};var FI=n(()=>{A();mh();h.register(hb)});var zI=C(NI=>{"use strict";Object.defineProperty(NI,"__esModule",{value:!0});FI()});var JY={};var LI=n(()=>{A();ph();h.register(Rb)});var jI=C(WI=>{"use strict";Object.defineProperty(WI,"__esModule",{value:!0});LI()});var ZY={};var _I=n(()=>{A();uh();h.register(xb)});var KI=C(HI=>{"use strict";Object.defineProperty(HI,"__esModule",{value:!0});_I()});var QY={};var qI=n(()=>{A();ch();h.register(vb)});var $I=C(VI=>{"use strict";Object.defineProperty(VI,"__esModule",{value:!0});qI()});var XY={};var JI=n(()=>{A();yh();h.register(bb)});var QI=C(ZI=>{"use strict";Object.defineProperty(ZI,"__esModule",{value:!0});JI()});var eS={};var XI=n(()=>{A();fh();h.register(Cb)});var tw=C(ew=>{"use strict";Object.defineProperty(ew,"__esModule",{value:!0});XI()});var tS={};var rw=n(()=>{A();dh();h.register(Tb)});var ow=C(iw=>{"use strict";Object.defineProperty(iw,"__esModule",{value:!0});rw()});var rS={};var nw=n(()=>{A();gh();h.register(Ib)});var sw=C(aw=>{"use strict";Object.defineProperty(aw,"__esModule",{value:!0});nw()});var iS={};var lw=n(()=>{A();hh();h.register(wb)});var pw=C(mw=>{"use strict";Object.defineProperty(mw,"__esModule",{value:!0});lw()});var oS={};var uw=n(()=>{A();Rh();h.register(Pb)});var yw=C(cw=>{"use strict";Object.defineProperty(cw,"__esModule",{value:!0});uw()});var nS={};var fw=n(()=>{A();xh();h.register(Bb)});var gw=C(dw=>{"use strict";Object.defineProperty(dw,"__esModule",{value:!0});fw()});var aS={};var hw=n(()=>{A();vh();h.register(Ab)});var xw=C(Rw=>{"use strict";Object.defineProperty(Rw,"__esModule",{value:!0});hw()});var sS={};var vw=n(()=>{A();bh();h.register(Ub)});var Cw=C(bw=>{"use strict";Object.defineProperty(bw,"__esModule",{value:!0});vw()});var lS={};var Tw=n(()=>{A();Ch();h.register(Mb)});var ww=C(Iw=>{"use strict";Object.defineProperty(Iw,"__esModule",{value:!0});Tw()});var mS={};var Pw=n(()=>{A();Th();h.register(Eb)});var Aw=C(Bw=>{"use strict";Object.defineProperty(Bw,"__esModule",{value:!0});Pw()});var pS={};var Uw=n(()=>{A();Ih();h.register(Gb)});var Ew=C(Mw=>{"use strict";Object.defineProperty(Mw,"__esModule",{value:!0});Uw()});var uS={};var Gw=n(()=>{A();wh();h.register(kb)});var Dw=C(kw=>{"use strict";Object.defineProperty(kw,"__esModule",{value:!0});Gw()});var cS={};var Ow=n(()=>{A();Ph();h.register(Db)});var Sw=C(Yw=>{"use strict";Object.defineProperty(Yw,"__esModule",{value:!0});Ow()});var yS={};var Fw=n(()=>{A();Bh();h.register(Ob)});var zw=C(Nw=>{"use strict";Object.defineProperty(Nw,"__esModule",{value:!0});Fw()});var fS={};var Lw=n(()=>{A();Ah();h.register(Yb)});var jw=C(Ww=>{"use strict";Object.defineProperty(Ww,"__esModule",{value:!0});Lw()});var dS={};var _w=n(()=>{A();Uh();h.register(Sb)});var Kw=C(Hw=>{"use strict";Object.defineProperty(Hw,"__esModule",{value:!0});_w()});var gS={};var qw=n(()=>{A();Mh();h.register(Fb)});var $w=C(Vw=>{"use strict";Object.defineProperty(Vw,"__esModule",{value:!0});qw()});var hS={};var Jw=n(()=>{A();Eh();h.register(Nb)});var Qw=C(Zw=>{"use strict";Object.defineProperty(Zw,"__esModule",{value:!0});Jw()});var RS={};var Xw=n(()=>{A();Gh();h.register(zb)});var tP=C(eP=>{"use strict";Object.defineProperty(eP,"__esModule",{value:!0});Xw()});var xS={};var rP=n(()=>{A();kh();h.register(Lb)});var oP=C(iP=>{"use strict";Object.defineProperty(iP,"__esModule",{value:!0});rP()});var vS={};var nP=n(()=>{A();Dh();h.register(Wb)});var sP=C(aP=>{"use strict";Object.defineProperty(aP,"__esModule",{value:!0});nP()});var bS={};var lP=n(()=>{A();Oh();h.register(jb)});var pP=C(mP=>{"use strict";Object.defineProperty(mP,"__esModule",{value:!0});lP()});var CS={};var uP=n(()=>{A();Yh();h.register(_b)});var yP=C(cP=>{"use strict";Object.defineProperty(cP,"__esModule",{value:!0});uP()});var TS={};var fP=n(()=>{A();Sh();h.register(Hb)});var gP=C(dP=>{"use strict";Object.defineProperty(dP,"__esModule",{value:!0});fP()});var IS={};var hP=n(()=>{A();Fh();h.register(Kb)});var xP=C(RP=>{"use strict";Object.defineProperty(RP,"__esModule",{value:!0});hP()});var wS={};var vP=n(()=>{A();Nh();h.register(qb)});var CP=C(bP=>{"use strict";Object.defineProperty(bP,"__esModule",{value:!0});vP()});var PS={};var TP=n(()=>{A();zh();h.register(Vb)});var wP=C(IP=>{"use strict";Object.defineProperty(IP,"__esModule",{value:!0});TP()});var BS={};var PP=n(()=>{A();Lh();h.register($b)});var AP=C(BP=>{"use strict";Object.defineProperty(BP,"__esModule",{value:!0});PP()});var AS={};var UP=n(()=>{A();Wh();h.register(Jb)});var EP=C(MP=>{"use strict";Object.defineProperty(MP,"__esModule",{value:!0});UP()});var US={};var GP=n(()=>{A();jh();h.register(Zb)});var DP=C(kP=>{"use strict";Object.defineProperty(kP,"__esModule",{value:!0});GP()});var MS={};var OP=n(()=>{A();_h();h.register(Qb)});var SP=C(YP=>{"use strict";Object.defineProperty(YP,"__esModule",{value:!0});OP()});var ES={};var FP=n(()=>{A();Hh();h.register(Xb)});var zP=C(NP=>{"use strict";Object.defineProperty(NP,"__esModule",{value:!0});FP()});var GS={};var LP=n(()=>{A();Kh();h.register(eC)});var jP=C(WP=>{"use strict";Object.defineProperty(WP,"__esModule",{value:!0});LP()});var kS={};var _P=n(()=>{A();qh();h.register(tC)});var KP=C(HP=>{"use strict";Object.defineProperty(HP,"__esModule",{value:!0});_P()});var DS={};var qP=n(()=>{A();Vh();h.register(rC)});var $P=C(VP=>{"use strict";Object.defineProperty(VP,"__esModule",{value:!0});qP()});var OS={};var JP=n(()=>{A();$h();h.register(iC)});var QP=C(ZP=>{"use strict";Object.defineProperty(ZP,"__esModule",{value:!0});JP()});var YS={};var XP=n(()=>{A();Jh();h.register(oC)});var tB=C(eB=>{"use strict";Object.defineProperty(eB,"__esModule",{value:!0});XP()});var SS={};var rB=n(()=>{A();Zh();h.register(nC)});var oB=C(iB=>{"use strict";Object.defineProperty(iB,"__esModule",{value:!0});rB()});var FS={};var nB=n(()=>{A();Qh();h.register(aC)});var sB=C(aB=>{"use strict";Object.defineProperty(aB,"__esModule",{value:!0});nB()});var NS={};var lB=n(()=>{A();Xh();h.register(sC)});var pB=C(mB=>{"use strict";Object.defineProperty(mB,"__esModule",{value:!0});lB()});var zS={};var uB=n(()=>{A();eR();h.register(lC)});var yB=C(cB=>{"use strict";Object.defineProperty(cB,"__esModule",{value:!0});uB()});var LS={};var fB=n(()=>{A();tR();h.register(mC)});var gB=C(dB=>{"use strict";Object.defineProperty(dB,"__esModule",{value:!0});fB()});var WS={};var hB=n(()=>{A();rR();h.register(pC)});var xB=C(RB=>{"use strict";Object.defineProperty(RB,"__esModule",{value:!0});hB()});var jS={};var vB=n(()=>{A();iR();h.register(uC)});var CB=C(bB=>{"use strict";Object.defineProperty(bB,"__esModule",{value:!0});vB()});var _S={};var TB=n(()=>{A();oR();h.register(cC)});var wB=C(IB=>{"use strict";Object.defineProperty(IB,"__esModule",{value:!0});TB()});var HS={};var PB=n(()=>{A();nR();h.register(yC)});var AB=C(BB=>{"use strict";Object.defineProperty(BB,"__esModule",{value:!0});PB()});var KS={};var UB=n(()=>{A();aR();h.register(fC)});var EB=C(MB=>{"use strict";Object.defineProperty(MB,"__esModule",{value:!0});UB()});var qS={};var GB=n(()=>{A();sR();h.register(dC)});var DB=C(kB=>{"use strict";Object.defineProperty(kB,"__esModule",{value:!0});GB()});var VS={};var OB=n(()=>{A();lR();h.register(gC)});var SB=C(YB=>{"use strict";Object.defineProperty(YB,"__esModule",{value:!0});OB()});var $S={};var FB=n(()=>{A();mR();h.register(hC)});var zB=C(NB=>{"use strict";Object.defineProperty(NB,"__esModule",{value:!0});FB()});var JS={};var LB=n(()=>{A();pR();h.register(RC)});var jB=C(WB=>{"use strict";Object.defineProperty(WB,"__esModule",{value:!0});LB()});var ZS={};var _B=n(()=>{A();uR();h.register(xC)});var KB=C(HB=>{"use strict";Object.defineProperty(HB,"__esModule",{value:!0});_B()});var QS={};var qB=n(()=>{A();cR();h.register(vC)});var $B=C(VB=>{"use strict";Object.defineProperty(VB,"__esModule",{value:!0});qB()});var XS={};var JB=n(()=>{A();yR();h.register(bC)});var QB=C(ZB=>{"use strict";Object.defineProperty(ZB,"__esModule",{value:!0});JB()});var eF={};var XB=n(()=>{A();gR();h.register(IC)});var tA=C(eA=>{"use strict";Object.defineProperty(eA,"__esModule",{value:!0});XB()});var tF={};var rA=n(()=>{A();fR();h.register(CC)});var oA=C(iA=>{"use strict";Object.defineProperty(iA,"__esModule",{value:!0});rA()});var rF={};var nA=n(()=>{A();dR();h.register(TC)});var sA=C(aA=>{"use strict";Object.defineProperty(aA,"__esModule",{value:!0});nA()});var iF={};var lA=n(()=>{A();hR();h.register(wC)});var pA=C(mA=>{"use strict";Object.defineProperty(mA,"__esModule",{value:!0});lA()});var oF={};var uA=n(()=>{A();RR();h.register(PC)});var yA=C(cA=>{"use strict";Object.defineProperty(cA,"__esModule",{value:!0});uA()});var nF={};var fA=n(()=>{A();xR();h.register(BC)});var gA=C(dA=>{"use strict";Object.defineProperty(dA,"__esModule",{value:!0});fA()});var Ee,Ts,Rl=n(()=>{$e();Ee=class extends W{};t(Ee,"Unhappiness");Ts=Ee});var CR,bf,ei,Is=n(()=>{$e();CR=t(i=>i instanceof W?-i.value():-i,"negate"),bf=class extends W{add(e,r=""){super.add(CR(e),r)}set(e,r=""){super.set(CR(e),r)}subtract(e,r=""){super.subtract(CR(e),r)}};t(bf,"NegativeYield");ei=t(i=>{["add","set","subtract"].forEach(e=>Object.defineProperty(i.prototype,e,Object.getOwnPropertyDescriptor(bf.prototype,e)||Object.create(null)))},"makeNegative")});var xl,hA=n(()=>{Rl();Is();xl=class extends Ts{#e;constructor(e,r){super(e,r.id()),this.#e=r}cityImprovement(){return this.#e}};t(xl,"CityImprovementContent");ei(xl)});var hn,Cf=n(()=>{oa();Is();hn=class extends ia{};t(hn,"Corruption");ei(hn)});var Do,RA,Tf=n(()=>{$e();Do=class extends W{};t(Do,"Happiness");RA=Do});var Li,xA,Lp=n(()=>{$e();Li=class extends W{};t(Li,"Luxuries");xA=Li});var Gm,vA,TR=n(()=>{Ks();Is();Gm=class extends Ho{};t(Gm,"PopulationSupportFood");ei(Gm);vA=Gm});var qt,If=n(()=>{$e();qt=class extends W{};t(qt,"Research")});var ws,bA,IR=n(()=>{Ks();Is();ws=class extends Ho{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(ws,"UnitSupportFood");ei(ws);bA=ws});var Ps,wR,PR=n(()=>{em();Is();Ps=class extends ra{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(Ps,"UnitSupportProduction");ei(Ps);wR=Ps});var Bs=n(()=>{is();Cf();yc();Ll();Tf();Lp();TR();If();oa();Rl();IR();PR()});var km,CA=n(()=>{Tf();km=class extends RA{};t(km,"LuxuryHappiness")});var vl,TA=n(()=>{Rl();Is();vl=class extends Ts{#e;constructor(e,r){super(e,r.id()),this.#e=r}unit(){return this.#e}};t(vl,"MartialLaw");ei(vl)});var ua,IA=n(()=>{Rl();ua=class extends Ts{#e;constructor(e,r){super(e,r.id()),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(ua,"MilitaryUnhappiness")});var Dm,wA=n(()=>{Rl();Dm=class extends Ts{};t(Dm,"PopulationUnhappiness")});var wf=n(()=>{If()});var Om=n(()=>{hA();Bs();Tf();Lp();CA();TA();IA();wA();is();wf();Rl()});var Pf,Bf,BR=n(()=>{M();Pf=class extends x{};t(Pf,"CelebrateLeader");Bf=Pf});var aF,PA,BA=n(()=>{ir();Om();BR();B();Zi();aF=t((i=ce)=>[new Bf(new l(e=>i.getByCity(e).size()>2),new l((e,r=e.yields())=>{let[o,a]=na(r,Do,Ee);return a===0&&Math.floor(o)>=i.getByCity(e).size()/2}))],"getRules"),PA=aF});var sF,AA,UA=n(()=>{Gn();ir();dn();Om();on();Ke();Sl();B();I();sF=t((i=ce,e=pt,r=N)=>[new jo(new m(o=>new Dm(Math.max(i.getByCity(o).size()-5,0)))),...[[ft,1],[nt,2]].map(([o,a])=>new jo(new l(s=>{try{return e.getByPlayer(s.player()).is(o)}catch{return!1}}),new l(s=>r.getByCity(s).filter(p=>[Ft,F,We].some(u=>p instanceof u)&&p.tile()!==s.tile()).length>0),new m(s=>r.getByCity(s).filter(p=>[Ft,F,We].some(u=>p instanceof u)&&p.tile()!==s.tile()).map(p=>new ua(a,p)))))],"getRules"),AA=sF});var Af,Sn,Ym=n(()=>{M();Af=class extends x{};t(Af,"CivilDisorder");Sn=Af});var lF,MA,EA=n(()=>{Om();Ym();B();Zi();lF=t(()=>[new Sn(new l((i,e=i.yields())=>{let[r,o]=na(e,Do,Ee);return o>r}))],"getRules"),MA=lF});var Uf,he,cr=n(()=>{Ae();Ce();Uf=class extends O{constructor(){super(Y)}getByCity(e){return this.filter(r=>r.city()===e)}};t(Uf,"CityImprovementRegistry");he=new Uf});var Mf,Rn,AR=n(()=>{$d();Mf=class extends au{validate(...e){return!this.criteria().length||this.criteria().some(r=>r.validate(...e))}};t(Mf,"Or");Rn=Mf});var mF,GA,kA=n(()=>{dn();Ei();ir();Om();cr();on();He();P();Ke();Gl();B();I();Gn();Bl();Kn();lr();AR();Zi();mF=t((i=d,e=ce,r=he,o=pt,a=z,s=N)=>[new Xe(new l(p=>o.getByPlayer(p.player()).is(Mi,Ct,Ht,at)),new m((p,u)=>s.getByTile(p.tile()).filter(y=>y instanceof F).slice(0,Math.min(4,qe(u,Ee))).map(y=>new vl(1,y)))),...[[Mt,1],[Mt,1,_t],[Zr,3],[pr,4]].map(([p,u,...y])=>new Xe(new Qe,new l(c=>r.getByCity(c).some(f=>f instanceof p)),new Rn(new l(c=>y.length===0),new l(c=>y.every(f=>a.getByPlayer(c.player()).completed(f)))),new l((c,f)=>qe(f,Ee)>0),new m((c,f)=>new xl(Math.min(u,qe(f,Ee)),r.getByCity(c).filter(g=>g instanceof p)[0])))),new Xe(new Fa,new m((p,u)=>new km(Math.floor(qe(u,Li)/2),Li.name)))],"getRules"),GA=mF});var Ef,ca,Wp=n(()=>{M();Ef=class extends x{};t(Ef,"TurnStart");ca=Ef});var pF,DA,OA=n(()=>{tt();V();P();BR();Ym();I();Kn();Wp();pF=t((i=_,e=d,r=w)=>[new ca(new Qe,new m(o=>i.getByPlayer(o).forEach(a=>{e.get(Sn).some(s=>s.validate(a,a.yields()))&&r.emit("city:civil-disorder",a),e.get(Bf).some(s=>s.validate(a,a.yields()))&&r.emit("city:leader-celebration",a)})))],"getRules"),DA=pF});var uF={};var YA=n(()=>{P();BA();UA();EA();kA();OA();d.register(...PA(),...AA(),...MA(),...GA(),...DA())});var FA=C(SA=>{"use strict";Object.defineProperty(SA,"__esModule",{value:!0});YA()});var cF={};var NA=n(()=>{Ei();Fl();Cn.register($r,mr,Jr,pr,fo,Zr,Tr,Kt,Qr,Tt,Ir,wr,ur,go,It,dt,wt,ho,Ro,Mt,Pr)});var yF,zA,LA=n(()=>{Ei();lr();Xm();cr();He();B();I();yF=t((i=he,e=z)=>[new Qt(new m((r,o)=>new l(()=>!i.getByCity(r).some(a=>a instanceof o)))),...[[$r,Lr],[fo,Wt],[Zr,Lr],[Tr,hr],[Qr,cn],[Ir,Cr],[ur,Ti],[dt,Wt],[Mt,bi],[mr,vi],[pr,bt],[Kt,vt],[Tt,ct],[go,jt],[wr,Vr],[It,so],[wt,Bi],[ho,yn],[Ro,co],[Pr,sr]].map(([r,o])=>new Qt(new l((a,s)=>s===r),new m(a=>new l(()=>e.getByPlayer(a.player()).completed(o))))),...[[mr,ur],[Pr,Ir],[Tt,Kt],[It,Kt],[wt,Kt],[wr,Tt,It,wt]].map(([r,...o])=>new Qt(new l((a,s)=>s===r),new m(a=>new l(()=>i.getByCity(a).some(s=>o.some(p=>s instanceof p)))))),...[[Tr,dt],[Tt,It,wt],[It,wt,Tt],[wt,Tt,It]].map(([r,...o])=>new Qt(new l((a,s)=>s===r),new m(a=>new l(()=>i.getByCity(a).every(s=>!o.some(p=>s instanceof p))))))],"getRules"),zA=yF});var fF,WA,jA=n(()=>{Ei();tp();fF=t(()=>[...[[$r,120],[Jr,40],[fo,120],[Zr,100],[Tr,80],[Qr,60],[Ir,80],[ur,80],[dt,200],[Mt,40],[mr,120],[pr,160],[Kt,200],[Tt,240],[go,160],[wr,320],[It,160],[wt,160],[ho,200],[Ro,200],[Pr,160]].flatMap(([i,e])=>Nl(i,e))],"getRules"),WA=fF});var dF,_A,HA=n(()=>{cr();Ds();I();Ei();dF=t((i=he)=>[new yr(new m(e=>{let[r]=i.getByCity(e).filter(o=>o instanceof dt);!r||i.unregister(r)}))],"getRules"),_A=dF});var pe,UR=n(()=>{Ll();Is();pe=class extends tc{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("cityImprovement")}cityImprovement(){return this.#e}};t(pe,"CityImprovementMaintenanceGold");ei(pe)});var Gf=n(()=>{Bs();UR();Cf();yc();Lp();wf();oa()});var gF,KA,qA=n(()=>{Ei();lr();cr();He();Gf();Gl();B();I();gF=t((i=he,e=z)=>[...[[$r,pe,2],[mr,pe,3],[pr,pe,3],[fo,pe,2],[Zr,pe,2],[Tr,pe,1],[Kt,pe,4],[Qr,pe,1],[Tt,pe,4],[Ir,pe,1],[wr,pe,6],[ur,pe,1],[go,pe,4],[It,pe,2],[dt,pe,0],[wt,pe,4],[ho,pe,2],[Ro,pe,4],[Mt,pe,1],[Pr,pe,3]].map(([r,o,a])=>new Xe(new l(s=>i.getByCity(s).some(p=>p instanceof r)),new m(s=>{let[p]=i.getByCity(s).filter(u=>u instanceof r);return new o(a,p)}))),...[[Jr,pe,0,null,yt],[Jr,pe,1,yt,ut],[Jr,pe,2,ut,null]].map(([r,o,a,s,p])=>new Xe(new l(u=>i.getByCity(u).some(y=>y instanceof r)),new l(u=>s===null||e.getByPlayer(u.player()).completed(s)),new l(u=>p===null||!e.getByPlayer(u.player()).completed(p)),new m(u=>{let[y]=i.getByCity(u).filter(c=>c instanceof r);return new o(a,y)})))],"getRules"),KA=gF});var hF,VA,$A=n(()=>{cr();tt();P();Pu();B();I();Ei();hF=t((i=_,e=he,r=d)=>[new Wo(new l(o=>i.getByPlayer(o.player()).length===0),new m(o=>e.register(new dt(o,r))))],"getRules"),VA=hF});var RF,JA,ZA=n(()=>{cr();B();Os();I();RF=t((i=he)=>[new fr(new l(e=>i.getByCity(e).length>0),new m(e=>i.getByCity(e).forEach(r=>i.unregister(r))))],"getRules"),JA=RF});var xF,QA,XA=n(()=>{Ei();cr();B();I();Gf();gc();xF=t((i=he)=>[new Pn(new l(e=>!i.getByCity(e.city()).some(r=>r instanceof $r)),new l(e=>e.size()>10),new m(e=>e.shrink())),new Pn(new l(e=>i.getByCity(e.city()).some(r=>r instanceof Qr)),new m(e=>e.add(new wn(e.cost().value()/2))))],"getRules"),QA=xF});var vF,eU,tU=n(()=>{cr();V();xg();I();vF=t((i=he,e=w)=>[new ap(new m(r=>i.register(r))),new ap(new m((r,o)=>{e.emit("city-improvement:created",r,o)}))],"getRules"),eU=vF});var bF,rU,iU=n(()=>{Ei();cr();Gf();B();I();Zd();Su();Zi();bF=t((i=he)=>[...[[ur,er,.5],[ur,Li,.5],[mr,er,.5],[mr,Li,.5],[Ir,qt,.5],[Pr,qt,.5],[Kt,K,.5],[wt,K,.5],[Tt,K,.5],[It,K,.5],[wr,K,.5],[Tr,hn,.5]].map(([e,r,o])=>new Ys(new ix,new l(a=>i.getByCity(a).some(s=>s instanceof e)),new m((a,s)=>new r(Math.floor(qe(s,r)*o),e.name))))],"getRules"),rU=bF});var CF,oU,nU=n(()=>{cr();sa();Ei();Kc();B();I();Mp();CF=t((i=he,e=nr)=>[new Qn(new l(r=>r.city()!==null),new l(r=>i.getByCity(r.city()).some(o=>o instanceof Jr)),new m(r=>e.register(new ma(r))))],"getRules"),oU=CF});var TF={};var aU=n(()=>{P();LA();jA();HA();qA();$A();ZA();XA();tU();iU();nU();d.register(...zA(),...WA(),..._A(),...KA(),...VA(),...JA(),...QA(),...eU(),...rU(),...oU())});var lU=C(sU=>{"use strict";Object.defineProperty(sU,"__esModule",{value:!0});NA();aU()});var IF,mU,pU=n(()=>{rp();I();V();IF=t((i=w)=>[new Vn(new m((e,r)=>{i.emit("city:building-complete",e,r)}))],"getRules"),mU=IF});var wF,uU,cU=n(()=>{tt();ir();$n();Ke();V();Ds();I();wF=t((i=_,e=N,r=ce,o=Xt,a=w)=>[new yr(new m(s=>o.getByCity(s).progress().set(0))),new yr(new m(s=>r.getByCity(s).shrink())),new yr(new m((s,p,u)=>{a.emit("city:captured",s,p,u)})),new yr(new m(s=>e.getByCity(s).forEach(p=>p.destroy())))],"getRules"),uU=wF});var PF,yU,fU=n(()=>{Gn();dn();ir();on();Ke();Gl();B();I();TR();gn();IR();PR();PF=t((i=ce,e=pt,r=N)=>[new Xe(new m(o=>new vA(i.getByCity(o).size()*2))),...[[je,1,Mi,Ht],[je,2,Ct,nt,at,ft]].map(([o,a,...s])=>new Xe(new l(p=>r.getByCity(p).some(u=>u instanceof o)),new l(p=>e.getByPlayer(p.player()).is(...s)),new m(p=>r.getByCity(p).filter(u=>u instanceof o).map(u=>new bA(a,u))))),new Xe(new l(o=>e.getByPlayer(o.player()).is(Mi,Ht)),new l(o=>{let a=i.getByCity(o);return r.getByCity(o).filter(s=>[Ft,F,We,gr].some(p=>s instanceof p)).length>a.size()}),new m(o=>{let a=i.getByCity(o);return r.getByCity(o).filter(s=>[Ft,F,We,gr].some(p=>s instanceof p)).slice(a.size()).map(s=>new wR(1,s))})),new Xe(new l(o=>e.getByPlayer(o.player()).is(Ct,nt,at,ft)),new m(o=>r.getByCity(o).filter(a=>[Ft,F,We,gr].some(s=>a instanceof s)).map(a=>new wR(1,a))))],"getRules"),yU=PF});var BF,dU,gU=n(()=>{Fl();$n();ir();tt();V();kn();Ji();P();di();$u();xc();Pu();I();tm();B();BF=t((i=ze,e=Xt,r=ce,o=_,a=ie,s=d,p=Cn,u=w)=>[...[Be,Ye].map(y=>new Wo(new l(c=>i.getByTile(c.tile()).every(f=>!(f instanceof y))),new m(c=>i.register(new y(c.tile()))))),new Wo(new m(y=>e.register(new zl(y,p,s)))),new Wo(new m(y=>r.register(new Ws(y,s)))),new Wo(new m(y=>o.register(y))),new Wo(new m(y=>{u.emit("city:created",y)})),new Wo(new m(y=>os(y,a,r)))],"getRules"),dU=BF});var AF,hU,RU=n(()=>{tt();V();di();Ke();Os();I();kn();AF=t((i=ze,e=_,r=w,o=N)=>[new fr(new m(a=>i.getByTile(a.tile()).filter(s=>s instanceof Be).forEach(s=>i.unregister(s)))),new fr(new m(a=>e.unregister(a))),new fr(new m((a,s)=>{r.emit("city:destroyed",a,s)})),new fr(new m(a=>o.getByCity(a).forEach(s=>s.destroy())))],"getRules"),hU=AF});var kf,Df,MR=n(()=>{M();kf=class extends x{};t(kf,"FoodExhausted");Df=kf});var UF,xU,vU=n(()=>{I();MR();UF=t(()=>[new Df(new m(i=>i.shrink()))],"getRules"),xU=UF});var MF,bU,CU=n(()=>{P();B();I();hg();MR();MF=t((i=d)=>[new np(new l(e=>e.progress().value()>=e.cost().value()),new m(e=>e.grow())),new np(new l(e=>e.progress().value()<0),new m(e=>{i.process(Df,e)}))],"getRules"),bU=MF});var EF,TU,IU=n(()=>{ir();Ji();B();I();gc();tm();EF=t((i=ce,e=ie)=>[new Pn(new m(r=>r.empty())),new Pn(new m(r=>r.cost().set((r.size()+1)*10,"city-grow"))),new Pn(new l(r=>r.city().tilesWorked().length<r.size()+1),new m(r=>os(r.city(),e,i))),new Pn(new l(r=>r.city().tilesWorked().length>r.size()+1),new m(r=>r.city().tilesWorked().entries().slice(r.size()+1).forEach(o=>r.city().tilesWorked().unregister(o))))],"getRules"),TU=EF});var GF,wU,PU=n(()=>{dg();I();GF=t(()=>[new cc(new m(i=>10*(i.size()+1)))],"getRules"),wU=GF});var Of,Oo,Sm=n(()=>{M();Of=class extends x{};t(Of,"ProcessYield");Oo=Of});var Yf,bl,Sf=n(()=>{M();Yf=class extends x{};t(Yf,"Unsupported");bl=Yf});var kF,BU,AU=n(()=>{$n();ir();is();Bs();P();Ke();Ym();B();I();Sm();Sf();kF=t((i=Xt,e=ce,r=N,o=d)=>[new Oo(new l(a=>a instanceof $),new m((a,s,p)=>{let u=e.getByCity(s),y=new wn(a);p.forEach(c=>{if(!(c instanceof ws)||y.value()>=0)return;let f=c.unit();f!==null&&(o.process(bl,s,f,c),y.subtract(c))}),u.add(y),u.check()})),new Oo(new l(a=>a instanceof K),new m((a,s,p)=>{let u=i.getByCity(s),y=a.clone();p.filter(f=>f instanceof Ps).sort((f,g)=>(f.unit()?.tile().distanceFrom(s.tile())??0)-(g.unit()?.tile().distanceFrom(s.tile())??0)).forEach(f=>{if(y.value()>=0)return;let g=f.unit();g!==null&&(o.process(bl,s,g,f),y.subtract(f))});let c=s.yields();o.get(Sn).some(f=>f.validate(s,c))||u.add(y),u.check()}))],"getRules"),BU=kF});var DF,UU,MU=n(()=>{ir();Ji();B();I();Rg();tm();DF=t((i=ce,e=ie)=>[new Ls(new l(r=>r.size()>0),new m(r=>r.cost().set((r.size()+1)*10,"city-shrink"))),new Ls(new l(r=>r.size()>0),new l(r=>r.city().tilesWorked().length>r.size()+1),new m(r=>r.city().tilesWorked().entries().slice(r.size()+1).forEach(o=>r.city().tilesWorked().unregister(o)))),new Ls(new l(r=>r.size()>0),new l(r=>r.city().tilesWorked().length<r.size()+1),new m(r=>os(r.city(),e,i))),new Ls(new l(r=>r.size()<=0),new m(r=>r.city().destroy()))],"getRules"),UU=DF});var OF,EU,GU=n(()=>{dn();cr();Bs();on();I();Kn();vR();Sa();Sl();Zi();OF=t((i=he,e=pt)=>[new jo(new Hn,new m((r,o)=>{let a=e.getByPlayer(r.player()),[s]=i.filter(c=>c instanceof $C&&r.player()===c.city().player()).map(c=>c.city()),p=qe(o,se),u=a.is(Ct)?10:a.is(nt)?0:s?s.tile().distanceFrom(r.tile()):32,[y]=[[Mi,8],[Ct,20],[nt,0],[Ht,12],[at,16],[ft,24]].filter(([c])=>a.is(c)).map(([,c])=>c);return new hn(y?Math.min(Math.floor(p*u*3/(10*y)),p):0,u.toFixed(2))})),new jo(new Or(0),new m(r=>r.tilesWorked().entries().flatMap(o=>o.yields(r.player()).flatMap(a=>new a.constructor(a.value(),o.id()+": "+a.values().map(([,s])=>s).join("-"))))))],"getRules"),EU=OF});var YF,kU,DU=n(()=>{ug();$n();tt();Jn();B();I();YF=t((i=Xt,e=_)=>[new ht(new l(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).some(o=>!o.building())),new m(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).filter(o=>!o.building()).map(o=>new Tn(r,o)))),new ht(new l(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).some(o=>!!o.building())),new m(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).filter(o=>!!o.building()).map(o=>new Ka(r,o))))],"getRules"),kU=YF});var SF,OU,YU=n(()=>{ir();tt();V();cm();B();Cp();I();SF=t((i=_,e=ce,r=w)=>[new Ko(new l((o,a,s)=>s instanceof as&&s.to()===o.tile()&&i.getByTile(s.to())!==null),new m(o=>{let a=i.getByTile(o.tile());e.getByCity(a).shrink()})),new Ko(new m((o,a,s)=>r.emit("unit:defeated",o,a,s)))],"getRules"),OU=SF});var FF,SU,FU=n(()=>{I();Sf();FF=t(()=>[new bl(new m((i,e)=>e.destroy()))],"getRules"),SU=FF});var NF={};var NU=n(()=>{pU();cU();fU();gU();RU();vU();CU();IU();PU();AU();MU();GU();P();DU();YU();FU();d.register(...mU(),...uU(),...yU(),...dU(),...hU(),...xU(),...bU(),...TU(),...wU(),...BU(),...UU(),...EU(),...kU(),...OU(),...SU())});var LU=C(zU=>{"use strict";Object.defineProperty(zU,"__esModule",{value:!0});NU()});var jU={};Jp(jU,{default:()=>zF,registerCityNames:()=>WU});var WU,zF,_U=n(()=>{Dt();gt();WU=t((i=J)=>{["Bergen","Cannae","Capua","Cordoba","Cremona","Crete","Cunaxa","Damascus","Dublin","Genoa","Ghent","Issus","Lisbon","Mecca","Melbourne","Milan","Naples","Pisa","Prague","Salamis","Salzburg","Seville","Sidon","Sydney","Tarsus","Toronto","Turin","Tyre","Utica","Venice","Verona"].forEach(e=>i.register(new Q(e,null)))},"registerCityNames"),zF=WU});var HU=n(()=>{Rm();Ep();Gp();kp();Dp();Tm();Op();wm();Yp();Sp();Fp();Np();Mm();zp()});var Ff,Nf,ER=n(()=>{Hi();Ot();Ff=class extends De{constructor(){super(ae)}};t(Ff,"CivilizationRegistry");Nf=new Ff});var qU={};Jp(qU,{default:()=>LF,registerCivilizations:()=>KU});var KU,LF,VU=n(()=>{HU();ER();KU=t((i=Nf)=>{i.register(el,rl,il,ol,nl,al,ll,ml,ul,cl,yl,fl,dl,hl)},"registerCivilizations"),LF=KU});var ya,$U=n(()=>{st();Rm();ya=class extends ee{static civilization(){return tl}name(){return"Abraham Lincoln"}};t(ya,"AbrahamLincoln")});var JU=n(()=>{st();Rm()});var ZU=n(()=>{$U();JU()});var fa,QU=n(()=>{st();Ep();fa=class extends ee{static civilization(){return xm}name(){return"Moctezuma II"}};t(fa,"MoctezumaII")});var XU=n(()=>{QU()});var da,eM=n(()=>{st();Gp();da=class extends ee{static civilization(){return vm}name(){return"Hammurabi"}};t(da,"Hammurabi")});var tM=n(()=>{eM()});var ga,rM=n(()=>{st();kp();ga=class extends ee{static civilization(){return bm}name(){return"Mao Zedong"}};t(ga,"MaoZedong")});var iM=n(()=>{rM()});var ha,oM=n(()=>{st();Dp();ha=class extends ee{static civilization(){return Cm}name(){return"Ramesses II"}};t(ha,"RamessesII")});var nM=n(()=>{oM()});var Ra,aM=n(()=>{st();Tm();Ra=class extends ee{static civilization(){return sl}name(){return"Elizabeth I"}};t(Ra,"ElizabethI")});var sM=n(()=>{st();Tm()});var lM=n(()=>{aM();sM()});var xa,mM=n(()=>{st();Op();xa=class extends ee{static civilization(){return Im}name(){return"Napoleon I"}};t(xa,"NapoleonI")});var pM=n(()=>{mM()});var va,uM=n(()=>{st();wm();va=class extends ee{static civilization(){return pl}name(){return"Frederick the Great"}};t(va,"FrederickTheGreat")});var cM=n(()=>{st();wm()});var yM=n(()=>{uM();cM()});var ba,fM=n(()=>{st();Yp();ba=class extends ee{static civilization(){return Pm}name(){return"Alexander the Great"}};t(ba,"AlexanderTheGreat")});var dM=n(()=>{fM()});var Ca,gM=n(()=>{st();Sp();Ca=class extends ee{static civilization(){return Bm}name(){return"Mahatma Gandhi"}};t(Ca,"MahatmaGandhi")});var hM=n(()=>{gM()});var Ta,RM=n(()=>{st();Fp();Ta=class extends ee{static civilization(){return Am}name(){return"Genghis Khan"}};t(Ta,"GenghisKhan")});var xM=n(()=>{RM()});var Ia,vM=n(()=>{st();Np();Ia=class extends ee{static civilization(){return Um}name(){return"Julius Caesar"}};t(Ia,"JuliusCaesar")});var bM=n(()=>{vM()});var CM=n(()=>{st();Mm()});var wa,TM=n(()=>{st();Mm();wa=class extends ee{static civilization(){return gl}name(){return"Joseph Stalin"}};t(wa,"JosephStalin")});var IM=n(()=>{CM();TM()});var Pa,wM=n(()=>{st();zp();Pa=class extends ee{static civilization(){return Em}name(){return"Shaka"}};t(Pa,"Shaka")});var PM=n(()=>{wM()});var GR=n(()=>{ZU();XU();tM();iM();nM();lM();pM();yM();dM();hM();xM();bM();IM();PM()});var AM={};Jp(AM,{default:()=>WF,registerLeaders:()=>BM});var BM,WF,UM=n(()=>{GR();Wl();BM=t((i=In)=>{i.register(ya,fa,da,ga,ha,Ra,xa,va,ba,Ca,Ta,Ia,wa,Pa)},"registerLeaders"),WF=BM});var zf,Fm,Lf=n(()=>{ip();zf=class extends Va{};t(zf,"Aggression");Fm=zf});var Wf,Nm,MM=n(()=>{Lf();Wf=class extends Fm{constructor(e){super(e,1)}};t(Wf,"Aggressive");Nm=Wf});var jf,zm,_f=n(()=>{ip();jf=class extends Va{};t(jf,"Militarism");zm=jf});var Hf,Ba,EM=n(()=>{_f();Hf=class extends zm{constructor(e){super(e,0)}};t(Hf,"Civilized");Ba=Hf});var Kf,Lm,qf=n(()=>{ip();Kf=class extends Va{};t(Kf,"Development");Lm=Kf});var Vf,Wm,GM=n(()=>{qf();Vf=class extends Lm{constructor(e){super(e,1)}};t(Vf,"Expansionist");Wm=Vf});var $f,Jf,kM=n(()=>{Lf();$f=class extends Fm{constructor(e){super(e,0)}};t($f,"Friendly");Jf=$f});var Zf,Qf,DM=n(()=>{_f();Zf=class extends zm{constructor(e){super(e,1)}};t(Zf,"Militaristic");Qf=Zf});var Xf,Cl,OM=n(()=>{Lf();Xf=class extends Fm{constructor(e){super(e,.5)}};t(Xf,"Normal");Cl=Xf});var ed,jm,YM=n(()=>{qf();ed=class extends Lm{constructor(e){super(e,.5)}};t(ed,"Normal");jm=ed});var td,rd,SM=n(()=>{_f();td=class extends zm{constructor(e){super(e,.5)}};t(td,"Normal");rd=td});var id,jp,FM=n(()=>{qf();id=class extends Lm{constructor(e){super(e,0)}};t(id,"Perfectionist");jp=id});var zM={};Jp(zM,{default:()=>jF,registerTraits:()=>NM});var NM,jF,LM=n(()=>{GR();cg();MM();EM();GM();kM();DM();OM();YM();SM();FM();NM=t((i=sc)=>{[[ya,Jf,jm,Ba],[fa,Cl,jp,Ba],[da,Jf,jp,Ba],[ga,Cl,jm,Ba],[ha,Cl,jm,Ba],[Ra,Cl,Wm,rd],[xa,Nm,Wm,Ba],[va,Nm,jp,Ba],[ba,Cl,Wm,Qf],[Ca,Jf,jp,rd],[Ta,Nm,Wm,Qf],[Ia,Cl,Wm,Ba],[wa,Nm,jm,Qf],[Pa,Nm,jm,rd]].forEach(([e,...r])=>r.forEach(o=>i.register(new o(e))))},"registerTraits"),jF=NM});var jM=C(WM=>{"use strict";Object.defineProperty(WM,"__esModule",{value:!0});var _F=(_U(),R(jU)),HF=(VU(),R(qU)),KF=(UM(),R(AM)),qF=(LM(),R(zM));(0,_F.default)();(0,HF.default)();(0,KF.default)();(0,qF.default)()});var od,nd,kR=n(()=>{od=class{#e=[];constructor(...e){this.#e.push(...e)}isBetween(...e){return e.every(r=>this.#e.includes(r))&&e.length===this.#e.length}players(){return this.#e}};t(od,"Interaction");nd=od});var ad,_M,HM=n(()=>{Ce();kR();ad=class extends O{constructor(){super(nd)}getByPlayer(e){return this.entries().filter(r=>r.players().includes(e))}getByPlayers(...e){return this.entries().filter(r=>r.isBetween(...e))}};t(ad,"InteractionRegistry");_M=new ad});var _m,KM=n(()=>{kR();_m=class extends nd{constructor(...e){let r=e.map(o=>o.player());super(...r)}};t(_m,"Contact")});var qM=n(()=>{KM()});var VF,VM,$M=n(()=>{HM();Ke();qM();B();I();Ut();VF=t((i=_M,e=N)=>[new q(new l(r=>r.tile().getNeighbours().some(o=>e.getByTile(o).some(a=>a.player()!==r.player()))),new m(r=>r.tile().getNeighbours().forEach(o=>e.getByTile(o).filter(a=>a.player()!==r.player()).forEach(a=>i.register(new _m(r,a))))))],"getRules"),VM=VF});var $F={};var JM=n(()=>{P();$M();d.register(...VM())});var QM=C(ZM=>{"use strict";Object.defineProperty(ZM,"__esModule",{value:!0});JM()});var JF,XM,eE=n(()=>{B();I();Dg();JF=t(()=>[new rs(new l(i=>i<252),new m(i=>i*20-4020)),new rs(new l(i=>i>251),new l(i=>i<302),new m(i=>(i-151)*10+1e3)),new rs(new l(i=>i>301),new l(i=>i<352),new m(i=>(i-201)*5+1500)),new rs(new l(i=>i>351),new l(i=>i<402),new m(i=>(i-251)*2+1750)),new rs(new l(i=>i>401),new m(i=>i-301+1850))],"getRules"),XM=JF});var ZF={};var tE=n(()=>{P();eE();d.register(...XM())});var iE=C(rE=>{"use strict";Object.defineProperty(rE,"__esModule",{value:!0});tE()});var QF,oE,nE=n(()=>{pg();tt();Jo();He();Qg();B();I();Ks();em();oa();QF=t((i=z,e=_)=>[new Qs(new l((r,o)=>i.getByPlayer(o.player()).available().length>0),new m((r,o)=>new La(r,o))),new Qs(new l(r=>[be,me,oe].some(o=>r.tile().terrain()instanceof o)),new l((r,o)=>r.tile().getSurroundingArea().score(null,[[Ho,8],[ra,3],[ia,1]])>=150),new l(r=>r.tile().getSurroundingArea(4).every(o=>e.getByTile(o)===null)),new m((r,o)=>new Wa(r,o))),new Qs(new m((r,o)=>new _a(r,o))),new Qs(new m((r,o)=>new Ha(r,o)))],"getRules"),oE=QF});var XF,aE,sE=n(()=>{V();Xg();I();XF=t((i=w)=>[new Qy(new m((e,r)=>{i.emit("goody-hut:action-performed",e,r)}))],"getRules"),aE=XF});var eN,lE,mE=n(()=>{V();vs();eh();I();eN=t((i=Yr,e=w,r=()=>Math.random())=>[new dm(new m(o=>i.unregister(o))),new dm(new m((o,a)=>{let s=o.actions(a),p=s[Math.floor(s.length*r())];o.action(p)})),new dm(new m((o,a)=>{e.emit("goody-hut:discovered",o,a)}))],"getRules"),lE=eN});var sd,Hm,DR=n(()=>{M();sd=class extends x{};t(sd,"Distribution");Hm=sd});var tN,pE,uE=n(()=>{vs();B();DR();tN=t((i=Yr,e=()=>Math.random())=>[new Hm(new l(r=>r.isLand())),new Hm(new l(r=>r.getSurroundingArea(3).every(o=>i.getByTile(o)===null))),new Hm(new l(()=>e()<.05))],"getRules"),pE=tN});var rN,cE,yE=n(()=>{vs();gn();P();I();mg();rN=t((i=Yr,e=()=>Math.random(),r=d)=>[new ic(new m((o,a)=>{let s=[Br,Ar],p=s[Math.floor(s.length*e())];return new p(null,a.player(),a.tile(),r)}))],"getRules"),cE=rN});var iN,fE,dE=n(()=>{vs();B();I();Ut();iN=t((i=Yr)=>[new q(new l(e=>i.getByTile(e.tile())!==null),new m(e=>{i.getByTile(e.tile()).process(e)}))],"getRules"),fE=iN});var ld,As,md=n(()=>{M();ld=class extends x{};t(ld,"Built");As=ld});var oN,gE,hE=n(()=>{vs();P();md();I();th();DR();oN=t((i=Yr,e=d)=>[new As(new m(r=>{let o=e.get(Hm);r.forEach(a=>{o.every(s=>s.validate(a))&&i.register(new tf(a))})}))],"getRules"),gE=oN});var nN={};var RE=n(()=>{nE();sE();mE();uE();yE();P();dE();hE();d.register(...oE(),...aE(),...lE(),...pE(),...cE(),...fE(),...gE())});var vE=C(xE=>{"use strict";Object.defineProperty(xE,"__esModule",{value:!0});RE()});var aN={};var bE=n(()=>{dn();mf();gm.register(Ct,nt,Ht,at,ft)});var sN,CE,TE=n(()=>{on();dn();B();I();Ig();Jn();sN=t((i=pt)=>[new ht(new l(e=>!i.getByPlayer(e).is(Mi)),new m(e=>[new Qa(e,i.getByPlayer(e))]))],"getRules"),CE=sN});var lN,IE,wE=n(()=>{mf();on();P();_s();dn();I();Bl();nh();lN=t((i=gm,e=pt,r=d)=>[new li(new Fa,new m(o=>{let a=new yf(o,i,r);a.set(new Ht),e.register(a)}))],"getRules"),IE=lN});var mN,PE,BE=n(()=>{lr();dn();He();ih();B();mN=t((i=z)=>[new Ap(new l(e=>e===Ht)),...[[Ct,xt],[nt,no],[at,_r],[ft,Ai]].map(([e,r])=>new Ap(new l(o=>o===e),new l((o,a)=>i.getByPlayer(a).completed(r))))],"getRules"),PE=mN});var pN,AE,UE=n(()=>{V();Ji();oh();B();I();pN=t((i=w,e=ie)=>[new Up(new m((r,o)=>{i.emit("player:government:changed",r,o)})),new Up(new l(r=>{try{return e.getByPlayer(r),!0}catch(o){if(o instanceof TypeError&&o.message.match(/Wrong number of player worlds exist/))return!1;throw o}}),new m(r=>{e.getByPlayer(r).entries().forEach(a=>a.tile().clearYieldCache(r))}))],"getRules"),AE=pN});var uN={};var ME=n(()=>{P();TE();wE();BE();UE();d.register(...CE(),...IE(),...PE(),...AE())});var GE=C(EE=>{"use strict";Object.defineProperty(EE,"__esModule",{value:!0});bE();ME()});var pd,kE,DE=n(()=>{M();pd=class extends x{};t(pd,"TurnEnd");kE=pd});var cN,OE,YE=n(()=>{bp();V();P();DE();cN=t((i=ta,e=d,r=w)=>[["player:turn-end",o=>{i.unregister(o),e.process(kE,o);let[a]=i.entries();if(!a){r.emit("turn:end");return}r.emit("player:turn-start",a)}]],"getEvents"),OE=cN});var yN,SE,FE=n(()=>{Xs();V();P();Wp();yN=t((i=ko,e=w,r=d)=>[["player:turn-start",o=>{r.process(ca,o),i.getByPlayer(o).takeTurn().catch(s=>console.error(s)).finally(()=>{e.emit("player:turn-end",o)})}]],"getEvents"),SE=yN});var fN,NE,zE=n(()=>{bp();V();ts();fN=t((i=pi,e=ta,r=w)=>[["turn:start",()=>{e.register(...i.entries());let[o]=e.entries();r.emit("player:turn-start",o)}]],"getEvents"),NE=fN});var dN={};var LE=n(()=>{V();YE();FE();zE();[...OE(),...SE(),...NE()].forEach(([i,e])=>w.on(i,e))});var ud,Fn,_p=n(()=>{M();ud=class extends x{};t(ud,"Defeated");Fn=ud});var gN,WE,jE=n(()=>{tt();P();Ds();B();_p();I();gN=t((i=_,e=d)=>[new yr(new l((r,o,a)=>i.getByPlayer(a).filter(s=>s!==r).length===0),new m((r,o,a)=>{e.process(Fn,a,o)}))],"getRules"),WE=gN});var hN,_E,HE=n(()=>{tt();P();B();_p();Os();I();hN=t((i=_,e=d)=>[new fr(new l((r,o)=>i.getByPlayer(r.player()).filter(a=>a!==r).length===0),new m((r,o)=>e.process(Fn,r.player(),o)))],"getRules"),_E=hN});var OR,RN,KE,qE=n(()=>{Jn();B();I();Ac();Sa();OR=new ht(new Or(9001),new l(i=>{OR.disable();let e=i.mandatoryActions();return OR.enable(),e.length===0}),new m(i=>[new Bc(i,null)])),RN=t(()=>[OR],"getRules"),KE=RN});var xN,VE,$E=n(()=>{V();_s();I();xN=t((i=w)=>[new li(new m(e=>{i.emit("player:added",e)}))],"getRules"),VE=xN});var vN,JE,ZE=n(()=>{bp();V();ts();B();_p();I();vN=t((i=ta,e=pi,r=w)=>[new Fn(new l(o=>i.includes(o)),new m(o=>i.unregister(o))),new Fn(new l(o=>e.includes(o)),new m(o=>e.unregister(o))),new Fn(new m((o,a)=>{r.emit("player:defeated",o,a)}))],"getRules"),JE=vN});var bN,QE,XE=n(()=>{tt();P();Ke();I();Ks();Bl();Sm();em();oa();Wp();Zi();bN=t((i=d,e=_,r=N)=>[new ca(new Fa,new m(o=>{e.getByPlayer(o).forEach(a=>{let s=a.yields();na(s,Ho,ra,ia).reduce((p,u,y)=>(p[y].set(u,"Consolidated"),p),[new Ho(0,"Consolidated"),new ra(0,"Consolidated"),new ia(0,"Consolidated")]).forEach(p=>i.process(Oo,p,a,s))})})),new ca(new m(o=>r.getByPlayer(o).forEach(a=>{a.moves().set(a.movement());let s=a.busy();if(!s){a.setActive(),a.setWaiting(!1);return}!s.validate()||s.process()})))],"getRules"),QE=bN});var CN,e0,t0=n(()=>{V();I();Tg();CN=t((i=w)=>[new Sc(new m((e,r)=>{i.emit("player:visibility-changed",e,r)}))],"getRules"),e0=CN});var TN,r0,i0=n(()=>{ts();Ji();Ry();I();TN=t((i=pi,e=ie)=>[new aa(new m(r=>{r.clearYieldCache(null),i.forEach(o=>{e.getByPlayer(o).getByTile(r)!==null&&r.clearYieldCache(o)})}))],"getRules"),r0=TN});var IN,o0,n0=n(()=>{tt();P();B();_p();Vc();I();IN=t((i=_,e=d)=>[new Xn(new l((r,o)=>i.getByPlayer(r.player()).length===0),new m((r,o)=>e.process(Fn,r.player(),o)))],"getRules"),o0=IN});var wN,a0,s0=n(()=>{Ji();I();Ug();wN=t((i=ie)=>[new Jc(new m((e,r)=>{e.clearYieldCache(r);let o=i.getByPlayer(r);o.register(e),o.getByTile(e).update()}))],"getRules"),a0=wN});var PN,l0,m0=n(()=>{ER();Xs();V();ts();Ji();P();md();I();Ks();Pp();Uy();Nc();em();Vg();bR();oa();PN=t((i=Nf,e=ko,r=w,o=pi,a=ie,s=d,p=()=>Math.random())=>[new As(new m(u=>o.entries().forEach(y=>a.register(new Hl(y,u))))),new As(new m(u=>{console.log("Built1");let y=new Map,c=new Map,f=t((U,L=null)=>(y.has(U)||y.set(U,U.score(L,[[Ho,8],[ra,3],[ia,1]])),y.get(U)),"tileScore"),g=t((U,L=null)=>(c.has(U)||c.set(U,U.getSurroundingArea().entries().reduce((Re,Se)=>Re+f(Se,L),0)),c.get(U)),"areaScore");r.emit("world:generate-start-tiles");let G=r.option("players",5),k=[],D=u.entries().filter(U=>[sm,Ay,Vv].some(L=>U.terrain()instanceof L)).map(U=>({tile:U,score:g(U)})).sort(({score:U},{score:L})=>L-U).map(({tile:U})=>U);r.emit("world:start-tiles",D),e.entries().reduce((U,L)=>U.then(async()=>{let Re=L.player();await L.chooseCivilization(i.entries()),i.unregister(Re.civilization().sourceClass()),D.filter(Bt=>k.some(Ga=>Ga.distanceFrom(Bt)<=4)).forEach(Bt=>D.splice(D.indexOf(Bt),1));let Se=D[Math.floor(D.length*p())];if(!Se)throw new TypeError("Not enough `startingSquare`s.");k.push(Se),new CT(null,Re,Se,s),console.log("player "+L.player().id())}),Promise.resolve()).then(()=>r.emit("game:start"))})),new As(new m(u=>{r.emit("world:built",u)}))],"getRules"),l0=PN});var BN={};var p0=n(()=>{jE();HE();P();qE();$E();ZE();XE();t0();i0();n0();s0();m0();d.register(...WE(),..._E(),...KE(),...VE(),...JE(),...QE(),...e0(),...r0(),...o0(),...a0(),...l0())});var c0=C(u0=>{"use strict";Object.defineProperty(u0,"__esModule",{value:!0});LE();p0()});var AN={};var y0=n(()=>{lr();A();h.register(Ri,to,xi,Dn,ut,vi,ro,Fr,bi,nn,io,hr,Nr,xt,Ci,zr,Lr,oo,Ti,no,Rr,ct,an,sn,On,ao,pa,ln,yt,mn,vt,xr,Ii,pn,vr,Lt,Wr,Wt,jt,br,wi,jr,_r,_t,ar,Hr,so,Kr,Pi,un,cn,qr,yn,Bi,bt,Vr,lo,mo,po,uo,co,Ai,fn,yo,Ui,sr,Cr)});var f0=n(()=>{fg()});var UN,d0,g0=n(()=>{He();Jn();f0();B();I();UN=t((i=z)=>[new ht(new l(e=>i.getByPlayer(e).researching()===null),new l(e=>i.getByPlayer(e).available().length>0),new m(e=>[new zs(e,i.getByPlayer(e))]))],"getRules"),d0=UN});var MN,h0,R0=n(()=>{A();He();P();_s();I();bu();MN=t((i=h,e=z,r=d,o=()=>Math.random())=>[new li(new m(a=>e.register(new Ul(a,i,r)))),new li(new m(a=>{let s=e.getByPlayer(a);for(let p=0,u=Math.min(s.available().length,Math.floor(4*o()));p<u;p++){let y=s.available();s.addAdvance(y[Math.floor(o()*y.length)])}}))],"getRules"),h0=MN});var EN,x0,v0=n(()=>{He();Ds();I();B();EN=t((i=z,e=()=>Math.random())=>[new yr(new l((r,o,a)=>i.getByPlayer(a).complete().some(s=>!i.getByPlayer(o).completed(s.constructor))),new m((r,o,a)=>{let s=i.getByPlayer(o),p=i.getByPlayer(a).complete().filter(u=>!s.completed(u.constructor));s.addAdvance(p.map(u=>u.constructor)[Math.floor(e()*p.length)])}))],"getRules"),x0=EN});var GN,b0,C0=n(()=>{V();yu();I();GN=t((i=w)=>[new Na(new m((e,r)=>{i.emit("player:research-complete",e,r)}))],"getRules"),b0=GN});var kN,T0,I0=n(()=>{Qd();I();kN=t(()=>[new du(new m((i,e)=>(e.complete().length+1)*(6+2*0)))],"getRules"),T0=kN});var DN,w0,P0=n(()=>{Ym();He();P();B();I();Sm();wf();DN=t((i=z,e=d)=>[new Oo(new l(r=>r instanceof qt),new l((r,o,a)=>!e.get(Sn).some(s=>s.validate(o,a))),new m((r,o)=>i.getByPlayer(o.player()).add(r)))],"getRules"),w0=DN});var ON,B0,A0=n(()=>{lr();B();I();Xd();ON=t(()=>[...[[Ri,ao,Rr],[xi,br,_t],[Dn,yo,Pi],[ut,Nr,uo],[vi,Ai,Ui],[ro,Lr,Ii],[nn,sr,wi],[io,On,mn],[hr,to],[Nr,Bi,sn],[xt,Kr,vt],[Ci,ct,br],[zr,sn,Ai],[Lr,Ti,Wt],[oo,vi,vt],[Ti,Fr],[no,Kr,vr],[Rr,jr,Lt],[ct,an,Rr],[an,Lr,fn],[sn,yt,nn],[On,Wt,_r],[ao,Nr,Pi],[pa,so,co],[ln,oo,wi],[yt,xr,Ii],[vt,qr,vi],[xr,an,vr],[Ii,Fr],[pn,jt,xt],[vr,hr,Cr],[Lt,ar,Pi],[Wr,to],[jt,oo,ut],[br,to,Wt],[wi,Kr,Ui],[jr,yt,sr],[_r,hr,_t],[_t,bi],[ar,xi,Wr],[Hr,jt,Dn],[so,Hr,ct],[Kr,_t,vr],[Pi,ar,br],[un,Bi,mo],[qr,ro,po],[yn,no,jt],[Bi,oo,nn],[bt,Kr,Cr],[Vr,Ci,un],[lo,ct,Ri],[mo,Ci,lo],[po,xr,Pi],[uo,jr,vt],[co,jt,un],[Ai,hr,vr],[yo,xi,sr],[Ui,hr,Ti],[sr,Kr,br],[Cr,to]].map(([i,...e])=>new hu(new l(r=>r===i),new m((r,o)=>e.every(a=>o.some(s=>s instanceof a)))))],"getRules"),B0=ON});var YN,U0,M0=n(()=>{V();I();eg();YN=t((i=w)=>[new xu(new m((e,r)=>{i.emit("player:research",e,r)}))],"getRules"),U0=YN});var SN={};var E0=n(()=>{g0();R0();v0();C0();I0();P();P0();A0();M0();d.register(...d0(),...h0(),...x0(),...b0(),...T0(),...w0(),...B0(),...U0())});var k0=C(G0=>{"use strict";Object.defineProperty(G0,"__esModule",{value:!0});y0();E0()});var cd,Us,Hp=n(()=>{$e();cd=class extends W{};t(cd,"TradeRate");Us=cd});var Aa,D0=n(()=>{Lp();Hp();Aa=class extends Us{};t(Aa,"Luxuries"),Aa.tradeYield=xA});var Ua,O0=n(()=>{If();Hp();Ua=class extends Us{};t(Ua,"Research"),Ua.tradeYield=qt});var Ma,Y0=n(()=>{Ll();Hp();Ma=class extends Us{};t(Ma,"Tax"),Ma.tradeYield=tc});var YR=n(()=>{D0();O0();Y0()});var yd,Ms,Kp=n(()=>{Hi();Hp();yd=class extends De{constructor(){super(Us)}};t(yd,"AvailableTradeRateRegistry");Ms=new yd});var FN={};var S0=n(()=>{YR();Kp();Ms.register(Aa,Ua,Ma)});var F0=n(()=>{Cf();oa()});var fd,dd,SR=n(()=>{Z();fd=class extends Fe{#e=100;#t;#r=[];constructor(e,...r){super(),this.#t=e,this.#r=r,this.addKey("all")}all(){return[...this.#r]}balance(e){if(this.total()===1)return;let r=1-e.value(),o=this.#r.filter(s=>s!==e),a=o.reduce((s,p)=>s+p.value(),0);o.forEach(s=>s.set(s.value()/a*r)),this.total()<1&&o[Math.floor(o.length*Math.random())].add(1-this.total()),this.total()>1&&o[Math.floor(o.length*Math.random())].subtract(1-this.total())}get(e){let[r]=this.#r.filter(o=>o instanceof e);return r}player(){return this.#t}set(e,r){let o=this.get(e);o.set(r),this.balance(o)}setAll(e){if(e.reduce((r,[,o])=>r+o,0)!==1)throw new TypeError("Invalid rates provided, must sum to 1.");e.forEach(([r,o])=>this.get(r).set(o))}total(){return Math.round(this.#r.reduce((e,r)=>e+r.value(),0)*this.#e)/this.#e}};t(fd,"PlayerTradeRates");dd=fd});var gd,Es,qp=n(()=>{Ce();SR();gd=class extends O{constructor(){super(dd)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerTradeRates for player");return r[0]}};t(gd,"PlayerTradeRatesRegistry");Es=new gd});var NN,N0,z0=n(()=>{Kp();F0();qp();I();Sl();Zi();NN=t((i=Ms,e=Es)=>[new Yl(new m((r,o)=>{let a=e.getByPlayer(r.player()),s=Math.max(0,qe(o,se)),p=s;return i.entries().map(u=>{let y=u.tradeYield,c=Math.min(Math.ceil(s*a.get(u).value()),p);return p-=c,new y(c,u.name)})}))],"getRules"),N0=NN});var zN,L0,W0=n(()=>{qp();Jn();yg();I();zN=t((i=Es)=>[new ht(new m(e=>[new $a(e,i.getByPlayer(e))]))],"getRules"),L0=zN});var LN,j0,_0=n(()=>{Kp();qp();YR();_s();I();SR();LN=t((i=Ms,e=Es)=>[new li(new m(r=>{let o=[new Ma(.5),new Ua(.5),new Aa(0)],a=i.entries(),s=new dd(r,...a.map(p=>{let[u]=o.filter(y=>y instanceof p);return new p(u||0)}));e.register(s)}))],"getRules"),j0=LN});var hd,WN,H0,K0=n(()=>{Kp();tt();P();I();Bl();Sm();Wp();Zi();hd=[],WN=t((i=d,e=_,r=Ms)=>[new ca(new Fa,new m(o=>{hd.length===0&&r.entries().forEach(a=>hd.push(a.tradeYield)),e.getByPlayer(o).forEach(a=>{let s=a.yields();na(s,...hd).reduce((p,u,y)=>(p[y].set(u,"Consolidated"),p),hd.map(p=>new p)).forEach(p=>i.process(Oo,p,a,s))})}))],"getRules"),H0=WN});var jN={};var q0=n(()=>{P();z0();W0();_0();K0();d.register(...N0(),...L0(),...j0(),...H0())});var $0=C(V0=>{"use strict";Object.defineProperty(V0,"__esModule",{value:!0});S0();q0()});var _N,J0,Z0=n(()=>{Ae();B();I();sg();ea();_N=t(()=>[new Fs(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(we,i.building().item())),new l(i=>i.progress().value()===0),new m((i,e)=>{let r=i.remaining()/10;return e.add(Math.floor((r+4)*10*r)),e})),new Fs(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(we,i.building().item())),new l(i=>i.progress().value()>0),new m((i,e)=>{let r=i.remaining()/10;return e.add(Math.floor(5*r**2+20*r)),e})),new Fs(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(Y,i.building().item())),new l(i=>i.progress().value()===0),new m((i,e)=>(e.add(i.remaining()*4),e))),new Fs(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(Y,i.building().item())),new l(i=>i.progress().value()>0),new m((i,e)=>(e.add(i.remaining()*2),e)))],"getRules"),J0=_N});var HN,Q0,X0=n(()=>{tt();Jn();vg();I();HN=t((i=_)=>[new ht(new m(e=>i.getByPlayer(e).map(r=>new Ja(e,r))))],"getRules"),Q0=HN});var KN,eG,tG=n(()=>{Ns();_s();I();lg();KN=t((i=si)=>[new li(new m(e=>i.register(new Xu(e))))],"getRules"),eG=KN});var rG=n(()=>{UR();Ll()});var Rd,xd,FR=n(()=>{M();Rd=class extends x{};t(Rd,"Updated");xd=Rd});var qN,iG,oG=n(()=>{rG();cr();V();Ns();P();ag();Ym();B();I();Sm();FR();qN=t((i=si,e=d,r=he,o=w)=>[new Oo(new l(a=>a instanceof er),new m((a,s,p)=>{let u=i.getByPlayer(s.player());p.forEach(y=>{if(y instanceof pe){if(u.value()<y.value()){let c=y.cityImprovement(),f=new Hu(c.constructor,s,e);r.unregister(c),u.add(f.cost().value()),o.emit("city:unsupported-improvement",s,c);return}u.subtract(y.value(),s.name())}})})),new Oo(new l(a=>a instanceof er),new l((a,s,p)=>!e.get(Sn).some(u=>u.validate(s,p))),new m((a,s)=>{let p=i.getByPlayer(s.player());p.add(a,s.name()),e.process(xd,p,s)}))],"getRules"),iG=qN});var VN,nG,aG=n(()=>{V();B();I();FR();VN=t((i=w)=>[new xd(new l(e=>e.value()<0),new m((e,r)=>{i.emit("player:treasury-exhausted",e.player(),e,r)}))],"getRules"),nG=VN});var $N={};var sG=n(()=>{P();Z0();X0();tG();oG();aG();d.register(...J0(),...Q0(),...eG(),...iG(),...nG())});var mG=C(lG=>{"use strict";Object.defineProperty(lG,"__esModule",{value:!0});sG()});var JN={};var pG=n(()=>{gn();Fl();Cn.register(xo,vo,bo,Gi,Co,To,ki,Di,Io,wo,Xr,Oi,Br,Yi,Si,Po,Fi,Bo,Ao,Ni,je,zi,Uo,Ar,Mo,Eo,Ur,Go)});var vd,Km,NR=n(()=>{M();vd=class extends x{};t(vd,"Available");Km=vd});var bd,uG,zR,ZN,cG,yG=n(()=>{Bg();Gn();cm();gt();tt();Jo();kn();Zt();P();Vo();di();fm();ui();Ke();sa();Jd();NR();B();I();AR();gn();bd=new l((i,e,r=i.tile())=>i instanceof ot),uG=new l((i,e,r=i.tile())=>i instanceof We),zR=t((i,e)=>e.getByTile(i)!==null,"tileHasCity"),ZN=t((i=J,e=_,r=d,o=ze,a=nr,s=N,p=lt,u=Mn,y=Ue)=>[new At(Jl,$i,new Rn(new Ya(bd,new l((c,f,g=c.tile())=>g.isLand()),new l((c,f)=>f.isLand()),new l((c,f)=>s.getByTile(f).every(g=>g.player()===c.player()))),new Ya(uG,new Rn(new l((c,f,g=c.tile())=>g.isWater()),new l((c,f,g=c.tile())=>e.getByTile(g)?.player()===c.player())),new Rn(new l((c,f)=>f.isWater()),new l((c,f)=>e.getByTile(f)?.player()===c.player()))),new l(c=>c instanceof Ft)),new Rn(new l((c,f)=>!(c instanceof ot)),new l((c,f,g=c.tile())=>!(g.getNeighbours().some(G=>s.getByTile(G).some(k=>k instanceof ot&&k.tile().terrain()instanceof j&&k.player()!==c.player()))&&f.getNeighbours().some(G=>s.getByTile(G).some(k=>k instanceof ot&&k.tile().terrain()instanceof j&&k.player()!==c.player())))),new l((c,f)=>s.getByTile(f).filter(g=>g.player()===c.player()).length>0),new l((c,f)=>{let g=e.getByTile(f);return g===null?!1:g.player()===c.player()})),new l((c,f)=>{let g=e.getByTile(f);return g===null?!0:g.player()===c.player()}),new l((c,f)=>!s.getByTile(f).some(g=>g.player()!==c.player())),new m((c,f,g=c.tile())=>new Yt(g,f,c,r))),new At(Jl,$i,new Rn(new l(c=>c instanceof Ft),new Ya(bd,new l((c,f)=>f.isLand())),new Ya(uG,new Rn(new l((c,f)=>f.isWater()),new Ya(new l((c,f)=>s.getByTile(f).some(g=>g.player()!==c.player())))))),new l((c,f)=>s.getByTile(f).some(g=>g.player()!==c.player())),new m((c,f,g=c.tile())=>new as(g,f,c,r,s))),new At(Jl,$i,bd,new l((c,f)=>zR(f,e)),new l((c,f)=>s.getByTile(f).length===0),new l((c,f)=>e.getByTile(f).player()!==c.player()),new m((c,f,g=c.tile())=>{let G=e.getByTile(f);return new nm(g,f,c,G,r)})),new At($i,Zn,new l(c=>c instanceof F),new l((c,f)=>o.getByTile(f).filter(g=>[Be,Ze,or,Ye].some(G=>g instanceof G)).length>0),new m((c,f,g=c.tile())=>new hs(g,f,c,r,o,y))),new At($i,Zn,new l(c=>c instanceof F),new l((c,f,g=c.tile())=>g.isLand()),new m((c,f,g=c.tile())=>new gs(g,f,c,r,y,a))),new At($i,Zn,new m((c,f,g=c.tile())=>new la(g,f,c,r,y))),new At(Zn,new m((c,f,g=c.tile())=>new Xi(g,f,c,r))),new At($i,Zn,new l(c=>c instanceof je),new l((c,f,g=c.tile())=>g.isLand()),new l((c,f,g=c.tile())=>!zR(g,e)),new m((c,f,g=c.tile())=>new pm(g,f,c,i,r))),...[[Be,ss,new Rn(new l((c,f,g=c.tile())=>g.terrain()instanceof oe),new l((c,f,g=c.tile())=>g.getAdjacent().some(G=>G.terrain()instanceof oe||G.terrain()instanceof Jt||o.getByTile(G).some(k=>k instanceof Be)&&!zR(G,e))))],[Ze,ls],[Ye,ms],[or,ps,new l((c,f)=>o.getByTile(f).some(g=>g instanceof Ye))]].map(([c,f,...g])=>new At(new l(G=>G instanceof gr),$i,new l((G,k,D=G.tile())=>r.get(Km).some(U=>U.validate(D,c,G.player()))),Zn,...g,new m((G,k,D=G.tile())=>new f(D,k,G,r,y)))),...[[rt,ys],[Ve,us],[me,Rs],[it,fs]].map(([c,f])=>new At($i,Zn,new l(g=>g instanceof gr),new l((g,G,k=g.tile())=>k.terrain()instanceof c),new m((g,G,k=g.tile())=>new f(k,G,g,r,p,y)))),new At(Jl,$i,bd,new l((c,f)=>f.terrain()instanceof Jt),new l((c,f)=>s.getByTile(f).every(g=>g.player()===c.player())),new l((c,f)=>s.getByTile(f).filter(g=>g instanceof zt).some(g=>g.hasCapacity()&&g.canStow(c))),new m((c,f,g=c.tile())=>{let[G]=s.getByTile(f).filter(k=>k instanceof zt).filter(k=>k.hasCapacity()&&k.canStow(c));return new lm(g,f,c,G,r)})),new At(Jl,new l(c=>{try{return u.getByUnit(c),!0}catch{return!1}}),new Rn(new l((c,f)=>!(c instanceof ot)),new l((c,f)=>f.isLand())),new l((c,f,g=c.tile())=>u.getByUnit(c).transport().tile()===g),new m((c,f,g=c.tile())=>{let G=u.getByUnit(c).transport();return new ds(g,f,c,G,r)})),new At($i,Zn,new l(c=>c instanceof zt),new l(c=>c.hasCargo()),new l((c,f)=>f.getNeighbours().some(g=>g.isLand())),new m((c,f,g=c.tile())=>new um(g,f,c,r)))],"getRules"),cG=ZN});var QN,fG,dG=n(()=>{sa();Ag();B();I();Mp();QN=t((i=nr)=>[new Zl(new l(e=>e.moves().value()>0),new m(e=>e.setActive())),new Zl(new l(e=>e.busy()!==null),new m(e=>e.setBusy())),...[fi].map(e=>new Zl(new l(r=>i.getByUnit(r).some(o=>o instanceof e)),new m(r=>i.unregister(...i.getByUnit(r).filter(o=>o instanceof e)))))],"getRules"),fG=QN});var XN,gG,hG=n(()=>{lr();Xm();gn();He();B();I();Gn();XN=t((i=z)=>[new Qt(new l((e,r)=>Object.prototype.isPrototypeOf.call(We,r)),new m(e=>new l(()=>e.tile().isCoast()))),...[[xo,Vr],[vo,uo],[bo,Ri],[Gi,jr],[To,Ri],[Co,Ui],[ki,br],[Di,fn],[Io,Nr],[wo,Cr],[Xr,ao],[Oi,Lt],[Br,mn],[Yi,po],[Si,io],[Po,pn],[Fi,yt],[Bo,lo],[Ao,zr],[Ni,ar],[zi,Fr],[Uo,jt],[Ar,Ii],[Mo,ut],[Eo,vt],[Ur,Wr]].map(([e,r])=>new Qt(new l((o,a)=>a===e),new m(o=>new l(()=>i.getByPlayer(o.player()).completed(r))))),...[[Gi,Vr],[ki,jr],[Di,io],[Oi,vt],[Br,zr],[Yi,Nr],[Si,ut],[Fi,zr],[Ni,Lt],[zi,yt],[Ar,zr],[Ur,ar],[Go,yt]].map(([e,r])=>new Qt(new l((o,a)=>a===e),new m(o=>new l(()=>!i.getByPlayer(o.player()).completed(r)))))],"getRules"),gG=XN});var ez,RG,xG=n(()=>{tp();gn();ez=t(()=>[...[[xo,80],[vo,160],[bo,120],[Gi,40],[Co,50],[To,160],[ki,40],[Di,40],[Io,80],[wo,30],[Xr,60],[Oi,40],[Br,20],[Yi,50],[Si,40],[Po,50],[Fi,30],[Bo,160],[Ao,30],[Ni,40],[je,40],[zi,20],[Uo,50],[Ar,20],[Mo,80],[Eo,50],[Ur,40],[Go,10]].flatMap(([i,e])=>Nl(i,e))],"getRules"),RG=ez});var tz,vG,bG=n(()=>{ir();rp();B();I();gn();tz=t((i=ce)=>[new Vn(new l((e,r)=>r instanceof je),new m(e=>i.getByCity(e.city()).shrink()))],"getRules"),vG=tz});var rz,CG,TG=n(()=>{V();Ke();Kc();I();rz=t((i=N,e=w)=>[new Qn(new m(r=>i.register(r))),new Qn(new m(r=>r.applyVisibility())),new Qn(new m(r=>r.moves().set(r.movement()))),new Qn(new m(r=>{e.emit("unit:created",r)}))],"getRules"),CG=rz});var iz,IG,wG=n(()=>{V();Ke();Cp();I();iz=t((i=N,e=w)=>[new Ko(new m(r=>{r.setDestroyed(),i.unregister(r)})),new Ko(new m((r,o)=>{e.emit("unit:defeated",r,o)}))],"getRules"),IG=iz});var oz,PG,BG=n(()=>{V();sa();Ke();Vc();I();oz=t((i=N,e=nr,r=w)=>[new Xn(new m((o,a)=>{r.emit("unit:destroyed",o,a)})),new Xn(new m(o=>i.unregister(o))),new Xn(new m(o=>{o.setActive(!1),o.setDestroyed()})),new Xn(new m(o=>e.getByUnit(o).forEach(a=>e.unregister(a))))],"getRules"),PG=oz});var Cd,qm,LR=n(()=>{M();Cd=class extends x{};t(Cd,"LostAtSea");qm=Cd});var nz,AG,UG=n(()=>{V();I();LR();nz=t((i=w)=>[new qm(new m(e=>{i.emit("unit:lost-at-sea",e)})),new qm(new m(e=>e.destroy(null)))],"getRules"),AG=nz});var az,MG,EG=n(()=>{cm();V();P();fm();B();I();LR();Ut();Gn();gn();tt();az=t((i=Mn,e=d,r=()=>Math.random(),o=w,a=_)=>[new q(new m((s,p)=>{o.emit("unit:moved",s,p)})),new q(new m(s=>s.applyVisibility())),new q(new l(s=>s.moves().value()<=.1),new m(s=>s.moves().set(0))),new q(new l(s=>s.moves().value()<.1),new m(s=>s.setActive(!1))),new q(new l(s=>s instanceof zt),new l((s,p)=>p instanceof Yt),new l(s=>s.hasCargo()),new m((s,p)=>s.cargo().forEach(u=>u.action(p.forUnit(u))))),new q(new l((s,p)=>p instanceof ds),new m(s=>{let p=i.getByUnit(s);p.transport().unload(s),i.unregister(p)})),new q(new l(s=>s instanceof Ur),new l(s=>s.moves().value()===0),new l(s=>!s.tile().isCoast()),new l(()=>r()<=.5),new m(s=>{e.process(qm,s)})),new q(new l(s=>s instanceof Xr),new l(s=>s.moves().value()===0),new l(s=>a.getByTile(s.tile())!==null),new m(s=>{e.process(qm,s)}))],"getRules"),MG=az});var GG,sz,kG,DG=n(()=>{Jo();Gn();cm();kn();di();fm();B();I();ci();GG=[[St,2],[Ie,1],[Ve,2],[be,1],[Me,2],[rt,2],[Le,3],[mt,1],[me,1],[oe,1],[it,2],[Rt,1]],sz=t((i=ze,e=Mn)=>[...GG.map(([r,o])=>new ve(new l((a,s)=>s instanceof Yt),new l(a=>a instanceof ot),new l((a,s)=>s.to().terrain()instanceof r),new m(()=>o))),new ve(new l((r,o)=>o instanceof Yt),new l(r=>r instanceof Ft||r instanceof We),new m(()=>1)),new ve(new l((r,o)=>o instanceof Yt),new l(r=>r instanceof ot),new l((r,o)=>i.getByTile(o.from()).some(a=>a instanceof Ye)),new l((r,o)=>i.getByTile(o.to()).some(a=>a instanceof Ye)),new m(()=>1/3)),new ve(new l((r,o)=>o instanceof Yt),new l(r=>r instanceof ot),new l((r,o)=>i.getByTile(o.from()).some(a=>a instanceof or)),new l((r,o)=>i.getByTile(o.to()).some(a=>a instanceof or)),new m(()=>0)),new ve(new l((r,o)=>o instanceof Yt),new l(r=>r instanceof ot),new l(r=>{try{return e.getByUnit(r),!0}catch{return!1}}),new l(r=>e.getByUnit(r).transport()instanceof zt),new m(()=>0)),...[[ss,2],[ls,3],[ms,1],[ps,2],[us,2],[ys,3],[fs,3],[gs,1],[hs,1],[Rs,3],[la,0]].flatMap(([r,o])=>GG.map(([a,s])=>new ve(new l((p,u)=>u instanceof r),new l(p=>p.tile().terrain()instanceof a),new m(()=>o*s))))],"getRules"),kG=sz});var lz,OG,YG=n(()=>{Vd();Ke();Jn();B();I();lz=t((i=N)=>[new ht(new l(e=>i.getByPlayer(e).some(r=>r.active()&&r.moves().value())),new m(e=>i.getByPlayer(e).filter(r=>r.active()&&r.moves().value()>0).sort((r,o)=>(r.waiting()?1:0)-(o.waiting()?1:0)).map(r=>new Da(e,r)))),new ht(new l(e=>i.getByPlayer(e).some(r=>!r.active()||!r.moves().value())),new m(e=>i.getByPlayer(e).filter(r=>!r.active()||r.moves().value()===0).sort((r,o)=>(r.waiting()?1:0)-(o.waiting()?1:0)).map(r=>new Oa(e,r))))],"getRules"),OG=lz});var mz,SG,FG=n(()=>{I();qg();Jg();mz=t(()=>[new Vy(new m(i=>i.action(new zv(i.tile(),i.tile(),i))))],"getRules"),SG=mz});var pz,NG,zG=n(()=>{$l();gn();Mp();P();sa();Ql();Ql();B();I();pz=t((i=nr,e=d)=>[...[[xo,12,2,2],[vo,18,12,4,2],[bo,12,1,8,2],[Gi,8],[Co,0],[To,1,12,5,2],[ki,6],[Di,4,1,2],[Io,6,6,6,2],[wo,0,0,2],[Xr,4,2,10,2],[Oi,2,2,3],[Br,2,1,2],[Yi,4,4,4],[Si,4,2,2],[Po,6,6,3],[Fi,3,2],[Bo,99,0,16],[Ao,3,5],[Ni,1,1,3],[je,0],[zi,1,2],[Uo,8,2,3,2],[Ar,3],[Mo,10,5,3],[Eo,0,3,4],[Ur,1,0,3],[Go]].flatMap(([r,o=1,a=1,s=1,p=1])=>Nx(r,o,a,s,p)),...[[fi,1,mi],[ma,.5,qi,mi]].flatMap(([r,o,...a])=>a.map(s=>new Hs(new l((p,u)=>u instanceof s),new l(p=>i.getByUnit(p).some(u=>u instanceof r)),new m((p,u)=>{let y=new s;e.process(es,p.constructor,y),u.add(y.value()*o,r.name)}))))],"getRules"),NG=pz});var uz,LG,WG=n(()=>{V();I();Sf();uz=t((i=w)=>[new bl(new m((e,r)=>{i.emit("unit:unsupported",e,r)}))],"getRules"),LG=uz});var cz,jG,_G=n(()=>{B();I();Wg();cz=t((i=()=>Math.random())=>[new Tp(new l((e,r)=>e.moves().value()>=r),new m((e,r)=>(e.moves().subtract(r),!0))),new Tp(new l((e,r)=>e.moves().value()<r),new m((e,r)=>{let o=e.moves().value();return e.moves().set(0),o>=r*.5*i()}))],"getRules"),jG=cz});var yz={};var HG=n(()=>{yG();dG();hG();xG();bG();TG();wG();BG();P();UG();EG();DG();YG();FG();zG();WG();_G();d.register(...cG(),...fG(),...gG(),...RG(),...vG(),...CG(),...IG(),...PG(),...AG(),...MG(),...kG(),...OG(),...SG(),...NG(),...LG(),...jG())});var qG=C(KG=>{"use strict";Object.defineProperty(KG,"__esModule",{value:!0});pG();HG()});var Nn,VG=n(()=>{Pe();Nn=class extends ge{};t(Nn,"ApolloProgram")});var Mr,$G=n(()=>{Pe();Mr=class extends xe{};t(Mr,"Colossus")});var ti,JG=n(()=>{Pe();ti=class extends xe{};t(ti,"CopernicusObservatory")});var Yo,ZG=n(()=>{Pe();Yo=class extends ge{};t(Yo,"CureForCancer")});var zn,QG=n(()=>{Pe();zn=class extends ge{};t(zn,"DarwinsVoyage")});var Er,XG=n(()=>{Pe();Er=class extends xe{};t(Er,"GreatLibrary")});var So,ek=n(()=>{Pe();So=class extends xe{};t(So,"GreatWall")});var ri,tk=n(()=>{Pe();ri=class extends xe{};t(ri,"HangingGardens")});var Ln,rk=n(()=>{Pe();Ln=class extends ge{};t(Ln,"HooverDam")});var Fo,ik=n(()=>{Pe();Fo=class extends ge{};t(Fo,"IsaacNewtonsCollege")});var Wi,ok=n(()=>{Pe();Wi=class extends ge{};t(Wi,"JsBachsCathedral")});var ii,nk=n(()=>{Pe();ii=class extends ge{};t(ii,"Lighthouse")});var No,ak=n(()=>{Pe();No=class extends xe{};t(No,"MagellansExpedition")});var Wn,sk=n(()=>{Pe();Wn=class extends ge{};t(Wn,"ManhattanProject")});var Gr,lk=n(()=>{Pe();Gr=class extends ge{};t(Gr,"MichelangelosChapel")});var Vt,mk=n(()=>{Pe();Vt=class extends xe{};t(Vt,"Oracle")});var zo,pk=n(()=>{Pe();zo=class extends xe{};t(zo,"Pyramids")});var Lo,uk=n(()=>{Pe();Lo=class extends ge{};t(Lo,"SetiProgram")});var kr,ck=n(()=>{Pe();kr=class extends ge{};t(kr,"ShakespearesTheatre")});var jn,yk=n(()=>{Pe();jn=class extends ge{};t(jn,"UnitedNations")});var ji,fk=n(()=>{Pe();ji=class extends ge{};t(ji,"WomensSuffrage")});var Ea=n(()=>{VG();$G();JG();ZG();QG();XG();ek();tk();rk();ik();ok();nk();ak();sk();lk();mk();pk();uk();ck();yk();fk()});var fz={};var dk=n(()=>{Ea();Fl();Cn.register(Nn,Mr,ti,Yo,zn,Er,So,ri,Ln,Fo,Wi,ii,No,Wn,Gr,Vt,zo,Lo,kr,jn,ji)});var Td,Pt,_n=n(()=>{Ce();Pe();Td=class extends O{constructor(){super(xe)}getByCity(e){return this.getBy("city",e)}getByPlayer(e){return this.filter(r=>r.city().player()===e)}};t(Td,"WonderRegistry");Pt=new Td});var dz,gk,hk=n(()=>{Ea();lr();Xm();He();_n();B();I();Pe();dz=t((i=z,e=Pt)=>[new Qt(new l((r,o)=>Object.isPrototypeOf.call(xe,o)),new m((r,o)=>new l(()=>e.filter(a=>a instanceof o).length===0))),...[[Mr,Fr],[ti,xi],[Er,vr],[So,Wt],[ri,cn],[ii,Wr],[No,ar],[Vt,bi],[zo,Wt],[Nn,mo],[Yo,ln],[zn,qr],[Ln,ct],[Fo,yo],[Wi,bt],[Wn,Hr],[Gr,bt],[Lo,Ci],[kr,wi],[jn,xt],[ji,vt]].map(([r,o])=>new Qt(new l((a,s)=>s===r),new m(a=>new l(()=>i.getByPlayer(a.player()).completed(o)))))],"getRules"),gk=dz});var gz,Rk,xk=n(()=>{Ea();tp();gz=t(()=>[...[[Nn,600],[Mr,200],[ti,300],[Yo,600],[zn,300],[Er,300],[So,300],[ri,300],[Ln,600],[Fo,400],[Wi,400],[ii,200],[No,400],[Wn,600],[Gr,300],[Vt,300],[zo,300],[Lo,600],[kr,400],[jn,600],[ji,600]].flatMap(([i,e])=>Nl(i,e))],"getRules"),Rk=gz});var hz,vk,bk=n(()=>{$n();V();_n();rp();B();I();Pe();hz=t((i=Xt,e=Pt,r=w)=>[new Vn(new l((o,a)=>a instanceof xe),new m((o,a)=>{let s=a.constructor;e.register(a),i.filter(p=>p.building()?.item()===s).forEach(p=>p.revalidate())})),new Vn(new l((o,a)=>a instanceof xe),new m((o,a)=>{r.emit("wonder:built",a,o.city())}))],"getRules"),vk=hz});var Vm,_i,Vp=n(()=>{_n();B();Vm=t((i,e=Pt)=>new l(r=>e.getByCity(r).some(o=>o instanceof i)),"cityHasWonder"),_i=t((i,e=Pt)=>new l(r=>e.getByPlayer(r.player()).some(o=>o instanceof i)),"playerHasWonder")});var Ck,xn,Id,$p=n(()=>{He();B();Ck=t((i,e=z)=>new l(r=>e.getByPlayer(r.player()).completed(i)),"discoveredByPlayer"),xn=t((i,e=z)=>new l(()=>i===null||!e.some(r=>r.completed(i))),"notDiscoveredByAnyPlayer"),Id=t((i,e=z)=>new l(r=>i===null||!e.getByPlayer(r.player()).completed(i)),"notDiscoveredByPlayer")});var wd,Tk=n(()=>{cr();B();wd=t((i,e=he)=>new l(r=>e.getByCity(r).some(o=>o instanceof i)),"hasCityImprovement")});var Rz,Ik,wk=n(()=>{Ei();cr();lr();Ea();on();He();Ke();_n();Vp();$p();Gl();B();I();Kn();Om();Sa();Bs();Tk();Zi();Rz=t((i=he,e=pt,r=z,o=N,a=Pt)=>[new Xe(new Qe,_i(Vt,a),wd(Mt,i),Id(_t,r),xn(bt,r),new m((s,p)=>new Ee(-Math.min(1,qe(p,Ee)),Vt.name))),new Xe(new Qe,_i(Vt,a),wd(Mt,i),Ck(_t,r),xn(bt,r),new m((s,p)=>new Ee(-Math.min(2,qe(p,Ee)),Vt.name))),new Xe(new Or(4e3),Vm(kr,a),xn(ct,r),new m((s,p)=>new Ee(-qe(p,Ee),kr.name))),new Xe(new Qe,_i(Wi,a),new m((s,p)=>new Ee(-Math.min(2,qe(p,Ee)),Wi.name))),new Xe(new Qe,_i(Gr,a),wd(pr,i),xn(xt,r),new m((s,p)=>new Ee(-Math.min(4,qe(p,Ee)),Gr.name))),new Xe(new Qe,_i(ji,a),new l((s,p)=>p.some(u=>u instanceof ua)),new m((s,p)=>p.flatMap(u=>u instanceof ua?new Ee(-1,ji.name):[])))],"getRules"),Ik=Rz});var xz,Pk,Bk=n(()=>{_n();Os();B();I();xz=t((i=Pt)=>[new fr(new l(e=>i.getByCity(e).length>0),new m(e=>i.getByCity(e).forEach(r=>i.unregister(r))))],"getRules"),Pk=xz});var vz,Ak,Uk=n(()=>{Ea();lr();Bs();He();_n();Vp();Sl();I();Sa();$p();vz=t((i=z,e=Pt)=>[new jo(new Or(500),Vm(Mr,e),xn(Rr,i),new m(r=>new se(r.tilesWorked().filter(o=>o.yields().some(a=>a instanceof se)).length,Mr.name))),...[[ri,1,xr],[Yo,1,null]].map(([r,o,a])=>new jo(_i(r,e),xn(a,i),new m(()=>new Do(o,r.name))))],"getRules"),Ak=vz});var bz,Mk,Ek=n(()=>{Ea();He();_n();Vp();lr();I();Kn();Bs();Su();$p();Zi();bz=t((i=z,e=Pt)=>[...[[ti,qt,1,ut]].map(([r,o,a,s])=>new Ys(new Qe,Vm(r,e),xn(s,i),new m((p,u)=>new o(qe(u,o)*a,r.name)))),...[[Lo,qt,.5,null]].map(([r,o,a,s])=>new Ys(new Qe,_i(r,e),xn(s,i),new m((p,u)=>new o(qe(u,o)*a,r.name))))],"getRules"),Mk=bz});var Pd,Bd,WR=n(()=>{M();Pd=class extends x{};t(Pd,"Obsolete");Bd=Pd});var Cz,Gk,kk=n(()=>{lr();Ea();He();P();_n();yu();B();I();WR();Cz=t((i=z,e=d,r=Pt)=>[new Na(new l(()=>r.some(o=>o instanceof Er)),new l((o,a)=>{let[s]=r.filter(u=>u instanceof Er).map(u=>u.city().player());return!i.getByPlayer(s).completed(a.sourceClass())}),new l((o,a)=>i.filter(s=>s.completed(a.sourceClass())).length>=3),new m((o,a)=>{let[s]=r.filter(u=>u instanceof Er).map(u=>u.city().player());return i.getByPlayer(s).addAdvance(a.sourceClass())})),...[[Mr,Rr],[ti,ut],[Er,sr],[So,yt],[ri,xr],[Fo,Hr],[ii,Lt],[Gr,xt],[Vt,bt],[zo,xt],[kr,ct]].map(([o,a])=>new Na(new l(()=>r.entries().some(s=>s instanceof o)),new l((s,p)=>p instanceof a),new m(()=>{let[s]=r.filter(p=>p instanceof o);e.process(Bd,s,s.city())})))],"getRules"),Gk=Cz});var Tz,Dk,Ok=n(()=>{Ea();He();_n();B();I();Kn();lr();$l();Gn();Ql();$p();Vp();Tz=t((i=Pt,e=z)=>[new cp(new Qe,new l((r,o)=>o instanceof Vi),new l(r=>r instanceof We),_i(ii,i),Id(Lt,e),new m((r,o)=>o.add(1))),new cp(new Qe,new l((r,o)=>o instanceof Vi),new l(r=>r instanceof We),_i(No,i),new m((r,o)=>o.add(1)))],"getRules"),Dk=Tz});var Iz,Yk,Sk=n(()=>{V();I();WR();Iz=t((i=w)=>[new Bd(new m((e,r)=>{i.emit("wonder:obsolete",e,r)}))],"getRules"),Yk=Iz});var wz={};var Fk=n(()=>{hk();xk();bk();wk();Bk();Uk();Ek();P();kk();Ok();Sk();d.register(...gk(),...Rk(),...vk(),...Ik(),...Pk(),...Ak(),...Mk(),...Gk(),...Dk(),...Yk())});var zk=C(Nk=>{"use strict";Object.defineProperty(Nk,"__esModule",{value:!0});dk();Fk()});var Pz,Lk,Wk=n(()=>{Jo();kn();He();lr();di();NR();B();Pz=t((i=z,e=ze)=>[...[[Be,Ie,be,Me,me,oe],[Ze,Ie,Me,Le],[Ye,St,Ie,Ve,be,Me,rt,Le,me,it,Rt]].map(([r,...o])=>new Km(new l((a,s)=>s===r),new l(a=>o.some(s=>a.terrain()instanceof s)),new l((a,s)=>!e.getByTile(a).some(p=>p instanceof s)))),...[[Ye,ro,oe]].map(([r,o,...a])=>new Km(new l((s,p)=>p===r),new l(s=>a.some(p=>s.terrain()instanceof p)),new l((s,p)=>!e.getByTile(s).some(u=>u instanceof p)),new l((s,p,u)=>i.getByPlayer(u).completed(o)))),...[[or,qr,Ye,St,Ie,Ve,be,Me,rt,Le,me,oe,it,Rt]].map(([r,o,a,...s])=>new Km(new l((p,u)=>u===r),new l(p=>s.some(u=>p.terrain()instanceof u)),new l((p,u)=>!e.getByTile(p).some(y=>y instanceof u)),new l(p=>e.getByTile(p).some(u=>u instanceof a)),new l((p,u,y)=>i.getByPlayer(y).completed(o))))],"getRules"),Lk=Pz});var Bz,jk,_k=n(()=>{V();kn();di();Ry();B();I();Bz=t((i=ze,e=w)=>[new aa(new l((r,o)=>i.getByTile(r).every(a=>o.constructor!==a.constructor)),new m((r,o)=>i.register(o))),new aa(new m(r=>r.clearYieldCache(null))),new aa(new m((r,o)=>{e.emit("tile-improvement:built",r,o)})),...[[Ze,Be],[Be,Ze]].map(([r,o])=>new aa(new l((a,s)=>s instanceof r),new l(a=>i.getByTile(a).some(s=>s instanceof o)),new m(a=>i.unregister(...i.getByTile(a).filter(s=>s instanceof o)))))],"getRules"),jk=Bz});var Ad,Ud,jR=n(()=>{Hi();yi();Ad=class extends De{constructor(){super(Ne)}};t(Ad,"AvailableTerrainFeatureRegistry");Ud=new Ad});var Az,Hk,Kk=n(()=>{jR();P();tg();I();am();Az=t((i=d,e=Ud)=>[new Uu(new m(r=>{let o=i.get(cs);e.entries().forEach(a=>o.filter(s=>s.validate(a,r)).forEach(s=>s.process(a,r)))}))],"getRules"),Hk=Az});var Et,_R=n(()=>{M();Et=class extends x{};t(Et,"Distribution")});var Uz,qk,Vk=n(()=>{Jo();_R();Zt();B();I();Uz=t(()=>[new Et(new l(i=>i===St),new l((i,e)=>e.some(r=>r instanceof j)),new m(()=>[{from:0,to:.01,fill:!0},{from:.01,to:.02},{from:.98,to:.99},{from:.99,to:1,fill:!0}])),new Et(new l(i=>i===Ie),new l((i,e)=>e.some(r=>r instanceof j)),new m(()=>[{from:.4,to:.45},{from:.45,to:.55,coverage:.025,cluster:!0,clusterChance:.1},{from:.55,to:.6}])),new Et(new l(i=>i===Ve),new l((i,e)=>e.some(r=>r instanceof j)),new m(()=>[{from:.05,to:.2},{from:.2,to:.4,cluster:!0,clusterChance:.1,coverage:.1},{from:.4,to:.6},{from:.6,to:.8,cluster:!0,clusterChance:.1,coverage:.1},{from:.8,to:.95}])),new Et(new l(i=>i===be),new l((i,e)=>e.some(r=>r instanceof j)),new m(()=>[{fill:!0}])),new Et(new l(i=>i===Me),new l((i,e)=>e.some(r=>r instanceof j)),new m(()=>[{from:.1,to:.9,path:!0,pathChance:.1,coverage:.06}])),new Et(new l(i=>i===rt),new l((i,e)=>e.some(r=>r instanceof j)),new m(()=>[{from:.3,to:.45,cluster:!0,clusterChance:.2,coverage:.08},{from:.55,to:.7,cluster:!0,clusterChance:.2,coverage:.08}])),new Et(new l(i=>i===Le),new l((i,e)=>e.some(r=>r instanceof j)),new m(()=>[{from:.01,to:.1,coverage:.3,path:!0},{from:.1,to:.9,path:!0},{from:.9,to:.99,coverage:.3,path:!0}])),new Et(new l(i=>i===mt),new l((i,e)=>e.some(r=>r.constructor===Jt)),new m(()=>[{fill:!0}])),new Et(new l(i=>i===me),new l((i,e)=>e.some(r=>r instanceof j)),new m(()=>[{from:.01,to:.2,coverage:.3},{from:.2,to:.4},{from:.1,to:.4,cluster:!0},{from:.4,to:.6},{from:.6,to:.8},{from:.6,to:.9,cluster:!0},{from:.8,to:.99,coverage:.3}])),new Et(new l(i=>i===oe),new l((i,e)=>e.some(r=>r instanceof j)),new m(()=>[{from:.1,to:.9,coverage:.1,path:!0,pathChance:.5}])),new Et(new l(i=>i===it),new l((i,e)=>e.some(r=>r instanceof j)),new m(()=>[{from:.2,to:.4,cluster:!0},{from:.6,to:.8,cluster:!0}])),new Et(new l(i=>i===Rt),new l((i,e)=>e.some(r=>r instanceof j)),new m(()=>[{from:.01,to:.15,cluster:!0,coverage:.15},{from:.85,to:.99,cluster:!0,coverage:.15}]))],"getRules"),qk=Uz});var Md,Ed,HR=n(()=>{M();Md=class extends x{};t(Md,"DistributionGroups");Ed=Md});var Mz,$k,Jk=n(()=>{Jo();I();HR();Mz=t(()=>[new Ed(new m(()=>[mt,be,it,Le,rt,Me,Ve,Ie,me,Rt,St,oe]))],"getRules"),$k=Mz});var Ez,Zk,Qk=n(()=>{Jo();Bp();Vo();am();Ez=t((i=lt)=>[...[[Zo,.2,Me],[Qo,.2,mt],[gi,.2,Ve,Rt],[Xo,.2,rt],[en,.2,Le],[eo,.2,me],[hi,.2,Ie],[tn,.2,it],[rn,.2,St],[$o,.5,be,oe]].flatMap(([r,o,...a])=>a.flatMap(s=>hv(s,r,o,i)))],"getRules"),Zk=Ez});var Gd,kd,Xk=n(()=>{M();Gd=class extends x{};t(Gd,"Pillaged");kd=Gd});var Gz,eD,tD=n(()=>{V();di();Xk();B();I();Gz=t((i=ze,e=w)=>[new kd(new l((r,o)=>i.getByTile(r).includes(o)),new m((r,o)=>i.unregister(o))),new kd(new m(r=>r.clearYieldCache(null))),new kd(new m((r,o)=>{e.emit("tile-improvement:pillaged",r,o)}))],"getRules"),eD=Gz});var kz,vn,KR=n(()=>{kz=t((i,e,r,o)=>{for(;r<0;)r+=e;for(;o<0;)o+=i;return r=r%e,o=o%i,o*e+r},"coordsToIndex"),vn=kz});var Dz,Tl,Dd=n(()=>{Dz=t((i,e,r)=>{let o=i*e;for(;r<0;)r+=o;return r=r%o,[r%e,Math.floor(r/e)]},"indexToCoords"),Tl=Dz});var Oz,rD,iD=n(()=>{Dd();Oz=t((i,e,r,o)=>{let[a,s]=Tl(i,e,r),[p,u]=Tl(i,e,o),y=[[-1,1],[-1,0],[-1,-1],[0,1],[0,0],[0,-1],[1,1],[1,0],[1,-1]],[c]=y.map(([f,g])=>[f*e,g*i]).map(([f,g])=>[a-p+f,s-u+g]).map(f=>Math.hypot(...f)).sort((f,g)=>f-g);return c},"distanceFrom"),rD=Oz});var Yz,Il,qR=n(()=>{KR();Dd();Yz=t((i,e,r,o=!0)=>{let[a,s]=Tl(i,e,r),p=vn(i,e,a,s-1),u=vn(i,e,a+1,s-1),y=vn(i,e,a+1,s),c=vn(i,e,a+1,s),f=vn(i,e,a,s+1),g=vn(i,e,a-1,s+1),G=vn(i,e,a-1,s),k=vn(i,e,a-1,s-1);return o?[p,y,f,G]:[p,u,y,c,f,g,G,k]},"getNeighbours"),Il=Yz});var $m,oD,VR=n(()=>{KR();iD();qR();Dd();$m=class{#e;#t;#r;constructor(e,r,o={}){this.#e=e,this.#t=o,this.#r=r}coordsToIndex(e,r){return vn(this.#e,this.#r,e,r)}distanceFrom(e,r){return rD(this.#e,this.#r,e,r)}generate(){throw new Error(`Generator#generate(): Must be overridden in '${this.constructor.name}'.`)}getNeighbours(e,r=!0){return Il(this.#e,this.#r,e,r)}height(){return this.#e}indexToCoords(e){return Tl(this.#e,this.#r,e)}options(){return this.#t}width(){return this.#r}};t($m,"Generator");oD=$m});var Od,Yd,$R=n(()=>{VR();Hi();Od=class extends De{constructor(){super(oD)}};t(Od,"GeneratorRegistry");Yd=new Od});var Sd,Fd,JR=n(()=>{M();Sd=class extends x{};t(Sd,"Start");Fd=Sd});var Nd,nD,aD=n(()=>{Z();P();md();Ce();Ki();Nd=class extends S{#e;#t;#r;#i=new Zp(ue);#o;constructor(e,r=d){super(),this.#e=e,this.#t=e.height(),this.#o=e.width(),this.#r=r,this.addKey("height","tiles","width")}build(){return new Promise(e=>{this.#e.generate().then(r=>{r.forEach((o,a)=>{let s=new ue(a%this.#o,Math.floor(a/this.#o),o,this,this.#r);this.#i.register(s)}),this.#r.process(As,this),e(this)})})}entries(){return this.#i.entries()}filter(e){return this.entries().filter(e)}forEach(e){return this.#i.forEach(e)}get(e,r){return this.entries()[this.#e.coordsToIndex(e,r)]}height(){return this.#t}includes(e){return this.#i.includes(e)}map(e){return this.#i.map(e)}register(...e){this.#i.register(...e)}tiles(){return this.entries()}width(){return this.#o}};t(Nd,"World");nD=Nd});var Sz,sD,lD=n(()=>{$R();P();V();I();JR();aD();Sz=t((i=d,e=Yd,r=w,o=()=>Math.random())=>[new Fd(new m(()=>{let a=e.entries(),s=a[Math.floor(a.length*o())],p=new s(parseInt(r.option("height",100),10),parseInt(r.option("width",160),10),{landCoverage:parseFloat(r.option("landCoverage",.4)),landSize:parseFloat(r.option("landSize",.2)),maxIterations:parseInt(r.option("maxIterations",20),10)});new nD(p,i).build()}))],"getRules"),sD=Sz});var Fz,mD,pD=n(()=>{Bp();Jo();is();kn();dn();on();Vo();di();B();I();og();Fz=t((i=ze,e=lt,r=pt)=>[...[[$,Ve,1],[$,be,2],[$,Me,1],[$,rt,1],[$,mt,1],[$,me,1],[$,oe,2],[$,it,1],[$,Rt,1],[K,Ie,1],[K,Ve,2],[K,Le,1],[K,me,1]].map(([o,a,s])=>new ai(new l(p=>p.terrain()instanceof a),new m(()=>new o(s,a.name)))),...[[K,Zo,2],[$,Qo,1],[$,gi,1],[se,Xo,2],[se,en,3],[K,eo,1],[$,hi,2],[K,tn,3],[$,rn,2],[K,$o,1]].map(([o,a,s])=>new ai(new l(p=>e.getByTerrain(p.terrain()).some(u=>u instanceof a)),new m(()=>new o(s,a.name)))),...[[K,Zo,1],[$,Qo,1],[$,gi,1],[se,Xo,2],[se,en,2],[K,eo,1],[$,hi,1],[K,tn,1],[$,rn,1]].map(([o,a,s])=>new ai(new l((p,u)=>{if(!u)return!1;try{return r.getByPlayer(u).is(Ct,nt,at,ft)}catch{return!1}}),new l(p=>e.getByTerrain(p.terrain()).some(u=>u instanceof a)),new m(()=>new o(s,a.name)))),new ai(new l(o=>o.terrain()instanceof mt),new m(()=>new se(2,mt.name))),new ai(new l(o=>o.terrain()instanceof oe),new m(()=>new se(1))),new ai(new l((o,a)=>{if(!a)return!1;try{return r.getByPlayer(a).is(nt,ft)}catch{return!1}}),new l(o=>o.terrain()instanceof oe||o.terrain()instanceof mt),new m(()=>new se(1,mt.name))),...[[Ie,$,Be,1],[Ie,K,Ze,1],[Me,$,Be,1],[Me,K,Ze,2],[Le,K,Ze,1],[me,$,Be,1]].map(([o,a,s,p])=>new ai(new l(u=>u.terrain()instanceof o),new l(u=>i.getByTile(u).some(y=>y instanceof s)),new m(()=>new a(p,s.name)))),...[[Ie,K,Ze,1],[be,$,Be,1],[Me,K,Ze,1],[Le,K,Ze,1],[oe,$,Be,1]].map(([o,a,s,p])=>new ai(new l((u,y)=>{if(!y)return!1;try{return r.getByPlayer(y).is(Ct,nt,at,ft)}catch{return!1}}),new l(u=>u.terrain()instanceof o),new l(u=>i.getByTile(u).some(y=>y instanceof s)),new m(()=>new a(p,s.name)))),...[Ie,be,me].map(o=>new ai(new l(a=>a.terrain()instanceof o),new l(a=>i.getByTile(a).some(s=>s instanceof Ye)),new m(()=>new se(1,Ye.name)))),...[Ie,be,me].map(o=>new ai(new l((a,s)=>{if(!s)return!1;try{return r.getByPlayer(s).is(nt,ft)}catch{return!1}}),new l(a=>a.terrain()instanceof o),new l(a=>i.getByTile(a).some(s=>s instanceof Ye)),new m(()=>new se(1,Ye.name))))],"getRules"),mD=Fz});var Nz,uD,cD=n(()=>{is();di();B();I();Kn();kn();ig();Nz=t((i=ze)=>[...[[$,.5],[K,.5],[se,.5]].map(([e,r])=>new Gu(new Hn,new l((o,a,s)=>s.some(p=>p instanceof e)),new l(o=>i.getByTile(o).some(a=>a instanceof or)),new m((o,a,s)=>{let p=s.filter(u=>u instanceof e).reduce((u,y)=>u+y.value(),0);s.push(new e(Math.floor(p*r),or.name))})))],"getRules"),uD=Nz});var zz={};var yD=n(()=>{Wk();_k();Kk();Vk();Jk();Qk();P();tD();lD();pD();cD();d.register(...Lk(),...jk(),...Hk(),...qk(),...$k(),...Zk(),...eD(),...sD(),...mD(),...uD())});var zd,Ld,ZR=n(()=>{Hi();kl();zd=class extends De{constructor(){super(bn)}};t(zd,"TerrainRegistry");Ld=new zd});var Lz={};var fD=n(()=>{Jo();ZR();Ld.register(St,Ie,Ve,be,Me,rt,Le,mt,me,oe,it,Rt)});var Wz={};var dD=n(()=>{Bp();jR();Ud.register(Zo,Qo,gi,Xo,en,eo,hi,tn,rn,$o)});var hD=C(gD=>{"use strict";Object.defineProperty(gD,"__esModule",{value:!0});yD();fD();dD()});var jz,RD,xD=n(()=>{$n();$t();qn();jz=t((i=Xt)=>[new te(et,"build",e=>i.getByCity(e))],"getAdditionalData"),RD=jz});var _z={};var vD=n(()=>{kt();xD();re.register(...RD())});var CD=C(bD=>{"use strict";Object.defineProperty(bD,"__esModule",{value:!0});vD()});var Hz,TD,ID=n(()=>{ir();$t();qn();Hz=t((i=ce)=>[new te(et,"growth",e=>i.getByCity(e))],"getAdditionalData"),TD=Hz});var Kz={};var wD=n(()=>{kt();ID();re.register(...TD())});var BD=C(PD=>{"use strict";Object.defineProperty(PD,"__esModule",{value:!0});wD()});var qz,AD,UD=n(()=>{cr();$t();qn();qz=t((i=he)=>[new te(et,"improvements",e=>i.getByCity(e))],"getAdditionalData"),AD=qz});var Vz={};var MD=n(()=>{kt();UD();re.register(...AD())});var GD=C(ED=>{"use strict";Object.defineProperty(ED,"__esModule",{value:!0});MD()});var $z,kD,DD=n(()=>{tt();$t();_o();Ki();$z=t((i=_)=>[new te(H,"cities",e=>i.getByPlayer(e)),new te(ue,"city",e=>i.getByTile(e))],"getAdditionalData"),kD=$z});var Jz={};var OD=n(()=>{kt();DD();re.register(...kD())});var SD=C(YD=>{"use strict";Object.defineProperty(YD,"__esModule",{value:!0});OD()});var Zz,FD,ND=n(()=>{vs();$t();Ki();Zz=t((i=Yr)=>[new te(ue,"goodyHut",e=>i.getByTile(e))],"getAdditionalData"),FD=Zz});var Qz={};var zD=n(()=>{kt();ND();re.register(...FD())});var WD=C(LD=>{"use strict";Object.defineProperty(LD,"__esModule",{value:!0});zD()});var Xz,jD,_D=n(()=>{on();$t();_o();Xz=t((i=pt)=>[new te(H,"government",e=>i.getByPlayer(e))],"getAdditionalData"),jD=Xz});var eL={};var HD=n(()=>{_D();kt();re.register(...jD())});var qD=C(KD=>{"use strict";Object.defineProperty(KD,"__esModule",{value:!0});HD()});var tL,VD,$D=n(()=>{Ji();$t();_o();tL=t((i=ie)=>[new te(H,"world",e=>i.getByPlayer(e))],"getAdditionalData"),VD=tL});var rL={};var JD=n(()=>{kt();$D();re.register(...VD())});var QD=C(ZD=>{"use strict";Object.defineProperty(ZD,"__esModule",{value:!0});JD()});var iL,XD,eO=n(()=>{He();$t();_o();iL=t((i=z)=>[new te(H,"research",e=>i.getByPlayer(e))],"getAdditionalData"),XD=iL});var oL={};var tO=n(()=>{kt();eO();re.register(...XD())});var iO=C(rO=>{"use strict";Object.defineProperty(rO,"__esModule",{value:!0});tO()});var nL,oO,nO=n(()=>{Vo();$t();kl();nL=t((i=lt)=>[new te(bn,"features",e=>i.getByTerrain(e))],"getAdditionalData"),oO=nL});var aL={};var aO=n(()=>{kt();nO();re.register(...oO())});var lO=C(sO=>{"use strict";Object.defineProperty(sO,"__esModule",{value:!0});aO()});var sL,mO,pO=n(()=>{di();$t();Ki();sL=t((i=ze)=>[new te(ue,"improvements",e=>i.getByTile(e))],"getAdditionalData"),mO=sL});var lL={};var uO=n(()=>{kt();pO();re.register(...mO())});var yO=C(cO=>{"use strict";Object.defineProperty(cO,"__esModule",{value:!0});uO()});var mL,fO,dO=n(()=>{qp();$t();_o();mL=t((i=Es)=>[new te(H,"rates",e=>i.getByPlayer(e))],"getAdditionalData"),fO=mL});var pL={};var gO=n(()=>{kt();dO();re.register(...fO())});var RO=C(hO=>{"use strict";Object.defineProperty(hO,"__esModule",{value:!0});gO()});var uL,xO,vO=n(()=>{Ns();$t();_o();uL=t((i=si)=>[new te(H,"treasury",e=>i.getByPlayer(e))],"getAdditionalData"),xO=uL});var cL={};var bO=n(()=>{kt();vO();re.register(...xO())});var TO=C(CO=>{"use strict";Object.defineProperty(CO,"__esModule",{value:!0});bO()});var Wd,IO,wO=n(()=>{M();Wd=class extends x{};t(Wd,"End");IO=Wd});var jd,PO,BO=n(()=>{M();jd=class extends x{};t(jd,"Start");PO=jd});var yL,AO,UO=n(()=>{V();P();ui();wO();JR();BO();yL=t((i=d,e=w,r=Ue)=>[["engine:start",()=>{i.process(Fd)}],...["game:start","turn:end"].map(o=>[o,()=>{e.emit("turn:start",r.increment())}]),["turn:end",()=>{i.process(IO,r)}],["turn:start",()=>{i.process(PO,r)}]],"getEvents"),AO=yL});var fL={};var MO=n(()=>{V();UO();[...AO()].forEach(([i,e])=>{w.on(i,e)})});var GO=C(EO=>{"use strict";Object.defineProperty(EO,"__esModule",{value:!0});MO()});var dL,kO,DO=n(()=>{sa();$t();ea();dL=t((i=nr)=>[new te(we,"improvements",e=>i.getByUnit(e))],"getAdditionalData"),kO=dL});var gL={};var OO=n(()=>{kt();DO();re.register(...kO())});var SO=C(YO=>{"use strict";Object.defineProperty(YO,"__esModule",{value:!0});OO()});var hL,FO,NO=n(()=>{Ke();$t();qn();_o();Ki();hL=t((i=N)=>[new te(et,"units",e=>i.getByCity(e)),new te(H,"units",e=>i.getByPlayer(e)),new te(ue,"units",e=>i.getByTile(e))],"getAdditionalData"),FO=hL});var RL={};var zO=n(()=>{kt();NO();re.register(...FO())});var WO=C(LO=>{"use strict";Object.defineProperty(LO,"__esModule",{value:!0});zO()});var _d,jO,_O=n(()=>{Hi();ah();_d=class extends De{constructor(){super(gf)}};t(_d,"AIClientRegistry");jO=new _d});var xL={};var HO=n(()=>{_O();hm();jO.register(Yn)});var vL,KO,qO=n(()=>{Xs();Ke();Ds();B();I();hm();vL=t((i=N,e=ko)=>[new yr(new l((r,o)=>e.getByPlayer(o)instanceof Yn),new m((r,o,a)=>e.getByPlayer(o).cityLost(r,a,!1)))],"getRules"),KO=vL});var bL,VO,$O=n(()=>{Xs();Ke();B();Os();I();hm();bL=t((i=N,e=ko)=>[new fr(new l(r=>e.getByPlayer(r.player())instanceof Yn),new m((r,o)=>e.getByPlayer(r.player()).cityLost(r,o,!0)))],"getRules"),VO=bL});var CL,JO,ZO=n(()=>{Xs();Ke();B();Cp();I();hm();CL=t((i=N,e=ko)=>[new Ko(new l(r=>e.getByPlayer(r.player())instanceof Yn),new m((r,o)=>e.getByPlayer(r.player()).unitDestroyed(r,o&&o.player())))],"getRules"),JO=CL});var TL={};var QO=n(()=>{P();qO();$O();ZO();d.register(...KO(),...JO(),...VO())});var eY=C(XO=>{"use strict";Object.defineProperty(XO,"__esModule",{value:!0});HO();QO()});var Hd,tY,rY=n(()=>{_R();VR();Zt();P();ZR();HR();qR();Hd=class extends $m{#e;#t;#r;#i;#o;#a;#n;#l;#s;#m;constructor(e=100,r=160,o={},a=d,s=Ld,p=()=>Math.random()){super(e,r);let{landCoverage:u=.4,landSize:y=.2,maxIterations:c=10,clusterChance:f=.05,coverage:g=.25,pathChance:G=.05}=o;this.#e=u,this.#t=y,this.#r=c,this.#i=f,this.#o=g,this.#a=G,this.#s=a,this.#m=s,this.#l=p,this.#n=new Array(this.height()*this.width()).fill(0).map(()=>new Jt)}async generateIslands(){let e=this.height(),r=this.width(),o=this.#t+this.#l()*.2,a=this.#e,s=this.#r,p=Math.ceil(e*r/100*o),u=new Array(e*r).fill(0);for(;u.length===0||u.filter(y=>y===1).length/u.length<a;){let y={},c=[],f=[],g=Math.floor(e*r*Math.random()),G=t(k=>{k in y||(y[k]=0),y[k]++},"flagAsSeen");for(u[g]=1,c.push(g),G(g),f.push(...Il(e,r,g));f.length;){let k=f.shift();if((y[k]||0)<=s&&(Math.random()>.3?(u[k]=1,c.push(k),Il(e,r,k).filter(D=>f.indexOf(D)===-1).forEach(D=>f.push(D))):Il(e,r,k).forEach(D=>{let U=f.indexOf(D);U>-1&&f.splice(U,1)}),G(k)),c.length>p||u.filter(D=>D===1).length/u.length>=a)break}if(u.filter(k=>k===1).length/u.length>=a)break}this.#n=u.map(y=>y===1?new j:new Jt)}generate(){return this.generateIslands().then(()=>this.populateTerrain().then(()=>this.#n))}getNeighbours(e,r=!0){return Il(this.height(),this.width(),e,r)}populateTerrain(){return new Promise(e=>{let r=this.#s.get(Et);this.#s.get(Ed).filter(o=>o.validate()).map(o=>{let a=o.process();if(!a)throw new TypeError("Unexpected data from DistributionGroups.");return a}).forEach(o=>o.forEach(a=>r.filter(s=>s.validate(a,this.#n)).map(s=>{let p=s.process(a,this.#n);if(!p)throw new TypeError("Unexpected data from Distribution.");return p}).forEach(s=>s.forEach(({cluster:p=!1,clusterChance:u=this.#i,coverage:y=this.#o,fill:c=!1,from:f=0,path:g=!1,pathChance:G=this.#a,to:k=1})=>{let D=Object.keys(this.#n).map(L=>parseInt(L,10)).filter(L=>this.#n[L]instanceof a.__proto__).filter(L=>L>=f*this.height()*this.width()&&L<=k*this.height()*this.width());if(c){D.forEach(L=>{this.#n[L]=new a});return}let U=D.length*y;for(;U>0;){let L=D[Math.floor(this.#l()*D.length)];if(this.#n[L]=new a,U--,p){let Re=this.getNeighbours(L).filter(Se=>!(this.#n[Se]instanceof a));for(;Re.length&&U>0;){let Se=Re.shift();u>=this.#l()/this.distanceFrom(L,Se)&&(this.#n[Se]=new a,U--,Re.push(...this.getNeighbours(Se).filter(Bt=>!(this.#n[Bt]instanceof a)).filter(Bt=>this.#n[Bt]instanceof a.__proto__).filter(Bt=>!Re.includes(Bt))))}}if(g){let Re=L;for(;G>=this.#l();){let Se=this.getNeighbours(Re).filter(Bt=>this.#n[Bt]instanceof a.__proto__&&!(this.#n[Bt]instanceof a));Re=Se[Math.floor(this.#l()*Se.length)],this.#n[Re]=new a,U--}}}})))),e()})}};t(Hd,"BaseGenerator");tY=Hd});var IL={};var iY=n(()=>{rY();$R();Yd.register(tY)});var nY=C(oY=>{"use strict";Object.defineProperty(oY,"__esModule",{value:!0});iY()});var wL={};var V1e,$1e,J1e,Z1e,Q1e,X1e,eWe,tWe,rWe,iWe,oWe,nWe,aWe,sWe,lWe,mWe,pWe,uWe,cWe,yWe,fWe,dWe,gWe,hWe,RWe,xWe,vWe,bWe,CWe,TWe,IWe,wWe,PWe,BWe,AWe,UWe,MWe,EWe,GWe,kWe,DWe,OWe,YWe,SWe,FWe,NWe,zWe,LWe,WWe,jWe,_We,HWe,KWe,qWe,VWe,$We,JWe,ZWe,QWe,XWe,eje,tje,rje,ije,oje,nje,aje,sje,lje,mje,pje,uje,cje,yje,fje,dje,gje,hje,Rje,xje,vje,bje,Cje,Tje,Ije,wje,Pje,Bje,Aje,Uje,Mje,Eje,Gje,kje,Dje,Oje,Yje,Sje,Fje,Nje,zje,Lje,Wje,jje,_je,Hje,Kje,qje,Vje,$je,Jje,Zje,Qje,aY=n(()=>{"use strict";V1e=T(kT()),$1e=T(ST()),J1e=T(LT()),Z1e=T(HT()),Q1e=T($T()),X1e=T(XT()),eWe=T(iI()),tWe=T(sI()),rWe=T(uI()),iWe=T(dI()),oWe=T(xI()),nWe=T(TI()),aWe=T(BI()),sWe=T(EI()),lWe=T(DI()),mWe=T(SI()),pWe=T(zI()),uWe=T(jI()),cWe=T(KI()),yWe=T($I()),fWe=T(QI()),dWe=T(tw()),gWe=T(ow()),hWe=T(sw()),RWe=T(pw()),xWe=T(yw()),vWe=T(gw()),bWe=T(xw()),CWe=T(Cw()),TWe=T(ww()),IWe=T(Aw()),wWe=T(Ew()),PWe=T(Dw()),BWe=T(Sw()),AWe=T(zw()),UWe=T(jw()),MWe=T(Kw()),EWe=T($w()),GWe=T(Qw()),kWe=T(tP()),DWe=T(oP()),OWe=T(sP()),YWe=T(pP()),SWe=T(yP()),FWe=T(gP()),NWe=T(xP()),zWe=T(CP()),LWe=T(wP()),WWe=T(AP()),jWe=T(EP()),_We=T(DP()),HWe=T(SP()),KWe=T(zP()),qWe=T(jP()),VWe=T(KP()),$We=T($P()),JWe=T(QP()),ZWe=T(tB()),QWe=T(oB()),XWe=T(sB()),eje=T(pB()),tje=T(yB()),rje=T(gB()),ije=T(xB()),oje=T(CB()),nje=T(wB()),aje=T(AB()),sje=T(EB()),lje=T(DB()),mje=T(SB()),pje=T(zB()),uje=T(jB()),cje=T(KB()),yje=T($B()),fje=T(QB()),dje=T(tA()),gje=T(oA()),hje=T(sA()),Rje=T(pA()),xje=T(yA()),vje=T(gA()),bje=T(FA()),Cje=T(lU()),Tje=T(LU()),Ije=T(jM()),wje=T(QM()),Pje=T(iE()),Bje=T(vE()),Aje=T(GE()),Uje=T(c0()),Mje=T(k0()),Eje=T($0()),Gje=T(mG()),kje=T(qG()),Dje=T(zk()),Oje=T(hD()),Yje=T(CD()),Sje=T(BD()),Fje=T(GD()),Nje=T(SD()),zje=T(WD()),Lje=T(qD()),Wje=T(QD()),jje=T(iO()),_je=T(lO()),Hje=T(yO()),Kje=T(RO()),qje=T(TO()),Vje=T(GO()),$je=T(SO()),Jje=T(WO()),Zje=T(eY()),Qje=T(nY())});Vd();pg();ug();oc();Wl();var op=class extends qa{#e;#t;constructor(e,r=In,o=()=>Math.random()){super(e),this.#e=r,this.#t=o}chooseCivilization(e){let r=e[Math.floor(e.length*this.#t())],o=this.player(),a=new r;o.setCivilization(a),this.chooseLeader(a)}chooseLeader(e){let r=this.#e.getByCivilization(e.constructor),o=r[Math.floor(r.length*this.#t())];e.setLeader(new o)}};t(op,"Client");yg();dr();fg();qn();xc();Ae();Ot();vg();Z();var Za,Pc=class{constructor(){ye(this,Za,[])}add(e,r,o=null){b(this,Za).push({[e]:{type:"add",index:o,value:r}})}clear(){b(this,Za).splice(0)}remove(e,r=null){b(this,Za).push({[e]:{type:"remove",index:r}})}transferData(){return b(this,Za).slice(0).map(e=>{let r={};return Object.entries(e).forEach(([o,{type:a,index:s,value:p}])=>{r[o]={type:a,index:s,value:typeof p=="function"?p():p}}),r})}update(e,r,o=null){b(this,Za).push({[e]:{type:"update",index:o,value:r}})}};t(Pc,"DataQueue"),Za=new WeakMap;var wx=Pc;Ac();Gs();_o();Cg();Nc();var zc=class extends Error{constructor(r,o,a){super(r);this.handler=o;this.attempts=a}};t(zc,"RetryFailed");var Ex=zc;var sp,lp,Kl,mp,ql,pp,up,Lc=class{constructor(e,r=5,o=100){ye(this,sp,0);ye(this,lp,void 0);ye(this,Kl,void 0);ye(this,mp,void 0);ye(this,ql,void 0);ye(this,pp,void 0);ye(this,up,void 0);ke(this,Kl,e),ke(this,mp,r),ke(this,ql,setInterval(()=>this.run(),o)),ke(this,lp,new Promise((a,s)=>{ke(this,up,a),ke(this,pp,s)}))}run(){if(++ex(this,sp)._>b(this,mp)){clearInterval(b(this,ql)),b(this,pp).call(this,new Ex("Retry failed.",b(this,Kl),b(this,sp)));return}b(this,Kl).call(this)&&(clearInterval(b(this,ql)),b(this,up).call(this))}then(){return b(this,lp)}};t(Lc,"Retryable"),sp=new WeakMap,lp=new WeakMap,Kl=new WeakMap,mp=new WeakMap,ql=new WeakMap,pp=new WeakMap,up=new WeakMap;var Gx=Lc;Ig();Z();var Wc=class extends Fe{constructor(e){super(),Object.assign(this,e),this.addKey(...Object.keys(e))}};t(Wc,"TransferObject");var jc=Wc;Ki();ea();Z();ir();var yp,fp,dp,gp,Mg=class extends Fe{constructor(r,o,a,s){super();ye(this,yp,void 0);ye(this,fp,void 0);ye(this,dp,{size:0});ye(this,gp,void 0);ke(this,yp,r),ke(this,fp,a),b(this,dp).size=s,ke(this,gp,o),this.addKey("_","growth","name","player","tile")}static fromCity(r){let o=ce.getByCity(r);return new Mg(r.name(),r.tile(),r.player(),o.size())}_(){return"City"}name(){return b(this,yp)}player(){return b(this,fp)}growth(){return b(this,dp)}tile(){return b(this,gp)}},Xc=Mg;t(Xc,"City"),yp=new WeakMap,fp=new WeakMap,dp=new WeakMap,gp=new WeakMap;var zx=Xc;Z();var hp,Eg=class extends Fe{constructor(r){super();ye(this,hp,void 0);ke(this,hp,r),this.addKey("_","civilization")}static fromPlayer(r){return new Eg(r.civilization())}_(){return"Player"}civilization(){return b(this,hp)}},ey=Eg;t(ey,"Player"),hp=new WeakMap;var Lx=ey;Z();var Rp,xp,vp,Gg=class extends Fe{constructor(r,o,a){super();ye(this,Rp,void 0);ye(this,xp,void 0);ye(this,vp,void 0);ke(this,Rp,r),ke(this,xp,o),ke(this,vp,a),this.addKey("_","tile","player")}static fromUnit(r){return new Gg(r.constructor.name,r.tile(),r.player())}_(){return b(this,Rp)}player(){return b(this,vp)}tile(){return b(this,xp)}},ty=Gg;t(ty,"Unit"),Rp=new WeakMap,xp=new WeakMap,vp=new WeakMap;var Wx=ty;Pe();A();tt();bp();V();Wl();ts();He();Ns();Ji();ui();Ke();Z();P();ui();Dg();var py=class extends S{#e=new Map;#t;#r;constructor(e=Ue,r=d){super(),this.#t=r,this.#r=e,this.addKey("value")}value(e=this.#r.value()){if(!this.#e.has(e)){let[o]=this.#t.process(rs,e);this.#e.set(e,o)}let r=this.#e.get(e);if(typeof r!="number")throw new TypeError("Invalid cache result.");return r}};t(py,"Year");var uy=new py;tm();kg();var Kx=t(i=>i instanceof Fe?{"#ref":i.id()}:i,"referenceObject"),Oe=t((...i)=>e=>i.some(r=>e instanceof r)?Kx(e):e,"filterToReference"),Hx=t((...i)=>e=>i.some(r=>e instanceof r)?e:Kx(e),"filterToReferenceAllExcept"),Og=new Map,Yg=new Map,Sg=new Map,le,X,qs,ns,Bn,rm,cy=class extends op{constructor(r,o,a){super(r);ye(this,le,t((r=o=>o)=>o=>o instanceof H&&o!==this.player()?(Og.has(o)||Og.set(o,Lx.fromPlayer(o)),Og.get(o)):o instanceof we&&o.player()!==this.player()?(Yg.has(o)||Yg.set(o,Wx.fromUnit(o)),Yg.get(o)):o instanceof et&&o.player()!==this.player()?(Sg.has(o)||Sg.set(o,zx.fromCity(o)),Sg.get(o)):o instanceof ue?ie.getByPlayer(this.player()).get(o.x(),o.y()):o instanceof Te?{_:o.constructor.name}:r(o),"#dataFilter"));ye(this,X,new wx);ye(this,qs,void 0);ye(this,ns,void 0);ye(this,Bn,void 0);ye(this,rm,!1);ke(this,qs,new oy),ke(this,Bn,o),ke(this,ns,a),b(this,ns).call(this,"action",(...s)=>{b(this,qs).emit("action",...s)}),b(this,ns).call(this,"cheat",({name:s,value:p})=>{if(s==="RevealMap"){let u=ie.getByPlayer(this.player()),[y]=u.entries();y.tile().map().entries().forEach(c=>{if(u.includes(c))return;u.register(c);let f=u.getByTile(c);b(this,X).add(u.id(),()=>c.toPlainObject(b(this,le).call(this)),`entries[${u.entries().indexOf(f)}]`)})}if(s==="GrantAdvance"){let[u]=h.filter(c=>c.name===p),y=z.getByPlayer(this.player());if(!u||y.completed(u))return;y.addAdvance(u),b(this,X).add(y.id(),y.toPlainObject(b(this,le).call(this,Oe(H))))}if(s==="GrantGold"){let u=si.getByPlayer(this.player());u.add(p),b(this,X).add(u.id(),u.toPlainObject(b(this,le).call(this,Oe(H))))}if(s==="ModifyUnit"){let{unitId:u,properties:y}=p,[c]=N.getBy("id",u);if(!c)return;["attack","defence","moves","movement","visibility"].forEach(f=>{f in y&&c[f]().set(y[f])}),b(this,X).add(c.id(),c.toPlainObject(b(this,le).call(this,Oe(H))))}this.sendPatchData()}),w.on("engine:plugins:load:failed",(s,p)=>{console.log(s+" failed to load"),console.error(p)}),w.on("player:visibility-changed",(s,p)=>{if(p!==this.player())return;let u=ie.getByPlayer(this.player()),y=u.getByTile(s);if(y===null){console.log("using a Retryable"),new Gx(()=>{let c=u.getByTile(s);return c===null?!1:(b(this,X).add(u.id(),()=>s.toPlainObject(b(this,le).call(this,Oe(H))),`tiles[${u.entries().indexOf(c)}]`),!0)},2,20);return}b(this,X).add(u.id(),()=>y.toPlainObject(b(this,le).call(this,Oe(H))),`tiles[${u.entries().indexOf(y)}]`)}),["unit:created","unit:defeated"].forEach(s=>{w.on(s,p=>{let u=ie.getByPlayer(this.player()),y=u.getByTile(p.tile());if(!!y&&(b(this,X).update(y.id(),()=>y.toPlainObject(b(this,le).call(this,Oe(H)))),p.player()===this.player())){if(s==="unit:created"){let c=N.getByPlayer(this.player()),f=c.indexOf(p),g=N.getByCity(p.city()),G=g.indexOf(p),k=N.getByTile(p.tile()),D=k.indexOf(p);b(this,X).add(r.id(),()=>p.toPlainObject(b(this,le).call(this,Oe(ue,H,_l,et))),`units[${f}]`),b(this,X).add(y.id(),()=>p.toPlainObject(b(this,le).call(this,Oe(we))),`units[${D}]`),p.city()!==null&&b(this,X).add(p.city().id(),()=>p.toPlainObject(b(this,le).call(this,Oe(we))),`units[${G}]`);return}b(this,X).update(this.player().id(),()=>this.player().toPlainObject(b(this,le).call(this,Hx(H,we))))}})}),["unit:destroyed"].forEach(s=>{w.on(s,(p,u)=>{p.player()===this.player()&&p.city()!==null&&b(this,X).update(p.city().id(),()=>p.city().toPlainObject(b(this,le).call(this,Oe(Tn,Ws,Y,H,_l,ue,we))))})}),["unit:moved"].forEach(s=>{w.on(s,(p,u)=>{let y=ie.getByPlayer(this.player()),c=y.getByTile(u.from()),f=y.getByTile(u.to());!c&&!f||(c&&b(this,X).update(c.id(),()=>c.toPlainObject(b(this,le).call(this,Oe(H,et)))),f&&b(this,X).update(f.id(),()=>f.toPlainObject(b(this,le).call(this,Oe(H,et)))),p.player()===this.player()&&p.city()!==null&&b(this,X).update(p.city().id(),()=>p.city().toPlainObject(b(this,le).call(this,Oe(Tn,Ws,Y,H,_l,ue,we)))))})}),["tile-improvement:built","tile-improvement:pillaged"].forEach(s=>{w.on(s,p=>{let u=ie.getByPlayer(this.player()),y=u.getByTile(p);y&&b(this,X).update(y.id(),()=>y.toPlainObject(b(this,le).call(this,Oe(H,et))))})}),w.on("city:captured",(s,p,u)=>{if(u===this.player()){_.getByPlayer(this.player()).indexOf(s)!==-1&&b(this,X).update(this.player().id(),()=>this.player().toPlainObject(b(this,le).call(this,Hx(H)))),this.sendNotification(`${p.civilization().name()} have captured our city ${s.name()}!`);return}if(p===this.player()){this.sendNotification(`We have captured ${s.name()} from ${u.civilization().name()}!`);return}}),["city:created","city:captured","city:destroyed","city:grow","city:shrink"].forEach(s=>{w.on(s,p=>{let u=ie.getByPlayer(this.player()),y=u.getByTile(p.tile());!y||b(this,X).update(y.id(),()=>y.toPlainObject(b(this,le).call(this,Oe(H))))})}),w.on("city:shrink",s=>{s.player()===this.player()&&this.sendNotification(`Population decrease in ${s.name()}.`)}),w.on("city:unit-unsupported",(s,p)=>{s.player()===this.player()&&this.sendNotification(`${s.name()} cannot support ${p.constructor.name}.`)}),w.on("city:unsupported-improvement",(s,p)=>{s.player()===this.player()&&this.sendNotification(`${s.name()} cannot support ${p.constructor.name}.`)}),w.on("city:food-storage-exhausted",s=>{s.player()===this.player()&&this.sendNotification(`Food storage exhausted in ${s.name()}!`)}),w.on("city:building-complete",(s,p)=>{let u=ie.getByPlayer(this.player());if(s.city().player()!==this.player()&&p instanceof xe){this.sendNotification(`${u.getByTile(s.city().tile())?s.city().name():"A faraway city"} has completed work on ${p.constructor.name}!`);return}s.city().player()!==this.player()&&!(p instanceof xe)||(b(this,X).update(s.id(),()=>s.toPlainObject(b(this,le).call(this,Oe(ue,we,H)))),this.sendNotification(`${s.city().name()} has completed work on ${p.constructor.name}!`))}),w.on("player:research-complete",(s,p)=>{s.player()===this.player()&&(b(this,X).update(s.id(),()=>s.toPlainObject(b(this,le).call(this,Oe(H)))),this.sendNotification(`You have discovered the secrets of ${p.constructor.name}!`))}),w.on("goody-hut:action-performed",(s,p)=>{let u=s.tile();if(!!N.getByTile(u).some(c=>c.player()===this.player())){if(p instanceof La){this.sendNotification("You have discovered scrolls of ancient wisdom...");return}if(p instanceof Wa){this.sendNotification("You have discovered an advanced tribe...");return}if(p instanceof _a){this.sendNotification("You have discovered valuable treasure...");return}if(p instanceof Ha){this.sendNotification("You have discovered a friendly tribe of skilled mercenaries...");return}}}),w.on("player:defeated",(s,p)=>{s===this.player()&&(this.sendNotification("You have been defeated!"),pi.unregister(...pi.entries()),ta.unregister(...ta.entries()),b(this,Bn).call(this,"restart",null)),this.sendNotification(`${s.civilization().name()} defeated${p?` by ${p.civilization().name()}`:""}.`)}),w.on("city:civil-disorder",s=>{s.player()===this.player()&&this.sendNotification(`Civil disorder in ${s.name()}!`)})}chooseCivilization(r){let o=t(a=>(this.player().setCivilization(new a),this.chooseLeader(this.player().civilization())),"makeChoice");return new Promise((a,s)=>{if(r.length===1){let[p]=r;o(p).then(()=>a());return}b(this,Bn).call(this,"chooseCivilization",new jc({choices:r}).toPlainObject()),b(this,ns).call(this,"chooseCivilization",p=>{let[u]=r.filter(y=>y.name===p);if(!u){s(`Invalid civilization ${p} (options: ${r.map(y=>y.name).join(", ")})`);return}o(u).then(()=>a())})})}chooseLeader(r){return new Promise((o,a)=>{let s=In.getByCivilization(r.constructor);if(s.length===1){let[p]=s;r.setLeader(new p),o();return}b(this,Bn).call(this,"chooseLeader",new jc({choices:s}).toPlainObject()),b(this,ns).call(this,"chooseLeader",p=>{let[u]=s.filter(y=>y.name===p);if(!u){a(`Invalid civilization ${p} (options: ${s.map(y=>y.name).join(", ")})`);return}r.setLeader(new u),o()})})}handleAction(...r){let[o]=r,a=this.player(),s=a.actions(),p=s.filter(f=>f instanceof ni),{name:u,id:y}=o;if(u==="ReassignWorkers"){let[f]=_.getBy("id",o.city);return f&&(jx(f),b(this,X).update(f.id(),f.toPlainObject(b(this,le).call(this,Oe(H,ue))))),!1}if(u==="EndTurn")return p.length===1&&p.every(f=>f instanceof js);if(!u)return console.log("action not specified"),!1;let[c]=s.filter(f=>f.constructor.name===u&&y===(f.value()?f.value().id():void 0));if(!c)return console.log("action not specified"),!1;if(c instanceof Da){let{unitAction:f,target:g}=o,G=c.value(),D=[...G.actions(),...Object.values(G.actionsForNeighbours())].flat().filter(L=>L.constructor.name===f);for(;D.length!==1;){if(D.length===0)return console.log(`action not found: ${f}`),!1;let[L]=ie.getByPlayer(this.player()).filter(Re=>Re.id()===g);if(!L)return console.log(`tile not found: ${g}`),!1;if(D=D.filter(Re=>Re.to()===L.tile()),D.length>1&&!g)return console.log(`too many actions found: ${f} (${D.length})`),!1}let[U]=D;return U.perform(),!1}if(c instanceof Oa){let f=c.value();return f.moves().value()>0&&b(this,X).update(f.id(),f.toPlainObject(b(this,le).call(this,Oe(H,ue)))),f.activate(),!1}if(c instanceof Tn||c instanceof Ka){let f=c.value(),{chosen:g}=o;if(!g)return console.log("no build item specified"),!1;let[G]=f.available().filter(k=>k.item().name===g);return G?(f.build(G.item()),!1):(console.log(`build item not available: ${g}`),!1)}if(c instanceof Tx){let f=c.value(),{chosen:g}=o;if(!g)return this.sendNotification("no build item specified"),!1;let[G]=f.available().filter(k=>k.name===g);return G?(f.research(G),!1):(console.log(`build item not available: ${g}`),!1)}if(c instanceof Ja){let f=c.value(),g=si.getByPlayer(this.player());return g.buy(f),b(this,X).update(g.id(),g.toPlainObject(b(this,le).call(this,Oe(H)))),!1}if(c instanceof Qa){let f=c.value(),{chosen:g}=o,[G]=f.available().filter(D=>D.name===g);if(!G)return console.error(`Government type: '${g}' not found.`),!1;f.set(new G);let k=ie.getByPlayer(this.player());return b(this,X).update(k.id(),k.toPlainObject(b(this,le).call(this,Oe(H)))),_.getByPlayer(this.player()).forEach(D=>b(this,X).update(D.id(),D.toPlainObject(b(this,le).call(this,Oe(H,ue,we))))),!1}if(c instanceof $a){let f=c.value(),{value:g}=o;return f.setAll(g.map(([G,k])=>{let[D]=f.all().filter(U=>U.constructor.name===G);return[D.constructor,k]})),_.getByPlayer(this.player()).forEach(G=>b(this,X).update(G.id(),G.toPlainObject(b(this,le).call(this,Oe(H,ue,we))))),!1}return console.log(`unhandled action: ${JSON.stringify(o)}`),!1}sendInitialData(){let r={player:this.player(),turn:Ue,year:uy},o=new jc(r);b(this,Bn).call(this,"gameData",o.toPlainObject(b(this,le).call(this))),ke(this,rm,!0)}sendPatchData(){b(this,Bn).call(this,"gameDataPatch",b(this,X).transferData()),b(this,X).clear()}sendNotification(r){b(this,Bn).call(this,"gameNotification",{message:r})}takeTurn(){return console.log("turn start"),new Promise((r,o)=>{console.log("sentInitialData",b(this,rm)),b(this,rm)||this.sendInitialData(),setTimeout(()=>{b(this,X).update(Ue.id(),()=>Ue.toPlainObject()),b(this,X).update(uy.id(),()=>uy.toPlainObject()),b(this,X).add(this.player().id(),()=>this.player().toPlainObject(b(this,le).call(this,Oe(ue,ae)))),this.sendPatchData()},1);let a=t((...s)=>{try{if(this.handleAction(...s)){b(this,qs).off("action",a),this.sendPatchData(),setTimeout(()=>r(),100);return}b(this,X).update(this.player().id(),()=>this.player().toPlainObject(b(this,le).call(this,Oe(Hl,ue,et)))),this.sendPatchData()}catch(p){o(p)}},"listener");b(this,qs).on("action",a)})}};t(cy,"DataTransferClient"),le=new WeakMap,X=new WeakMap,qs=new WeakMap,ns=new WeakMap,Bn=new WeakMap,rm=new WeakMap;var qx=cy;_o();hm();Xs();V();ts();var Gt,Kd=class{constructor(e){ye(this,Gt,void 0);ke(this,Gt,e),e.receive("start",()=>{this.bindEvents(),this.configure(),this.start()}),e.receive("setOption",({name:r,value:o})=>{b(this,Gt).send("notification",`setting ${r} to ${o}`),w.setOption(r,o)})}bindEvents(){b(this,Gt).send("notification","binding events"),w.on("engine:initialise",()=>b(this,Gt).send("notification","initialising...")),w.on("engine:plugins:load:success",e=>b(this,Gt).send("notification",`loaded plugin: ${e}`)),w.on("engine:plugins-loaded",()=>b(this,Gt).send("notification","plugins loaded")),w.on("engine:start",()=>b(this,Gt).send("notification","starting...")),w.on("world:generate-start-tiles",()=>b(this,Gt).send("notification","generating start tiles...")),w.on("world:built",()=>b(this,Gt).send("notification","world built")),w.on("game:start",()=>b(this,Gt).send("notification","game start")),w.on("turn:start",e=>b(this,Gt).send("notification",`turn start ${e}`)),w.on("player:turn-start",e=>b(this,Gt).send("notification",`player turn-start: ${e.civilization().constructor.name}`))}configure(){w.setOption("height",60),w.setOption("width",80)}start(){w.on("engine:start",()=>{new Array(parseInt(w.option("players"),10)).fill(0).forEach((e,r)=>{let o=new H,a=r===0?new qx(o,(s,p)=>b(this,Gt).send(s,p),(s,p)=>b(this,Gt).receive(s,p)):new Yn(o);pi.register(o),ko.register(a),b(this,Gt).send("notification","generating world...")})}),w.start(),Promise.resolve().then(()=>(aY(),wL)).then(()=>w.emit("plugins:load:end"))}};t(Kd,"Game"),Gt=new WeakMap;var sY=Kd;addEventListener("message",({data:{channel:i,data:e}})=>console.log("receiving from renderer: "+i,e));var qd=class{receive(e,r){addEventListener("message",({data:{channel:o,data:a}})=>{o===e&&r(a)})}receiveOnce(e,r){addEventListener("message",({data:{channel:o,data:a}})=>{o===e&&r(a)},{once:!0})}send(e,r){console.log("sending to renderer: "+e,r),postMessage({channel:e,data:r})}};t(qd,"ParentTransport");var lY=qd;var m_e=new sY(new lY);})();
//# sourceMappingURL=backend.js.map
